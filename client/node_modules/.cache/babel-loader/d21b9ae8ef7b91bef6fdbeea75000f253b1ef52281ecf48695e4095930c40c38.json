{"ast":null,"code":"import _objectWithoutProperties from\"C:/Users/ADMIN/Desktop/kho/kho/client/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";import _objectSpread from\"C:/Users/ADMIN/Desktop/kho/kho/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";const _excluded=[\"gender\",\"birthday\",\"city\"];import React,{useState,useEffect}from'react';import{Card,Table,Button,Input,Space,Modal,Form,Select,message,Row,Col,Statistic,Tag,Tooltip,DatePicker,Popconfirm,Drawer,Tabs,Empty,Typography,Descriptions,Timeline}from'antd';import{PlusOutlined,SearchOutlined,EditOutlined,DeleteOutlined,UserOutlined,PhoneOutlined,MailOutlined,HomeOutlined,CrownOutlined,ShoppingCartOutlined,CalendarOutlined,EyeOutlined}from'@ant-design/icons';import api,{customersAPI,ordersAPI,formatCurrency,formatDate,productsAPI}from'../services/api';import dayjs from'dayjs';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const{Search}=Input;const{Option}=Select;const{TabPane}=Tabs;const{Text}=Typography;const CustomersPage=()=>{var _customerTypes$find,_customerTypes$find2,_customerTypes$find3,_customerTypes$find4;const[customers,setCustomers]=useState([]);const[loading,setLoading]=useState(false);const[isModalVisible,setIsModalVisible]=useState(false);const[isDetailDrawerVisible,setIsDetailDrawerVisible]=useState(false);const[editingCustomer,setEditingCustomer]=useState(null);const[selectedCustomer,setSelectedCustomer]=useState(null);const[searchText,setSearchText]=useState('');const[filterType,setFilterType]=useState('all');const[stats,setStats]=useState({total:0,regular:0,vip:0,wholesale:0});const[customerPurchaseHistory,setCustomerPurchaseHistory]=useState([]);const[purchaseHistoryLoading,setPurchaseHistoryLoading]=useState(false);const[orderSerials,setOrderSerials]=useState({});const[form]=Form.useForm();const customerTypes=[{value:'regular',label:'Khách thường',color:'default'},{value:'vip',label:'VIP',color:'gold'},{value:'wholesale',label:'Bán sỉ',color:'purple'}];useEffect(()=>{fetchCustomers();},[searchText,filterType]);// ✨ AI Error Monitor Integration - Listen for auto-refresh events\nuseEffect(()=>{const handleAIRefreshCustomerList=()=>{console.log('🤖 AI triggered customer list refresh');fetchCustomers();};// Listen for AI refresh customer list event\nwindow.addEventListener('ai-refresh-customer-list',handleAIRefreshCustomerList);// Cleanup event listener\nreturn()=>{window.removeEventListener('ai-refresh-customer-list',handleAIRefreshCustomerList);};},[]);// Fetch serials for all orders in purchase history\nuseEffect(()=>{if(customerPurchaseHistory.length>0){fetchAllOrderSerials();}},[customerPurchaseHistory]);const fetchAllOrderSerials=async()=>{const serialsMap={};for(const order of customerPurchaseHistory){if(!order.items)continue;for(const item of order.items){try{const response=await productsAPI.getSoldSerials({product_id:item.product_id,order_id:order.id});if(response.data.success){serialsMap[\"\".concat(order.id,\"_\").concat(item.product_id)]=response.data.data||[];}else{serialsMap[\"\".concat(order.id,\"_\").concat(item.product_id)]=[];}}catch(error){serialsMap[\"\".concat(order.id,\"_\").concat(item.product_id)]=[];}}}setOrderSerials(serialsMap);};const fetchCustomers=async()=>{try{setLoading(true);const response=await customersAPI.getAll({search:searchText,type:filterType});if(response.data.success){setCustomers(response.data.data);calculateStats(response.data.data);}}catch(error){message.error('Lỗi khi tải danh sách khách hàng');console.error('Error fetching customers:',error);}finally{setLoading(false);}};const calculateStats=customerData=>{const stats={total:customerData.length,regular:customerData.filter(c=>c.customer_type==='regular').length,vip:customerData.filter(c=>c.customer_type==='vip').length,wholesale:customerData.filter(c=>c.customer_type==='wholesale').length};setStats(stats);};const showModal=function(){let customer=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;setEditingCustomer(customer);setIsModalVisible(true);if(customer){form.setFieldsValue(_objectSpread({},customer));}else{form.resetFields();}};const handleCancel=()=>{setIsModalVisible(false);setEditingCustomer(null);form.resetFields();};const handleSubmit=async values=>{try{// Remove unwanted fields from values before sending\nconst{gender,birthday,city}=values,customerData=_objectWithoutProperties(values,_excluded);if(editingCustomer){await customersAPI.update(editingCustomer.id,customerData);message.success('Cập nhật khách hàng thành công');}else{await customersAPI.create(customerData);message.success('Tạo khách hàng thành công');}handleCancel();fetchCustomers();}catch(error){var _error$response,_error$response$data;message.error(\"L\\u1ED7i khi \".concat(editingCustomer?'cập nhật':'tạo',\" kh\\xE1ch h\\xE0ng: \")+(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||error.message));console.error('Error saving customer:',error);}};const handleDelete=async id=>{try{await customersAPI.delete(id);message.success('Xóa khách hàng thành công');fetchCustomers();}catch(error){message.error('Lỗi khi xóa khách hàng');console.error('Error deleting customer:',error);}};const showCustomerDetail=async customer=>{try{setSelectedCustomer(customer);setIsDetailDrawerVisible(true);setPurchaseHistoryLoading(true);// Fetch customer details\nconst customerResponse=await customersAPI.getById(customer.id);if(customerResponse.data.success){setSelectedCustomer(customerResponse.data.data);}// 🛒 Fetch customer purchase history\ntry{const ordersResponse=await api.get('/orders',{params:{customer_name:customer.name,// Search by customer name since orders don't have customer_id\nlimit:100}});if(ordersResponse.data.success){const customerOrders=ordersResponse.data.data.orders||ordersResponse.data.data;// Filter orders that match this customer (by name and/or phone)\nconst filteredOrders=customerOrders.filter(order=>order.customer_name&&order.customer_name.toLowerCase()===customer.name.toLowerCase()||order.customer_phone&&customer.phone&&order.customer_phone===customer.phone);setCustomerPurchaseHistory(filteredOrders);}else{setCustomerPurchaseHistory([]);}}catch(orderError){console.error('Error fetching purchase history:',orderError);setCustomerPurchaseHistory([]);}}catch(error){message.error('Lỗi khi tải thông tin khách hàng');}finally{setPurchaseHistoryLoading(false);}};const columns=[{title:'Mã KH',dataIndex:'code',key:'code',width:100,render:text=>/*#__PURE__*/_jsx(\"strong\",{children:text})},{title:'Thông tin khách hàng',key:'customer_info',render:(_,record)=>/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{style:{fontWeight:'bold',marginBottom:4},children:[/*#__PURE__*/_jsx(UserOutlined,{style:{marginRight:8}}),record.name]}),record.phone&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#666',fontSize:'12px'},children:[/*#__PURE__*/_jsx(PhoneOutlined,{style:{marginRight:4}}),record.phone]}),record.email&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#666',fontSize:'12px'},children:[/*#__PURE__*/_jsx(MailOutlined,{style:{marginRight:4}}),record.email]})]})},{title:'Loại KH',dataIndex:'customer_type',key:'customer_type',width:120,render:type=>{const typeConfig=customerTypes.find(t=>t.value===type);return/*#__PURE__*/_jsx(Tag,{color:typeConfig===null||typeConfig===void 0?void 0:typeConfig.color,icon:type==='vip'?/*#__PURE__*/_jsx(CrownOutlined,{}):null,children:typeConfig===null||typeConfig===void 0?void 0:typeConfig.label});}},{title:'Tổng chi tiêu',dataIndex:'total_spent',key:'total_spent',width:120,render:amount=>/*#__PURE__*/_jsx(\"span\",{style:{color:'#52c41a',fontWeight:'bold'},children:formatCurrency(amount||0)}),sorter:(a,b)=>(a.total_spent||0)-(b.total_spent||0)},{title:'Số lần mua',dataIndex:'visit_count',key:'visit_count',width:100,render:count=>/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(ShoppingCartOutlined,{style:{marginRight:4}}),count||0]}),sorter:(a,b)=>(a.visit_count||0)-(b.visit_count||0)},{title:'Chiết khấu',dataIndex:'discount_rate',key:'discount_rate',width:100,render:rate=>/*#__PURE__*/_jsxs(\"span\",{style:{color:'#fa8c16'},children:[rate||0,\"%\"]})},{title:'Lần cuối mua',dataIndex:'last_visit',key:'last_visit',width:130,render:date=>date?formatDate(date):'Chưa mua'},{title:'Thao tác',key:'actions',width:150,render:(_,record)=>/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsx(Tooltip,{title:\"Xem chi ti\\u1EBFt\",children:/*#__PURE__*/_jsx(Button,{type:\"default\",size:\"small\",icon:/*#__PURE__*/_jsx(EyeOutlined,{}),onClick:()=>showCustomerDetail(record)})}),/*#__PURE__*/_jsx(Tooltip,{title:\"Ch\\u1EC9nh s\\u1EEDa\",children:/*#__PURE__*/_jsx(Button,{type:\"primary\",size:\"small\",icon:/*#__PURE__*/_jsx(EditOutlined,{}),onClick:()=>showModal(record)})}),/*#__PURE__*/_jsx(Popconfirm,{title:\"B\\u1EA1n c\\xF3 ch\\u1EAFc ch\\u1EAFn mu\\u1ED1n x\\xF3a kh\\xE1ch h\\xE0ng n\\xE0y?\",onConfirm:()=>handleDelete(record.id),okText:\"C\\xF3\",cancelText:\"Kh\\xF4ng\",children:/*#__PURE__*/_jsx(Tooltip,{title:\"X\\xF3a\",children:/*#__PURE__*/_jsx(Button,{type:\"default\",danger:true,size:\"small\",icon:/*#__PURE__*/_jsx(DeleteOutlined,{})})})})]})}];return/*#__PURE__*/_jsxs(\"div\",{style:{padding:'24px'},children:[/*#__PURE__*/_jsxs(Row,{gutter:[16,16],style:{marginBottom:24},children:[/*#__PURE__*/_jsx(Col,{span:6,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(Statistic,{title:\"T\\u1ED5ng kh\\xE1ch h\\xE0ng\",value:stats.total,prefix:/*#__PURE__*/_jsx(UserOutlined,{}),valueStyle:{color:'#1890ff'}})})}),/*#__PURE__*/_jsx(Col,{span:6,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(Statistic,{title:\"Kh\\xE1ch th\\u01B0\\u1EDDng\",value:stats.regular,valueStyle:{color:'#52c41a'}})})}),/*#__PURE__*/_jsx(Col,{span:6,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(Statistic,{title:\"Kh\\xE1ch VIP\",value:stats.vip,prefix:/*#__PURE__*/_jsx(CrownOutlined,{}),valueStyle:{color:'#faad14'}})})}),/*#__PURE__*/_jsx(Col,{span:6,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(Statistic,{title:\"Kh\\xE1ch b\\xE1n s\\u1EC9\",value:stats.wholesale,valueStyle:{color:'#722ed1'}})})})]}),/*#__PURE__*/_jsxs(Card,{title:\"Qu\\u1EA3n l\\xFD kh\\xE1ch h\\xE0ng\",children:[/*#__PURE__*/_jsxs(Row,{gutter:[16,16],style:{marginBottom:16},children:[/*#__PURE__*/_jsx(Col,{span:8,children:/*#__PURE__*/_jsx(Search,{placeholder:\"T\\xECm theo t\\xEAn, S\\u0110T, m\\xE3 KH...\",value:searchText,onChange:e=>setSearchText(e.target.value),onSearch:fetchCustomers,enterButton:/*#__PURE__*/_jsx(SearchOutlined,{}),allowClear:true})}),/*#__PURE__*/_jsx(Col,{span:6,children:/*#__PURE__*/_jsxs(Select,{style:{width:'100%'},placeholder:\"L\\u1ECDc theo lo\\u1EA1i kh\\xE1ch h\\xE0ng\",value:filterType,onChange:setFilterType,children:[/*#__PURE__*/_jsx(Option,{value:\"all\",children:\"T\\u1EA5t c\\u1EA3\"}),customerTypes.map(type=>/*#__PURE__*/_jsx(Option,{value:type.value,children:type.label},type.value))]})}),/*#__PURE__*/_jsx(Col,{span:10,style:{textAlign:'right'},children:/*#__PURE__*/_jsx(Button,{type:\"primary\",icon:/*#__PURE__*/_jsx(PlusOutlined,{}),onClick:()=>showModal(),size:\"large\",children:\"Th\\xEAm kh\\xE1ch h\\xE0ng\"})})]}),/*#__PURE__*/_jsx(Table,{columns:columns,dataSource:customers,rowKey:\"id\",loading:loading,pagination:{total:customers.length,pageSize:10,showSizeChanger:true,showQuickJumper:true,showTotal:(total,range)=>\"\".concat(range[0],\"-\").concat(range[1],\" c\\u1EE7a \").concat(total,\" kh\\xE1ch h\\xE0ng\")},scroll:{x:1200}})]}),/*#__PURE__*/_jsx(Modal,{title:editingCustomer?'Cập nhật khách hàng':'Thêm khách hàng mới',visible:isModalVisible,onCancel:handleCancel,footer:null,width:600,children:/*#__PURE__*/_jsxs(Form,{form:form,layout:\"vertical\",onFinish:handleSubmit,autoComplete:\"off\",children:[/*#__PURE__*/_jsxs(Row,{gutter:16,children:[/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:\"T\\xEAn kh\\xE1ch h\\xE0ng\",name:\"name\",rules:[{required:true,message:'Vui lòng nhập tên khách hàng'}],children:/*#__PURE__*/_jsx(Input,{prefix:/*#__PURE__*/_jsx(UserOutlined,{}),placeholder:\"Nh\\u1EADp t\\xEAn kh\\xE1ch h\\xE0ng\"})})}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:\"S\\u1ED1 \\u0111i\\u1EC7n tho\\u1EA1i\",name:\"phone\",children:/*#__PURE__*/_jsx(Input,{prefix:/*#__PURE__*/_jsx(PhoneOutlined,{}),placeholder:\"Nh\\u1EADp s\\u1ED1 \\u0111i\\u1EC7n tho\\u1EA1i\"})})})]}),/*#__PURE__*/_jsxs(Row,{gutter:16,children:[/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:\"Email\",name:\"email\",rules:[{type:'email',message:'Email không hợp lệ'}],children:/*#__PURE__*/_jsx(Input,{prefix:/*#__PURE__*/_jsx(MailOutlined,{}),placeholder:\"Nh\\u1EADp email\"})})}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:\"\\u0110\\u1ECBa ch\\u1EC9\",name:\"address\",children:/*#__PURE__*/_jsx(Input.TextArea,{rows:2,placeholder:\"Nh\\u1EADp \\u0111\\u1ECBa ch\\u1EC9\"})})})]}),/*#__PURE__*/_jsxs(Row,{gutter:16,children:[/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:\"Lo\\u1EA1i kh\\xE1ch h\\xE0ng\",name:\"customer_type\",initialValue:\"regular\",children:/*#__PURE__*/_jsx(Select,{children:customerTypes.map(type=>/*#__PURE__*/_jsx(Option,{value:type.value,children:type.label},type.value))})})}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:\"Chi\\u1EBFt kh\\u1EA5u (%)\",name:\"discount_rate\",initialValue:0,children:/*#__PURE__*/_jsx(Input,{type:\"number\",min:0,max:100,placeholder:\"0\"})})})]}),/*#__PURE__*/_jsx(Form.Item,{label:\"Ghi ch\\xFA\",name:\"notes\",children:/*#__PURE__*/_jsx(Input.TextArea,{rows:3,placeholder:\"Nh\\u1EADp ghi ch\\xFA\"})}),/*#__PURE__*/_jsx(Form.Item,{style:{textAlign:'right',marginBottom:0},children:/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsx(Button,{onClick:handleCancel,children:\"H\\u1EE7y\"}),/*#__PURE__*/_jsx(Button,{type:\"primary\",htmlType:\"submit\",children:editingCustomer?'Cập nhật':'Thêm mới'})]})})]})}),/*#__PURE__*/_jsx(Drawer,{title:/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'8px'},children:[/*#__PURE__*/_jsx(UserOutlined,{style:{color:'#1890ff'}}),/*#__PURE__*/_jsx(\"span\",{children:\"Th\\xF4ng tin chi ti\\u1EBFt kh\\xE1ch h\\xE0ng\"}),selectedCustomer&&/*#__PURE__*/_jsx(Tag,{color:(_customerTypes$find=customerTypes.find(t=>t.value===selectedCustomer.customer_type))===null||_customerTypes$find===void 0?void 0:_customerTypes$find.color,children:(_customerTypes$find2=customerTypes.find(t=>t.value===selectedCustomer.customer_type))===null||_customerTypes$find2===void 0?void 0:_customerTypes$find2.label})]}),placement:\"right\",onClose:()=>{setIsDetailDrawerVisible(false);setCustomerPurchaseHistory([]);},visible:isDetailDrawerVisible,width:800,style:{zIndex:1001},children:selectedCustomer&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Card,{title:\"\\uD83D\\uDCCB Th\\xF4ng tin c\\u01A1 b\\u1EA3n\",style:{marginBottom:16},extra:/*#__PURE__*/_jsx(Button,{size:\"small\",icon:/*#__PURE__*/_jsx(EditOutlined,{}),onClick:()=>{setIsDetailDrawerVisible(false);showModal(selectedCustomer);},children:\"Ch\\u1EC9nh s\\u1EEDa\"}),children:/*#__PURE__*/_jsxs(Descriptions,{size:\"small\",column:2,children:[/*#__PURE__*/_jsx(Descriptions.Item,{label:\"M\\xE3 kh\\xE1ch h\\xE0ng\",span:1,children:/*#__PURE__*/_jsx(Text,{strong:true,style:{color:'#1890ff'},children:selectedCustomer.code})}),/*#__PURE__*/_jsx(Descriptions.Item,{label:\"T\\xEAn kh\\xE1ch h\\xE0ng\",span:1,children:/*#__PURE__*/_jsx(Text,{strong:true,children:selectedCustomer.name})}),/*#__PURE__*/_jsx(Descriptions.Item,{label:\"\\u0110i\\u1EC7n tho\\u1EA1i\",span:1,children:/*#__PURE__*/_jsxs(Text,{copyable:!!selectedCustomer.phone,children:[/*#__PURE__*/_jsx(PhoneOutlined,{style:{marginRight:'4px',color:'#52c41a'}}),selectedCustomer.phone||'Chưa có']})}),/*#__PURE__*/_jsx(Descriptions.Item,{label:\"Email\",span:1,children:/*#__PURE__*/_jsxs(Text,{copyable:!!selectedCustomer.email,children:[/*#__PURE__*/_jsx(MailOutlined,{style:{marginRight:'4px',color:'#1890ff'}}),selectedCustomer.email||'Chưa có']})}),/*#__PURE__*/_jsx(Descriptions.Item,{label:\"Lo\\u1EA1i kh\\xE1ch h\\xE0ng\",span:1,children:/*#__PURE__*/_jsx(Tag,{color:(_customerTypes$find3=customerTypes.find(t=>t.value===selectedCustomer.customer_type))===null||_customerTypes$find3===void 0?void 0:_customerTypes$find3.color,icon:selectedCustomer.customer_type==='vip'?/*#__PURE__*/_jsx(CrownOutlined,{}):null,children:(_customerTypes$find4=customerTypes.find(t=>t.value===selectedCustomer.customer_type))===null||_customerTypes$find4===void 0?void 0:_customerTypes$find4.label})}),/*#__PURE__*/_jsx(Descriptions.Item,{label:\"Chi\\u1EBFt kh\\u1EA5u\",span:1,children:/*#__PURE__*/_jsxs(Text,{style:{color:'#fa8c16',fontWeight:'bold'},children:[selectedCustomer.discount_rate||0,\"%\"]})}),/*#__PURE__*/_jsx(Descriptions.Item,{label:\"\\u0110\\u1ECBa ch\\u1EC9\",span:2,children:/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'flex-start',gap:'4px'},children:[/*#__PURE__*/_jsx(HomeOutlined,{style:{marginTop:'4px',color:'#666'}}),/*#__PURE__*/_jsx(Text,{children:selectedCustomer.address||'Chưa có địa chỉ'})]})}),selectedCustomer.notes&&/*#__PURE__*/_jsx(Descriptions.Item,{label:\"Ghi ch\\xFA\",span:2,children:/*#__PURE__*/_jsx(Text,{type:\"secondary\",children:selectedCustomer.notes})})]})}),/*#__PURE__*/_jsx(Card,{style:{marginBottom:16},children:/*#__PURE__*/_jsxs(Tabs,{defaultActiveKey:\"stats\",type:\"card\",children:[/*#__PURE__*/_jsxs(TabPane,{tab:/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(ShoppingCartOutlined,{}),\"Th\\u1ED1ng k\\xEA mua h\\xE0ng\"]}),children:[/*#__PURE__*/_jsxs(Row,{gutter:[16,16],children:[/*#__PURE__*/_jsx(Col,{span:8,children:/*#__PURE__*/_jsx(Card,{size:\"small\",style:{textAlign:'center',borderLeft:'4px solid #52c41a'},children:/*#__PURE__*/_jsx(Statistic,{title:\"T\\u1ED5ng chi ti\\xEAu\",value:selectedCustomer.total_spent||0,formatter:value=>formatCurrency(value),valueStyle:{color:'#52c41a',fontSize:'18px'},prefix:/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'14px'},children:\"\\uD83D\\uDCB0\"})})})}),/*#__PURE__*/_jsx(Col,{span:8,children:/*#__PURE__*/_jsx(Card,{size:\"small\",style:{textAlign:'center',borderLeft:'4px solid #1890ff'},children:/*#__PURE__*/_jsx(Statistic,{title:\"S\\u1ED1 l\\u1EA7n mua\",value:selectedCustomer.visit_count||0,suffix:\"l\\u1EA7n\",valueStyle:{color:'#1890ff',fontSize:'18px'},prefix:/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'14px'},children:\"\\uD83D\\uDED2\"})})})}),/*#__PURE__*/_jsx(Col,{span:8,children:/*#__PURE__*/_jsx(Card,{size:\"small\",style:{textAlign:'center',borderLeft:'4px solid #fa8c16'},children:/*#__PURE__*/_jsx(Statistic,{title:\"\\u0110\\u01A1n h\\xE0ng\",value:customerPurchaseHistory.length,suffix:\"\\u0111\\u01A1n\",valueStyle:{color:'#fa8c16',fontSize:'18px'},prefix:/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'14px'},children:\"\\uD83D\\uDCE6\"})})})})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:16,padding:'12px',background:'#f6f8fa',borderRadius:'6px'},children:[/*#__PURE__*/_jsx(Text,{strong:true,children:\"L\\u1EA7n cu\\u1ED1i mua: \"}),/*#__PURE__*/_jsx(Text,{style:{color:'#52c41a'},children:selectedCustomer.last_visit?formatDate(selectedCustomer.last_visit):'Chưa mua hàng'})]})]},\"stats\"),/*#__PURE__*/_jsx(TabPane,{tab:/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(CalendarOutlined,{}),\"L\\u1ECBch s\\u1EED mua h\\xE0ng\",/*#__PURE__*/_jsx(Text,{style:{marginLeft:'4px',fontSize:'11px',background:'#1890ff',color:'white',padding:'2px 6px',borderRadius:'10px'},children:customerPurchaseHistory.length})]}),children:/*#__PURE__*/_jsx(\"div\",{style:{maxHeight:'400px',overflowY:'auto'},children:purchaseHistoryLoading?/*#__PURE__*/_jsx(\"div\",{style:{textAlign:'center',padding:'40px'},children:/*#__PURE__*/_jsx(\"span\",{children:\"\\u0110ang t\\u1EA3i l\\u1ECBch s\\u1EED mua h\\xE0ng...\"})}):customerPurchaseHistory.length>0?/*#__PURE__*/_jsx(Timeline,{children:customerPurchaseHistory.map((order,index)=>/*#__PURE__*/_jsx(Timeline.Item,{dot:/*#__PURE__*/_jsx(ShoppingCartOutlined,{style:{color:'#52c41a'}}),color:\"green\",children:/*#__PURE__*/_jsxs(\"div\",{style:{padding:'8px 12px',border:'1px solid #e8f4fd',borderRadius:'8px',background:'#f6ffed'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center',marginBottom:'8px'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(Text,{strong:true,style:{color:'#1890ff',fontSize:'14px'},children:[\"\\uD83D\\uDCE6 \\u0110\\u01A1n h\\xE0ng #\",order.order_number||order.id]}),/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'11px',color:'#666'},children:[\"\\uD83D\\uDCC5 \",formatDate(order.created_at)]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'right'},children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'16px',fontWeight:'bold',color:'#52c41a'},children:formatCurrency(order.total_amount)}),/*#__PURE__*/_jsx(Tag,{color:order.status==='completed'?'green':'orange',size:\"small\",children:order.status==='completed'?'Hoàn thành':order.status})]})]}),order.items&&order.items.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'8px',padding:'8px',background:'#fff',borderRadius:'4px'},children:[/*#__PURE__*/_jsx(Text,{strong:true,style:{fontSize:'12px',color:'#666'},children:\"\\uD83D\\uDCCB S\\u1EA3n ph\\u1EA9m \\u0111\\xE3 mua:\"}),order.items.slice(0,3).map((item,itemIndex)=>/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'11px',color:'#333',marginTop:'4px',paddingLeft:'8px'},children:[\"\\u2022 \",item.product_name,\" (x\",item.quantity,\") - \",formatCurrency(item.subtotal),orderSerials[\"\".concat(order.id,\"_\").concat(item.product_id)]&&orderSerials[\"\".concat(order.id,\"_\").concat(item.product_id)].length>0&&/*#__PURE__*/_jsx(\"div\",{style:{marginLeft:16,marginTop:2},children:orderSerials[\"\".concat(order.id,\"_\").concat(item.product_id)].slice(0,item.quantity).map((serial,snIdx)=>{let daysLeft='?';if(serial.warranty_end_date){const end=dayjs(serial.warranty_end_date);const now=dayjs();daysLeft=end.diff(now,'day');if(daysLeft<0)daysLeft='Hết hạn';}return/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'11px',color:'#1890ff'},children:[\"SN: \",/*#__PURE__*/_jsx(\"b\",{children:serial.serial_number}),serial.warranty_start_date&&serial.warranty_end_date&&/*#__PURE__*/_jsxs(\"span\",{style:{color:'#fa8c16',marginLeft:8},children:[\"| B\\u1EA3o h\\xE0nh: \",formatDate(serial.warranty_start_date),\" \\u2192 \",formatDate(serial.warranty_end_date),/*#__PURE__*/_jsxs(\"span\",{style:{color:'#52c41a',marginLeft:4},children:[\"(C\\xF2n \",daysLeft,\" ng\\xE0y)\"]})]})]},snIdx);})})]},itemIndex)),order.items.length>3&&/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'11px',color:'#1890ff',fontStyle:'italic',marginTop:'4px',paddingLeft:'8px'},children:[\"... v\\xE0 \",order.items.length-3,\" s\\u1EA3n ph\\u1EA9m kh\\xE1c\"]})]}),order.notes&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'6px',fontSize:'11px',color:'#666',fontStyle:'italic'},children:[\"\\uD83D\\uDCAC \",order.notes]})]})},order.id||index))}):/*#__PURE__*/_jsx(Empty,{image:Empty.PRESENTED_IMAGE_SIMPLE,description:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'16px',marginBottom:'8px'},children:\"\\uD83D\\uDED2 Ch\\u01B0a c\\xF3 l\\u1ECBch s\\u1EED mua h\\xE0ng\"}),/*#__PURE__*/_jsx(Text,{type:\"secondary\",children:\"Kh\\xE1ch h\\xE0ng n\\xE0y ch\\u01B0a th\\u1EF1c hi\\u1EC7n \\u0111\\u01A1n h\\xE0ng n\\xE0o\"})]})})})},\"history\")]})})]})})]});};export default CustomersPage;","map":{"version":3,"names":["React","useState","useEffect","Card","Table","Button","Input","Space","Modal","Form","Select","message","Row","Col","Statistic","Tag","Tooltip","DatePicker","Popconfirm","Drawer","Tabs","Empty","Typography","Descriptions","Timeline","PlusOutlined","SearchOutlined","EditOutlined","DeleteOutlined","UserOutlined","PhoneOutlined","MailOutlined","HomeOutlined","CrownOutlined","ShoppingCartOutlined","CalendarOutlined","EyeOutlined","api","customersAPI","ordersAPI","formatCurrency","formatDate","productsAPI","dayjs","jsx","_jsx","jsxs","_jsxs","Search","Option","TabPane","Text","CustomersPage","_customerTypes$find","_customerTypes$find2","_customerTypes$find3","_customerTypes$find4","customers","setCustomers","loading","setLoading","isModalVisible","setIsModalVisible","isDetailDrawerVisible","setIsDetailDrawerVisible","editingCustomer","setEditingCustomer","selectedCustomer","setSelectedCustomer","searchText","setSearchText","filterType","setFilterType","stats","setStats","total","regular","vip","wholesale","customerPurchaseHistory","setCustomerPurchaseHistory","purchaseHistoryLoading","setPurchaseHistoryLoading","orderSerials","setOrderSerials","form","useForm","customerTypes","value","label","color","fetchCustomers","handleAIRefreshCustomerList","console","log","window","addEventListener","removeEventListener","length","fetchAllOrderSerials","serialsMap","order","items","item","response","getSoldSerials","product_id","order_id","id","data","success","concat","error","getAll","search","type","calculateStats","customerData","filter","c","customer_type","showModal","customer","arguments","undefined","setFieldsValue","_objectSpread","resetFields","handleCancel","handleSubmit","values","gender","birthday","city","_objectWithoutProperties","_excluded","update","create","_error$response","_error$response$data","handleDelete","delete","showCustomerDetail","customerResponse","getById","ordersResponse","get","params","customer_name","name","limit","customerOrders","orders","filteredOrders","toLowerCase","customer_phone","phone","orderError","columns","title","dataIndex","key","width","render","text","children","_","record","style","fontWeight","marginBottom","marginRight","fontSize","email","typeConfig","find","t","icon","amount","sorter","a","b","total_spent","count","visit_count","rate","date","size","onClick","onConfirm","okText","cancelText","danger","padding","gutter","span","prefix","valueStyle","placeholder","onChange","e","target","onSearch","enterButton","allowClear","map","textAlign","dataSource","rowKey","pagination","pageSize","showSizeChanger","showQuickJumper","showTotal","range","scroll","x","visible","onCancel","footer","layout","onFinish","autoComplete","Item","rules","required","TextArea","rows","initialValue","min","max","htmlType","display","alignItems","gap","placement","onClose","zIndex","extra","column","strong","code","copyable","discount_rate","marginTop","address","notes","defaultActiveKey","tab","borderLeft","formatter","suffix","background","borderRadius","last_visit","marginLeft","maxHeight","overflowY","index","dot","border","justifyContent","order_number","created_at","total_amount","status","slice","itemIndex","paddingLeft","product_name","quantity","subtotal","serial","snIdx","daysLeft","warranty_end_date","end","now","diff","serial_number","warranty_start_date","fontStyle","image","PRESENTED_IMAGE_SIMPLE","description"],"sources":["C:/Users/ADMIN/Desktop/kho/kho/client/src/pages/CustomersPage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport {\r\n  Card,\r\n  Table,\r\n  Button,\r\n  Input,\r\n  Space,\r\n  Modal,\r\n  Form,\r\n  Select,\r\n  message,\r\n  Row,\r\n  Col,\r\n  Statistic,\r\n  Tag,\r\n  Tooltip,\r\n  DatePicker,\r\n  Popconfirm,\r\n  Drawer,\r\n  Tabs,\r\n  Empty,\r\n  Typography,\r\n  Descriptions,\r\n  Timeline\r\n} from 'antd';\r\nimport {\r\n  PlusOutlined,\r\n  SearchOutlined,\r\n  EditOutlined,\r\n  DeleteOutlined,\r\n  UserOutlined,\r\n  PhoneOutlined,\r\n  MailOutlined,\r\n  HomeOutlined,\r\n  CrownOutlined,\r\n  ShoppingCartOutlined,\r\n  CalendarOutlined,\r\n  EyeOutlined\r\n} from '@ant-design/icons';\r\nimport api, { customersAPI, ordersAPI, formatCurrency, formatDate, productsAPI } from '../services/api';\r\nimport dayjs from 'dayjs';\r\n\r\nconst { Search } = Input;\r\nconst { Option } = Select;\r\nconst { TabPane } = Tabs;\r\nconst { Text } = Typography;\r\n\r\nconst CustomersPage = () => {\r\n  const [customers, setCustomers] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [isModalVisible, setIsModalVisible] = useState(false);\r\n  const [isDetailDrawerVisible, setIsDetailDrawerVisible] = useState(false);\r\n  const [editingCustomer, setEditingCustomer] = useState(null);\r\n  const [selectedCustomer, setSelectedCustomer] = useState(null);\r\n  const [searchText, setSearchText] = useState('');\r\n  const [filterType, setFilterType] = useState('all');\r\n  const [stats, setStats] = useState({\r\n    total: 0,\r\n    regular: 0,\r\n    vip: 0,\r\n    wholesale: 0\r\n  });\r\n  const [customerPurchaseHistory, setCustomerPurchaseHistory] = useState([]);\r\n  const [purchaseHistoryLoading, setPurchaseHistoryLoading] = useState(false);\r\n  const [orderSerials, setOrderSerials] = useState({});\r\n  const [form] = Form.useForm();\r\n\r\n  const customerTypes = [\r\n    { value: 'regular', label: 'Khách thường', color: 'default' },\r\n    { value: 'vip', label: 'VIP', color: 'gold' },\r\n    { value: 'wholesale', label: 'Bán sỉ', color: 'purple' }\r\n  ];\r\n\r\n  useEffect(() => {\r\n    fetchCustomers();\r\n  }, [searchText, filterType]);\r\n\r\n  // ✨ AI Error Monitor Integration - Listen for auto-refresh events\r\n  useEffect(() => {\r\n    const handleAIRefreshCustomerList = () => {\r\n      console.log('🤖 AI triggered customer list refresh');\r\n      fetchCustomers();\r\n    };\r\n\r\n    // Listen for AI refresh customer list event\r\n    window.addEventListener('ai-refresh-customer-list', handleAIRefreshCustomerList);\r\n\r\n    // Cleanup event listener\r\n    return () => {\r\n      window.removeEventListener('ai-refresh-customer-list', handleAIRefreshCustomerList);\r\n    };\r\n  }, []);\r\n\r\n  // Fetch serials for all orders in purchase history\r\n  useEffect(() => {\r\n    if (customerPurchaseHistory.length > 0) {\r\n      fetchAllOrderSerials();\r\n    }\r\n  }, [customerPurchaseHistory]);\r\n\r\n  const fetchAllOrderSerials = async () => {\r\n    const serialsMap = {};\r\n    for (const order of customerPurchaseHistory) {\r\n      if (!order.items) continue;\r\n      for (const item of order.items) {\r\n        try {\r\n          const response = await productsAPI.getSoldSerials({ product_id: item.product_id, order_id: order.id });\r\n          if (response.data.success) {\r\n            serialsMap[`${order.id}_${item.product_id}`] = response.data.data || [];\r\n          } else {\r\n            serialsMap[`${order.id}_${item.product_id}`] = [];\r\n          }\r\n        } catch (error) {\r\n          serialsMap[`${order.id}_${item.product_id}`] = [];\r\n        }\r\n      }\r\n    }\r\n    setOrderSerials(serialsMap);\r\n  };\r\n\r\n  const fetchCustomers = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const response = await customersAPI.getAll({\r\n        search: searchText,\r\n        type: filterType\r\n      });\r\n      \r\n      if (response.data.success) {\r\n        setCustomers(response.data.data);\r\n        calculateStats(response.data.data);\r\n      }\r\n    } catch (error) {\r\n      message.error('Lỗi khi tải danh sách khách hàng');\r\n      console.error('Error fetching customers:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const calculateStats = (customerData) => {\r\n    const stats = {\r\n      total: customerData.length,\r\n      regular: customerData.filter(c => c.customer_type === 'regular').length,\r\n      vip: customerData.filter(c => c.customer_type === 'vip').length,\r\n      wholesale: customerData.filter(c => c.customer_type === 'wholesale').length\r\n    };\r\n    setStats(stats);\r\n  };\r\n\r\n  const showModal = (customer = null) => {\r\n    setEditingCustomer(customer);\r\n    setIsModalVisible(true);\r\n    if (customer) {\r\n      form.setFieldsValue({\r\n        ...customer,\r\n      });\r\n    } else {\r\n      form.resetFields();\r\n    }\r\n  };\r\n\r\n  const handleCancel = () => {\r\n    setIsModalVisible(false);\r\n    setEditingCustomer(null);\r\n    form.resetFields();\r\n  };\r\n\r\n  const handleSubmit = async (values) => {\r\n    try {\r\n      // Remove unwanted fields from values before sending\r\n      const { gender, birthday, city, ...customerData } = values; \r\n\r\n      if (editingCustomer) {\r\n        await customersAPI.update(editingCustomer.id, customerData);\r\n        message.success('Cập nhật khách hàng thành công');\r\n      } else {\r\n        await customersAPI.create(customerData);\r\n        message.success('Tạo khách hàng thành công');\r\n      }\r\n      \r\n      handleCancel();\r\n      fetchCustomers();\r\n    } catch (error) {\r\n      message.error(`Lỗi khi ${editingCustomer ? 'cập nhật' : 'tạo'} khách hàng: ` + (error.response?.data?.message || error.message));\r\n      console.error('Error saving customer:', error);\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (id) => {\r\n    try {\r\n      await customersAPI.delete(id);\r\n      message.success('Xóa khách hàng thành công');\r\n      fetchCustomers();\r\n    } catch (error) {\r\n      message.error('Lỗi khi xóa khách hàng');\r\n      console.error('Error deleting customer:', error);\r\n    }\r\n  };\r\n\r\n  const showCustomerDetail = async (customer) => {\r\n    try {\r\n      setSelectedCustomer(customer);\r\n      setIsDetailDrawerVisible(true);\r\n      setPurchaseHistoryLoading(true);\r\n      \r\n      // Fetch customer details\r\n      const customerResponse = await customersAPI.getById(customer.id);\r\n      if (customerResponse.data.success) {\r\n        setSelectedCustomer(customerResponse.data.data);\r\n      }\r\n      \r\n      // 🛒 Fetch customer purchase history\r\n      try {\r\n        const ordersResponse = await api.get('/orders', {\r\n          params: {\r\n            customer_name: customer.name, // Search by customer name since orders don't have customer_id\r\n            limit: 100\r\n          }\r\n        });\r\n        \r\n        if (ordersResponse.data.success) {\r\n          const customerOrders = ordersResponse.data.data.orders || ordersResponse.data.data;\r\n          // Filter orders that match this customer (by name and/or phone)\r\n          const filteredOrders = customerOrders.filter(order => \r\n            (order.customer_name && order.customer_name.toLowerCase() === customer.name.toLowerCase()) ||\r\n            (order.customer_phone && customer.phone && order.customer_phone === customer.phone)\r\n          );\r\n          setCustomerPurchaseHistory(filteredOrders);\r\n        } else {\r\n          setCustomerPurchaseHistory([]);\r\n        }\r\n      } catch (orderError) {\r\n        console.error('Error fetching purchase history:', orderError);\r\n        setCustomerPurchaseHistory([]);\r\n      }\r\n      \r\n    } catch (error) {\r\n      message.error('Lỗi khi tải thông tin khách hàng');\r\n    } finally {\r\n      setPurchaseHistoryLoading(false);\r\n    }\r\n  };\r\n\r\n  const columns = [\r\n    {\r\n      title: 'Mã KH',\r\n      dataIndex: 'code',\r\n      key: 'code',\r\n      width: 100,\r\n      render: (text) => <strong>{text}</strong>\r\n    },\r\n    {\r\n      title: 'Thông tin khách hàng',\r\n      key: 'customer_info',\r\n      render: (_, record) => (\r\n        <div>\r\n          <div style={{ fontWeight: 'bold', marginBottom: 4 }}>\r\n            <UserOutlined style={{ marginRight: 8 }} />\r\n            {record.name}\r\n          </div>\r\n          {record.phone && (\r\n            <div style={{ color: '#666', fontSize: '12px' }}>\r\n              <PhoneOutlined style={{ marginRight: 4 }} />\r\n              {record.phone}\r\n            </div>\r\n          )}\r\n          {record.email && (\r\n            <div style={{ color: '#666', fontSize: '12px' }}>\r\n              <MailOutlined style={{ marginRight: 4 }} />\r\n              {record.email}\r\n            </div>\r\n          )}\r\n        </div>\r\n      )\r\n    },\r\n    {\r\n      title: 'Loại KH',\r\n      dataIndex: 'customer_type',\r\n      key: 'customer_type',\r\n      width: 120,\r\n      render: (type) => {\r\n        const typeConfig = customerTypes.find(t => t.value === type);\r\n        return (\r\n          <Tag color={typeConfig?.color} icon={type === 'vip' ? <CrownOutlined /> : null}>\r\n            {typeConfig?.label}\r\n          </Tag>\r\n        );\r\n      }\r\n    },\r\n    {\r\n      title: 'Tổng chi tiêu',\r\n      dataIndex: 'total_spent',\r\n      key: 'total_spent',\r\n      width: 120,\r\n      render: (amount) => (\r\n        <span style={{ color: '#52c41a', fontWeight: 'bold' }}>\r\n          {formatCurrency(amount || 0)}\r\n        </span>\r\n      ),\r\n      sorter: (a, b) => (a.total_spent || 0) - (b.total_spent || 0)\r\n    },\r\n    {\r\n      title: 'Số lần mua',\r\n      dataIndex: 'visit_count',\r\n      key: 'visit_count',\r\n      width: 100,\r\n      render: (count) => (\r\n        <span>\r\n          <ShoppingCartOutlined style={{ marginRight: 4 }} />\r\n          {count || 0}\r\n        </span>\r\n      ),\r\n      sorter: (a, b) => (a.visit_count || 0) - (b.visit_count || 0)\r\n    },\r\n    {\r\n      title: 'Chiết khấu',\r\n      dataIndex: 'discount_rate',\r\n      key: 'discount_rate',\r\n      width: 100,\r\n      render: (rate) => (\r\n        <span style={{ color: '#fa8c16' }}>\r\n          {rate || 0}%\r\n        </span>\r\n      )\r\n    },\r\n    {\r\n      title: 'Lần cuối mua',\r\n      dataIndex: 'last_visit',\r\n      key: 'last_visit',\r\n      width: 130,\r\n      render: (date) => date ? formatDate(date) : 'Chưa mua'\r\n    },\r\n    {\r\n      title: 'Thao tác',\r\n      key: 'actions',\r\n      width: 150,\r\n      render: (_, record) => (\r\n        <Space>\r\n          <Tooltip title=\"Xem chi tiết\">\r\n            <Button\r\n              type=\"default\"\r\n              size=\"small\"\r\n              icon={<EyeOutlined />}\r\n              onClick={() => showCustomerDetail(record)}\r\n            />\r\n          </Tooltip>\r\n          <Tooltip title=\"Chỉnh sửa\">\r\n            <Button\r\n              type=\"primary\"\r\n              size=\"small\"\r\n              icon={<EditOutlined />}\r\n              onClick={() => showModal(record)}\r\n            />\r\n          </Tooltip>\r\n          <Popconfirm\r\n            title=\"Bạn có chắc chắn muốn xóa khách hàng này?\"\r\n            onConfirm={() => handleDelete(record.id)}\r\n            okText=\"Có\"\r\n            cancelText=\"Không\"\r\n          >\r\n            <Tooltip title=\"Xóa\">\r\n              <Button\r\n                type=\"default\"\r\n                danger\r\n                size=\"small\"\r\n                icon={<DeleteOutlined />}\r\n              />\r\n            </Tooltip>\r\n          </Popconfirm>\r\n        </Space>\r\n      )\r\n    }\r\n  ];\r\n\r\n  return (\r\n    <div style={{ padding: '24px' }}>\r\n      {/* Header với thống kê */}\r\n      <Row gutter={[16, 16]} style={{ marginBottom: 24 }}>\r\n        <Col span={6}>\r\n          <Card>\r\n            <Statistic\r\n              title=\"Tổng khách hàng\"\r\n              value={stats.total}\r\n              prefix={<UserOutlined />}\r\n              valueStyle={{ color: '#1890ff' }}\r\n            />\r\n          </Card>\r\n        </Col>\r\n        <Col span={6}>\r\n          <Card>\r\n            <Statistic\r\n              title=\"Khách thường\"\r\n              value={stats.regular}\r\n              valueStyle={{ color: '#52c41a' }}\r\n            />\r\n          </Card>\r\n        </Col>\r\n        <Col span={6}>\r\n          <Card>\r\n            <Statistic\r\n              title=\"Khách VIP\"\r\n              value={stats.vip}\r\n              prefix={<CrownOutlined />}\r\n              valueStyle={{ color: '#faad14' }}\r\n            />\r\n          </Card>\r\n        </Col>\r\n        <Col span={6}>\r\n          <Card>\r\n            <Statistic\r\n              title=\"Khách bán sỉ\"\r\n              value={stats.wholesale}\r\n              valueStyle={{ color: '#722ed1' }}\r\n            />\r\n          </Card>\r\n        </Col>\r\n      </Row>\r\n\r\n      {/* Main Content */}\r\n      <Card title=\"Quản lý khách hàng\">\r\n        {/* Filters */}\r\n        <Row gutter={[16, 16]} style={{ marginBottom: 16 }}>\r\n          <Col span={8}>\r\n            <Search\r\n              placeholder=\"Tìm theo tên, SĐT, mã KH...\"\r\n              value={searchText}\r\n              onChange={(e) => setSearchText(e.target.value)}\r\n              onSearch={fetchCustomers}\r\n              enterButton={<SearchOutlined />}\r\n              allowClear\r\n            />\r\n          </Col>\r\n          <Col span={6}>\r\n            <Select\r\n              style={{ width: '100%' }}\r\n              placeholder=\"Lọc theo loại khách hàng\"\r\n              value={filterType}\r\n              onChange={setFilterType}\r\n            >\r\n              <Option value=\"all\">Tất cả</Option>\r\n              {customerTypes.map(type => (\r\n                <Option key={type.value} value={type.value}>\r\n                  {type.label}\r\n                </Option>\r\n              ))}\r\n            </Select>\r\n          </Col>\r\n          <Col span={10} style={{ textAlign: 'right' }}>\r\n            <Button\r\n              type=\"primary\"\r\n              icon={<PlusOutlined />}\r\n              onClick={() => showModal()}\r\n              size=\"large\"\r\n            >\r\n              Thêm khách hàng\r\n            </Button>\r\n          </Col>\r\n        </Row>\r\n\r\n        {/* Table */}\r\n        <Table\r\n          columns={columns}\r\n          dataSource={customers}\r\n          rowKey=\"id\"\r\n          loading={loading}\r\n          pagination={{\r\n            total: customers.length,\r\n            pageSize: 10,\r\n            showSizeChanger: true,\r\n            showQuickJumper: true,\r\n            showTotal: (total, range) => \r\n              `${range[0]}-${range[1]} của ${total} khách hàng`\r\n          }}\r\n          scroll={{ x: 1200 }}\r\n        />\r\n      </Card>\r\n\r\n      {/* Modal thêm/sửa khách hàng */}\r\n      <Modal\r\n        title={editingCustomer ? 'Cập nhật khách hàng' : 'Thêm khách hàng mới'}\r\n        visible={isModalVisible}\r\n        onCancel={handleCancel}\r\n        footer={null}\r\n        width={600}\r\n      >\r\n        <Form\r\n          form={form}\r\n          layout=\"vertical\"\r\n          onFinish={handleSubmit}\r\n          autoComplete=\"off\"\r\n        >\r\n          <Row gutter={16}>\r\n            <Col span={12}>\r\n              <Form.Item\r\n                label=\"Tên khách hàng\"\r\n                name=\"name\"\r\n                rules={[{ required: true, message: 'Vui lòng nhập tên khách hàng' }]}\r\n              >\r\n                <Input prefix={<UserOutlined />} placeholder=\"Nhập tên khách hàng\" />\r\n              </Form.Item>\r\n            </Col>\r\n            <Col span={12}>\r\n              <Form.Item\r\n                label=\"Số điện thoại\"\r\n                name=\"phone\"\r\n              >\r\n                <Input prefix={<PhoneOutlined />} placeholder=\"Nhập số điện thoại\" />\r\n              </Form.Item>\r\n            </Col>\r\n          </Row>\r\n\r\n          <Row gutter={16}>\r\n            <Col span={12}>\r\n              <Form.Item\r\n                label=\"Email\"\r\n                name=\"email\"\r\n                rules={[{ type: 'email', message: 'Email không hợp lệ' }]}\r\n              >\r\n                <Input prefix={<MailOutlined />} placeholder=\"Nhập email\" />\r\n              </Form.Item>\r\n            </Col>\r\n            <Col span={12}>\r\n              <Form.Item\r\n                label=\"Địa chỉ\"\r\n                name=\"address\"\r\n              >\r\n                <Input.TextArea rows={2} placeholder=\"Nhập địa chỉ\" />\r\n              </Form.Item>\r\n            </Col>\r\n          </Row>\r\n\r\n          <Row gutter={16}>\r\n            <Col span={12}>\r\n              <Form.Item\r\n                label=\"Loại khách hàng\"\r\n                name=\"customer_type\"\r\n                initialValue=\"regular\"\r\n              >\r\n                <Select>\r\n                  {customerTypes.map(type => (\r\n                    <Option key={type.value} value={type.value}>\r\n                      {type.label}\r\n                    </Option>\r\n                  ))}\r\n                </Select>\r\n              </Form.Item>\r\n            </Col>\r\n            <Col span={12}>\r\n              <Form.Item\r\n                label=\"Chiết khấu (%)\"\r\n                name=\"discount_rate\"\r\n                initialValue={0}\r\n              >\r\n                <Input type=\"number\" min={0} max={100} placeholder=\"0\" />\r\n              </Form.Item>\r\n            </Col>\r\n          </Row>\r\n\r\n          <Form.Item\r\n            label=\"Ghi chú\"\r\n            name=\"notes\"\r\n          >\r\n            <Input.TextArea rows={3} placeholder=\"Nhập ghi chú\" />\r\n          </Form.Item>\r\n\r\n          <Form.Item style={{ textAlign: 'right', marginBottom: 0 }}>\r\n            <Space>\r\n              <Button onClick={handleCancel}>\r\n                Hủy\r\n              </Button>\r\n              <Button type=\"primary\" htmlType=\"submit\">\r\n                {editingCustomer ? 'Cập nhật' : 'Thêm mới'}\r\n              </Button>\r\n            </Space>\r\n          </Form.Item>\r\n        </Form>\r\n      </Modal>\r\n\r\n      {/* 🆕 Enhanced Customer Details Drawer */}\r\n      <Drawer\r\n        title={\r\n          <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\r\n            <UserOutlined style={{ color: '#1890ff' }} />\r\n            <span>Thông tin chi tiết khách hàng</span>\r\n            {selectedCustomer && (\r\n              <Tag color={customerTypes.find(t => t.value === selectedCustomer.customer_type)?.color}>\r\n                {customerTypes.find(t => t.value === selectedCustomer.customer_type)?.label}\r\n              </Tag>\r\n            )}\r\n          </div>\r\n        }\r\n        placement=\"right\"\r\n        onClose={() => {\r\n          setIsDetailDrawerVisible(false);\r\n          setCustomerPurchaseHistory([]);\r\n        }}\r\n        visible={isDetailDrawerVisible}\r\n        width={800}\r\n        style={{ zIndex: 1001 }}\r\n      >\r\n        {selectedCustomer && (\r\n          <div>\r\n            {/* 🆕 Enhanced Basic Information with Address */}\r\n            <Card \r\n              title=\"📋 Thông tin cơ bản\" \r\n              style={{ marginBottom: 16 }}\r\n              extra={\r\n                <Button \r\n                  size=\"small\" \r\n                  icon={<EditOutlined />}\r\n                  onClick={() => {\r\n                    setIsDetailDrawerVisible(false);\r\n                    showModal(selectedCustomer);\r\n                  }}\r\n                >\r\n                  Chỉnh sửa\r\n                </Button>\r\n              }\r\n            >\r\n              <Descriptions size=\"small\" column={2}>\r\n                <Descriptions.Item label=\"Mã khách hàng\" span={1}>\r\n                  <Text strong style={{ color: '#1890ff' }}>{selectedCustomer.code}</Text>\r\n                </Descriptions.Item>\r\n                <Descriptions.Item label=\"Tên khách hàng\" span={1}>\r\n                  <Text strong>{selectedCustomer.name}</Text>\r\n                </Descriptions.Item>\r\n                <Descriptions.Item label=\"Điện thoại\" span={1}>\r\n                  <Text copyable={!!selectedCustomer.phone}>\r\n                    <PhoneOutlined style={{ marginRight: '4px', color: '#52c41a' }} />\r\n                    {selectedCustomer.phone || 'Chưa có'}\r\n                  </Text>\r\n                </Descriptions.Item>\r\n                <Descriptions.Item label=\"Email\" span={1}>\r\n                  <Text copyable={!!selectedCustomer.email}>\r\n                    <MailOutlined style={{ marginRight: '4px', color: '#1890ff' }} />\r\n                    {selectedCustomer.email || 'Chưa có'}\r\n                  </Text>\r\n                </Descriptions.Item>\r\n                <Descriptions.Item label=\"Loại khách hàng\" span={1}>\r\n                  <Tag \r\n                    color={customerTypes.find(t => t.value === selectedCustomer.customer_type)?.color}\r\n                    icon={selectedCustomer.customer_type === 'vip' ? <CrownOutlined /> : null}\r\n                  >\r\n                    {customerTypes.find(t => t.value === selectedCustomer.customer_type)?.label}\r\n                  </Tag>\r\n                </Descriptions.Item>\r\n                <Descriptions.Item label=\"Chiết khấu\" span={1}>\r\n                  <Text style={{ color: '#fa8c16', fontWeight: 'bold' }}>\r\n                    {selectedCustomer.discount_rate || 0}%\r\n                  </Text>\r\n                </Descriptions.Item>\r\n                \r\n                {/* 🎯 FIX: Address moved into basic info */}\r\n                <Descriptions.Item label=\"Địa chỉ\" span={2}>\r\n                  <div style={{ display: 'flex', alignItems: 'flex-start', gap: '4px' }}>\r\n                    <HomeOutlined style={{ marginTop: '4px', color: '#666' }} />\r\n                    <Text>{selectedCustomer.address || 'Chưa có địa chỉ'}</Text>\r\n                  </div>\r\n                </Descriptions.Item>\r\n                \r\n                {selectedCustomer.notes && (\r\n                  <Descriptions.Item label=\"Ghi chú\" span={2}>\r\n                    <Text type=\"secondary\">{selectedCustomer.notes}</Text>\r\n                  </Descriptions.Item>\r\n                )}\r\n              </Descriptions>\r\n            </Card>\r\n\r\n            {/* 🆕 Enhanced Purchase Statistics & History with Tabs */}\r\n            <Card style={{ marginBottom: 16 }}>\r\n              <Tabs defaultActiveKey=\"stats\" type=\"card\">\r\n                <TabPane \r\n                  tab={\r\n                    <span>\r\n                      <ShoppingCartOutlined />\r\n                      Thống kê mua hàng\r\n                    </span>\r\n                  } \r\n                  key=\"stats\"\r\n                >\r\n                  <Row gutter={[16, 16]}>\r\n                    <Col span={8}>\r\n                      <Card size=\"small\" style={{ textAlign: 'center', borderLeft: '4px solid #52c41a' }}>\r\n                        <Statistic\r\n                          title=\"Tổng chi tiêu\"\r\n                          value={selectedCustomer.total_spent || 0}\r\n                          formatter={value => formatCurrency(value)}\r\n                          valueStyle={{ color: '#52c41a', fontSize: '18px' }}\r\n                          prefix={<span style={{ fontSize: '14px' }}>💰</span>}\r\n                        />\r\n                      </Card>\r\n                    </Col>\r\n                    <Col span={8}>\r\n                      <Card size=\"small\" style={{ textAlign: 'center', borderLeft: '4px solid #1890ff' }}>\r\n                        <Statistic\r\n                          title=\"Số lần mua\"\r\n                          value={selectedCustomer.visit_count || 0}\r\n                          suffix=\"lần\"\r\n                          valueStyle={{ color: '#1890ff', fontSize: '18px' }}\r\n                          prefix={<span style={{ fontSize: '14px' }}>🛒</span>}\r\n                        />\r\n                      </Card>\r\n                    </Col>\r\n                    <Col span={8}>\r\n                      <Card size=\"small\" style={{ textAlign: 'center', borderLeft: '4px solid #fa8c16' }}>\r\n                        <Statistic\r\n                          title=\"Đơn hàng\"\r\n                          value={customerPurchaseHistory.length}\r\n                          suffix=\"đơn\"\r\n                          valueStyle={{ color: '#fa8c16', fontSize: '18px' }}\r\n                          prefix={<span style={{ fontSize: '14px' }}>📦</span>}\r\n                        />\r\n                      </Card>\r\n                    </Col>\r\n                  </Row>\r\n                  <div style={{ marginTop: 16, padding: '12px', background: '#f6f8fa', borderRadius: '6px' }}>\r\n                    <Text strong>Lần cuối mua: </Text>\r\n                    <Text style={{ color: '#52c41a' }}>\r\n                      {selectedCustomer.last_visit ? formatDate(selectedCustomer.last_visit) : 'Chưa mua hàng'}\r\n                    </Text>\r\n                  </div>\r\n                </TabPane>\r\n\r\n                <TabPane \r\n                  tab={\r\n                    <span>\r\n                      <CalendarOutlined />\r\n                      Lịch sử mua hàng\r\n                      <Text style={{ \r\n                        marginLeft: '4px', \r\n                        fontSize: '11px', \r\n                        background: '#1890ff', \r\n                        color: 'white', \r\n                        padding: '2px 6px', \r\n                        borderRadius: '10px' \r\n                      }}>\r\n                        {customerPurchaseHistory.length}\r\n                      </Text>\r\n                    </span>\r\n                  } \r\n                  key=\"history\"\r\n                >\r\n                  <div style={{ maxHeight: '400px', overflowY: 'auto' }}>\r\n                    {purchaseHistoryLoading ? (\r\n                      <div style={{ textAlign: 'center', padding: '40px' }}>\r\n                        <span>Đang tải lịch sử mua hàng...</span>\r\n                      </div>\r\n                    ) : customerPurchaseHistory.length > 0 ? (\r\n                      <Timeline>\r\n                        {customerPurchaseHistory.map((order, index) => (\r\n                          <Timeline.Item \r\n                            key={order.id || index}\r\n                            dot={<ShoppingCartOutlined style={{ color: '#52c41a' }} />}\r\n                            color=\"green\"\r\n                          >\r\n                            <div style={{ padding: '8px 12px', border: '1px solid #e8f4fd', borderRadius: '8px', background: '#f6ffed' }}>\r\n                              <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '8px' }}>\r\n                                <div>\r\n                                  <Text strong style={{ color: '#1890ff', fontSize: '14px' }}>\r\n                                    📦 Đơn hàng #{order.order_number || order.id}\r\n                                  </Text>\r\n                                  <div style={{ fontSize: '11px', color: '#666' }}>\r\n                                    📅 {formatDate(order.created_at)}\r\n                                  </div>\r\n                                </div>\r\n                                <div style={{ textAlign: 'right' }}>\r\n                                  <div style={{ fontSize: '16px', fontWeight: 'bold', color: '#52c41a' }}>\r\n                                    {formatCurrency(order.total_amount)}\r\n                                  </div>\r\n                                  <Tag color={order.status === 'completed' ? 'green' : 'orange'} size=\"small\">\r\n                                    {order.status === 'completed' ? 'Hoàn thành' : order.status}\r\n                                  </Tag>\r\n                                </div>\r\n                              </div>\r\n                              \r\n                              {/* Order Items */}\r\n                              {order.items && order.items.length > 0 && (\r\n                                <div style={{ marginTop: '8px', padding: '8px', background: '#fff', borderRadius: '4px' }}>\r\n                                  <Text strong style={{ fontSize: '12px', color: '#666' }}>📋 Sản phẩm đã mua:</Text>\r\n                                  {order.items.slice(0, 3).map((item, itemIndex) => (\r\n                                    <div key={itemIndex} style={{ fontSize: '11px', color: '#333', marginTop: '4px', paddingLeft: '8px' }}>\r\n                                      • {item.product_name} (x{item.quantity}) - {formatCurrency(item.subtotal)}\r\n                                      {/* Hiển thị serials và bảo hành */}\r\n                                      {orderSerials[`${order.id}_${item.product_id}`] && orderSerials[`${order.id}_${item.product_id}`].length > 0 && (\r\n                                        <div style={{ marginLeft: 16, marginTop: 2 }}>\r\n                                          {orderSerials[`${order.id}_${item.product_id}`]\r\n                                            .slice(0, item.quantity)\r\n                                            .map((serial, snIdx) => {\r\n                                              let daysLeft = '?';\r\n                                              if (serial.warranty_end_date) {\r\n                                                const end = dayjs(serial.warranty_end_date);\r\n                                                const now = dayjs();\r\n                                                daysLeft = end.diff(now, 'day');\r\n                                                if (daysLeft < 0) daysLeft = 'Hết hạn';\r\n                                              }\r\n                                              return (\r\n                                                <div key={snIdx} style={{ fontSize: '11px', color: '#1890ff' }}>\r\n                                                  SN: <b>{serial.serial_number}</b>\r\n                                                  {serial.warranty_start_date && serial.warranty_end_date && (\r\n                                                    <span style={{ color: '#fa8c16', marginLeft: 8 }}>\r\n                                                      | Bảo hành: {formatDate(serial.warranty_start_date)} → {formatDate(serial.warranty_end_date)}\r\n                                                      <span style={{ color: '#52c41a', marginLeft: 4 }}>\r\n                                                        (Còn {daysLeft} ngày)\r\n                                                      </span>\r\n                                                    </span>\r\n                                                  )}\r\n                                                </div>\r\n                                              );\r\n                                            })}\r\n                                        </div>\r\n                                      )}\r\n                                    </div>\r\n                                  ))}\r\n                                  {order.items.length > 3 && (\r\n                                    <div style={{ fontSize: '11px', color: '#1890ff', fontStyle: 'italic', marginTop: '4px', paddingLeft: '8px' }}>\r\n                                      ... và {order.items.length - 3} sản phẩm khác\r\n                                    </div>\r\n                                  )}\r\n                                </div>\r\n                              )}\r\n                              \r\n                              {order.notes && (\r\n                                <div style={{ marginTop: '6px', fontSize: '11px', color: '#666', fontStyle: 'italic' }}>\r\n                                  💬 {order.notes}\r\n                                </div>\r\n                              )}\r\n                            </div>\r\n                          </Timeline.Item>\r\n                        ))}\r\n                      </Timeline>\r\n                    ) : (\r\n                      <Empty\r\n                        image={Empty.PRESENTED_IMAGE_SIMPLE}\r\n                        description={\r\n                          <div>\r\n                            <div style={{ fontSize: '16px', marginBottom: '8px' }}>🛒 Chưa có lịch sử mua hàng</div>\r\n                            <Text type=\"secondary\">Khách hàng này chưa thực hiện đơn hàng nào</Text>\r\n                          </div>\r\n                        }\r\n                      />\r\n                    )}\r\n                  </div>\r\n                </TabPane>\r\n              </Tabs>\r\n            </Card>\r\n          </div>\r\n        )}\r\n      </Drawer>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default CustomersPage; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}