{"ast":null,"code":"// QRScanner.js (Đã sửa đổi và cải tiến)\nimport React,{useEffect,useRef,useState,useCallback}from'react';import{Modal,Button,Space,message,Alert,Spin,Typography}from'antd';import{CameraOutlined,CloseOutlined,ReloadOutlined,CheckCircleOutlined}from'@ant-design/icons';import{Html5Qrcode}from'html5-qrcode';import{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";const{Text}=Typography;const QRScanner=_ref=>{let{visible,onClose,onScan,title=\"Quét Serial Number\",placeholder=\"Đưa camera vào mã QR hoặc Barcode\"}=_ref;const scannerRef=useRef(null);// Ref cho instance của Html5Qrcode\nconst readerRef=useRef(null);// Ref cho DOM element\nconst[isScanning,setIsScanning]=useState(false);const[error,setError]=useState(null);const[permissionState,setPermissionState]=useState('unknown');// Hàm dọn dẹp an toàn\nconst stopScanner=useCallback(async()=>{if(scannerRef.current&&scannerRef.current.isScanning){try{await scannerRef.current.stop();}catch(err){console.warn(\"Lỗi khi dừng scanner, có thể bỏ qua:\",err);}}scannerRef.current=null;setIsScanning(false);},[]);// Hàm xử lý lỗi camera tập trung\nconst handleCameraError=useCallback(err=>{let errorMessage=\"L\\u1ED7i kh\\xF4ng x\\xE1c \\u0111\\u1ECBnh: \".concat(err.message||err.name);if(err.name==='NotAllowedError'||err.name==='PermissionDeniedError'){errorMessage='Quyền truy cập camera đã bị từ chối. Vui lòng cấp quyền trong cài đặt trình duyệt.';setPermissionState('denied');}else if(err.name==='NotFoundError'||err.name==='DevicesNotFoundError'){errorMessage='Không tìm thấy camera nào trên thiết bị của bạn.';}else if(err.name==='NotReadableError'){errorMessage='Camera đang được sử dụng bởi một ứng dụng khác.';}setError(errorMessage);stopScanner();},[stopScanner]);// Luồng khởi tạo scanner chính\nconst startScannerFlow=useCallback(async()=>{if(isScanning||!readerRef.current)return;setError(null);setIsScanning(true);try{// 1. Kiểm tra quyền (không cần thiết vì thư viện tự xử lý, nhưng tốt để có phản hồi UI)\nif(navigator.permissions){const perm=await navigator.permissions.query({name:'camera'});setPermissionState(perm.state);perm.onchange=()=>setPermissionState(perm.state);if(perm.state==='denied'){throw new Error('PermissionDeniedError');}}// 2. Lấy camera sau (nếu có)\nconst devices=await Html5Qrcode.getCameras();if(!devices||devices.length===0){throw new Error('NotFoundError');}const backCamera=devices.find(d=>d.label.toLowerCase().includes('back'))||devices[0];const cameraId=backCamera.id;// 3. Khởi tạo và bắt đầu scanner\nconst html5QrCode=new Html5Qrcode(readerRef.current.id);scannerRef.current=html5QrCode;await html5QrCode.start(cameraId,// <-- Sửa lỗi quan trọng: Sử dụng deviceId thay vì object\n{fps:10,qrbox:{width:250,height:250}},(decodedText,decodedResult)=>{// Thành công\nstopScanner();message.success(\"\\uD83D\\uDCF1 \\u0110\\xE3 qu\\xE9t th\\xE0nh c\\xF4ng: \".concat(decodedText));onScan(decodedText);onClose();},errorMessage=>{// Bỏ qua lỗi không tìm thấy QR\nif(!errorMessage.includes('NotFoundException')){console.warn(\"L\\u1ED7i qu\\xE9t QR: \".concat(errorMessage));}});setPermissionState('granted');}catch(err){handleCameraError(err);setIsScanning(false);}},[isScanning,onScan,onClose,handleCameraError,stopScanner]);// Effect chính để quản lý vòng đời scanner\nuseEffect(()=>{if(visible){// Dùng setTimeout để đảm bảo Modal đã render và readerRef.current tồn tại\nconst timer=setTimeout(()=>{startScannerFlow();},300);return()=>clearTimeout(timer);}else{stopScanner();}},[visible,startScannerFlow,stopScanner]);// Hàm xử lý đóng modal\nconst handleClose=()=>{stopScanner();onClose();};// Render UI\nconst renderContent=()=>{var _scannerRef$current;if(error){return/*#__PURE__*/_jsx(Alert,{message:\"L\\u1ED7i Camera\",description:error,type:\"error\",showIcon:true,action:/*#__PURE__*/_jsx(Button,{size:\"small\",type:\"primary\",onClick:startScannerFlow,children:\"Th\\u1EED l\\u1EA1i\"})});}if(permissionState==='prompt'){return/*#__PURE__*/_jsx(Alert,{message:\"Y\\xEAu c\\u1EA7u quy\\u1EC1n truy c\\u1EADp Camera\",description:\"\\u1EE8ng d\\u1EE5ng c\\u1EA7n quy\\u1EC1n truy c\\u1EADp camera \\u0111\\u1EC3 qu\\xE9t m\\xE3. Vui l\\xF2ng b\\u1EA5m 'Cho ph\\xE9p' tr\\xEAn tr\\xECnh duy\\u1EC7t.\",type:\"info\",showIcon:true});}if(!isScanning&&permissionState!=='granted'){return/*#__PURE__*/_jsx(\"div\",{style:{textAlign:'center',padding:'20px'},children:/*#__PURE__*/_jsx(Spin,{size:\"large\",tip:\"\\u0110ang ch\\u1EDD c\\u1EA5p quy\\u1EC1n camera...\"})});}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Alert,{message:\"Camera \\u0111\\xE3 s\\u1EB5n s\\xE0ng\",description:placeholder,type:\"success\",showIcon:true,style:{marginBottom:16}}),isScanning&&!((_scannerRef$current=scannerRef.current)!==null&&_scannerRef$current!==void 0&&_scannerRef$current.isScanning)&&/*#__PURE__*/_jsx(\"div\",{style:{padding:'40px',textAlign:'center'},children:/*#__PURE__*/_jsx(Spin,{size:\"large\",tip:\"\\u0110ang kh\\u1EDFi t\\u1EA1o camera...\"})})]});};return/*#__PURE__*/_jsx(Modal,{title:/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsx(CameraOutlined,{}),/*#__PURE__*/_jsx(\"span\",{children:title}),permissionState==='granted'&&/*#__PURE__*/_jsx(CheckCircleOutlined,{style:{color:'#52c41a'}})]}),open:visible,onCancel:handleClose,width:Math.min(600,window.innerWidth-32),footer:[/*#__PURE__*/_jsx(Button,{icon:/*#__PURE__*/_jsx(ReloadOutlined,{}),onClick:startScannerFlow,children:\"Th\\u1EED l\\u1EA1i\"},\"retry\"),/*#__PURE__*/_jsx(Button,{icon:/*#__PURE__*/_jsx(CloseOutlined,{}),onClick:handleClose,children:\"\\u0110\\xF3ng\"},\"close\")],centered:true,destroyOnClose:true// Quan trọng: Hủy component khi đóng để dọn dẹp triệt để\n,children:/*#__PURE__*/_jsxs(\"div\",{style:{padding:'20px 0'},children:[renderContent(),/*#__PURE__*/_jsx(\"div\",{id:\"qr-reader-container\",ref:readerRef,style:{width:'100%',minHeight:'250px',border:error?'2px dashed #ff4d4f':'2px dashed #d9d9d9',borderRadius:'8px',marginTop:'16px'}}),/*#__PURE__*/_jsx(Text,{type:\"secondary\",style:{display:'block',textAlign:'center',marginTop:'16px'},children:\"\\uD83D\\uDCA1 H\\u1ED7 tr\\u1EE3 qu\\xE9t: QR Code & Barcode\"})]})});};export default QRScanner;","map":{"version":3,"names":["React","useEffect","useRef","useState","useCallback","Modal","Button","Space","message","Alert","Spin","Typography","CameraOutlined","CloseOutlined","ReloadOutlined","CheckCircleOutlined","Html5Qrcode","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","Text","QRScanner","_ref","visible","onClose","onScan","title","placeholder","scannerRef","readerRef","isScanning","setIsScanning","error","setError","permissionState","setPermissionState","stopScanner","current","stop","err","console","warn","handleCameraError","errorMessage","concat","name","startScannerFlow","navigator","permissions","perm","query","state","onchange","Error","devices","getCameras","length","backCamera","find","d","label","toLowerCase","includes","cameraId","id","html5QrCode","start","fps","qrbox","width","height","decodedText","decodedResult","success","timer","setTimeout","clearTimeout","handleClose","renderContent","_scannerRef$current","description","type","showIcon","action","size","onClick","children","style","textAlign","padding","tip","marginBottom","color","open","onCancel","Math","min","window","innerWidth","footer","icon","centered","destroyOnClose","ref","minHeight","border","borderRadius","marginTop","display"],"sources":["C:/Users/ADMIN/Desktop/kho/kho/client/src/components/QRScanner.js"],"sourcesContent":["// QRScanner.js (Đã sửa đổi và cải tiến)\r\nimport React, { useEffect, useRef, useState, useCallback } from 'react';\r\nimport { Modal, Button, Space, message, Alert, Spin, Typography } from 'antd';\r\nimport { CameraOutlined, CloseOutlined, ReloadOutlined, CheckCircleOutlined } from '@ant-design/icons';\r\nimport { Html5Qrcode } from 'html5-qrcode';\r\n\r\nconst { Text } = Typography;\r\n\r\nconst QRScanner = ({\r\n  visible,\r\n  onClose,\r\n  onScan,\r\n  title = \"Quét Serial Number\",\r\n  placeholder = \"Đưa camera vào mã QR hoặc Barcode\"\r\n}) => {\r\n  const scannerRef = useRef(null); // Ref cho instance của Html5Qrcode\r\n  const readerRef = useRef(null); // Ref cho DOM element\r\n  const [isScanning, setIsScanning] = useState(false);\r\n  const [error, setError] = useState(null);\r\n  const [permissionState, setPermissionState] = useState('unknown');\r\n\r\n  // Hàm dọn dẹp an toàn\r\n  const stopScanner = useCallback(async () => {\r\n    if (scannerRef.current && scannerRef.current.isScanning) {\r\n      try {\r\n        await scannerRef.current.stop();\r\n      } catch (err) {\r\n        console.warn(\"Lỗi khi dừng scanner, có thể bỏ qua:\", err);\r\n      }\r\n    }\r\n    scannerRef.current = null;\r\n    setIsScanning(false);\r\n  }, []);\r\n\r\n  // Hàm xử lý lỗi camera tập trung\r\n  const handleCameraError = useCallback((err) => {\r\n    let errorMessage = `Lỗi không xác định: ${err.message || err.name}`;\r\n    if (err.name === 'NotAllowedError' || err.name === 'PermissionDeniedError') {\r\n      errorMessage = 'Quyền truy cập camera đã bị từ chối. Vui lòng cấp quyền trong cài đặt trình duyệt.';\r\n      setPermissionState('denied');\r\n    } else if (err.name === 'NotFoundError' || err.name === 'DevicesNotFoundError') {\r\n      errorMessage = 'Không tìm thấy camera nào trên thiết bị của bạn.';\r\n    } else if (err.name === 'NotReadableError') {\r\n      errorMessage = 'Camera đang được sử dụng bởi một ứng dụng khác.';\r\n    }\r\n    setError(errorMessage);\r\n    stopScanner();\r\n  }, [stopScanner]);\r\n\r\n  // Luồng khởi tạo scanner chính\r\n  const startScannerFlow = useCallback(async () => {\r\n    if (isScanning || !readerRef.current) return;\r\n    setError(null);\r\n    setIsScanning(true);\r\n\r\n    try {\r\n      // 1. Kiểm tra quyền (không cần thiết vì thư viện tự xử lý, nhưng tốt để có phản hồi UI)\r\n      if (navigator.permissions) {\r\n        const perm = await navigator.permissions.query({ name: 'camera' });\r\n        setPermissionState(perm.state);\r\n        perm.onchange = () => setPermissionState(perm.state);\r\n        if (perm.state === 'denied') {\r\n            throw new Error('PermissionDeniedError');\r\n        }\r\n      }\r\n      \r\n      // 2. Lấy camera sau (nếu có)\r\n      const devices = await Html5Qrcode.getCameras();\r\n      if (!devices || devices.length === 0) {\r\n        throw new Error('NotFoundError');\r\n      }\r\n      \r\n      const backCamera = devices.find(d => d.label.toLowerCase().includes('back')) || devices[0];\r\n      const cameraId = backCamera.id;\r\n      \r\n      // 3. Khởi tạo và bắt đầu scanner\r\n      const html5QrCode = new Html5Qrcode(readerRef.current.id);\r\n      scannerRef.current = html5QrCode;\r\n\r\n      await html5QrCode.start(\r\n        cameraId, // <-- Sửa lỗi quan trọng: Sử dụng deviceId thay vì object\r\n        {\r\n          fps: 10,\r\n          qrbox: { width: 250, height: 250 },\r\n        },\r\n        (decodedText, decodedResult) => {\r\n          // Thành công\r\n          stopScanner();\r\n          message.success(`📱 Đã quét thành công: ${decodedText}`);\r\n          onScan(decodedText);\r\n          onClose();\r\n        },\r\n        (errorMessage) => {\r\n          // Bỏ qua lỗi không tìm thấy QR\r\n          if (!errorMessage.includes('NotFoundException')) {\r\n            console.warn(`Lỗi quét QR: ${errorMessage}`);\r\n          }\r\n        }\r\n      );\r\n      setPermissionState('granted');\r\n\r\n    } catch (err) {\r\n      handleCameraError(err);\r\n      setIsScanning(false);\r\n    }\r\n  }, [isScanning, onScan, onClose, handleCameraError, stopScanner]);\r\n\r\n  // Effect chính để quản lý vòng đời scanner\r\n  useEffect(() => {\r\n    if (visible) {\r\n      // Dùng setTimeout để đảm bảo Modal đã render và readerRef.current tồn tại\r\n      const timer = setTimeout(() => {\r\n        startScannerFlow();\r\n      }, 300);\r\n      return () => clearTimeout(timer);\r\n    } else {\r\n      stopScanner();\r\n    }\r\n  }, [visible, startScannerFlow, stopScanner]);\r\n  \r\n  // Hàm xử lý đóng modal\r\n  const handleClose = () => {\r\n    stopScanner();\r\n    onClose();\r\n  };\r\n\r\n  // Render UI\r\n  const renderContent = () => {\r\n    if (error) {\r\n      return (\r\n        <Alert\r\n          message=\"Lỗi Camera\"\r\n          description={error}\r\n          type=\"error\"\r\n          showIcon\r\n          action={\r\n            <Button size=\"small\" type=\"primary\" onClick={startScannerFlow}>\r\n              Thử lại\r\n            </Button>\r\n          }\r\n        />\r\n      );\r\n    }\r\n\r\n    if (permissionState === 'prompt') {\r\n        return (\r\n            <Alert\r\n              message=\"Yêu cầu quyền truy cập Camera\"\r\n              description=\"Ứng dụng cần quyền truy cập camera để quét mã. Vui lòng bấm 'Cho phép' trên trình duyệt.\"\r\n              type=\"info\"\r\n              showIcon\r\n            />\r\n        );\r\n    }\r\n\r\n    if (!isScanning && permissionState !== 'granted') {\r\n        return (\r\n            <div style={{ textAlign: 'center', padding: '20px' }}>\r\n                <Spin size=\"large\" tip=\"Đang chờ cấp quyền camera...\" />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n      <>\r\n        <Alert\r\n          message=\"Camera đã sẵn sàng\"\r\n          description={placeholder}\r\n          type=\"success\"\r\n          showIcon\r\n          style={{ marginBottom: 16 }}\r\n        />\r\n        {/* Spinner khi đang khởi tạo */}\r\n        {isScanning && !scannerRef.current?.isScanning && (\r\n            <div style={{ padding: '40px', textAlign: 'center' }}>\r\n                <Spin size=\"large\" tip=\"Đang khởi tạo camera...\" />\r\n            </div>\r\n        )}\r\n      </>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <Modal\r\n      title={\r\n        <Space>\r\n          <CameraOutlined />\r\n          <span>{title}</span>\r\n          {permissionState === 'granted' && <CheckCircleOutlined style={{ color: '#52c41a' }} />}\r\n        </Space>\r\n      }\r\n      open={visible}\r\n      onCancel={handleClose}\r\n      width={Math.min(600, window.innerWidth - 32)}\r\n      footer={[\r\n        <Button key=\"retry\" icon={<ReloadOutlined />} onClick={startScannerFlow}>\r\n          Thử lại\r\n        </Button>,\r\n        <Button key=\"close\" icon={<CloseOutlined />} onClick={handleClose}>\r\n          Đóng\r\n        </Button>,\r\n      ]}\r\n      centered\r\n      destroyOnClose // Quan trọng: Hủy component khi đóng để dọn dẹp triệt để\r\n    >\r\n      <div style={{ padding: '20px 0' }}>\r\n        {renderContent()}\r\n        <div\r\n          id=\"qr-reader-container\"\r\n          ref={readerRef}\r\n          style={{ \r\n            width: '100%', \r\n            minHeight: '250px', \r\n            border: (error) ? '2px dashed #ff4d4f' : '2px dashed #d9d9d9',\r\n            borderRadius: '8px',\r\n            marginTop: '16px'\r\n        }}\r\n        />\r\n        <Text type=\"secondary\" style={{ display: 'block', textAlign: 'center', marginTop: '16px' }}>\r\n            💡 Hỗ trợ quét: QR Code & Barcode\r\n        </Text>\r\n      </div>\r\n    </Modal>\r\n  );\r\n};\r\n\r\nexport default QRScanner;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}