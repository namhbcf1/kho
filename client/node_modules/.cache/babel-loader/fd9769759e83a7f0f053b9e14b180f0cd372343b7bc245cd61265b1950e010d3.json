{"ast":null,"code":"import _objectSpread from\"C:/Users/ADMIN/Desktop/kho/kho/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{message}from'antd';import{Card,Table,Button,Modal,Input,Select,DatePicker,Space,Tag,Row,Col,Statistic,Tabs,InputNumber,Alert,Badge,Typography,Form}from'antd';import{PlusOutlined,UserOutlined,ShopOutlined,DollarOutlined,ExclamationCircleOutlined,CheckCircleOutlined,CreditCardOutlined,WalletOutlined}from'@ant-design/icons';import{customersAPI,suppliersAPI,financialAPI}from'../services/api';import dayjs from'dayjs';import DebtPaymentModal from'../components/DebtPaymentModal';import{toast}from'sonner';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const{Option}=Select;const{TabPane}=Tabs;const{Text}=Typography;const DebtPage=()=>{const[customerDebts,setCustomerDebts]=useState([]);const[supplierDebts,setSupplierDebts]=useState([]);const[customers,setCustomers]=useState([]);const[suppliers,setSuppliers]=useState([]);const[loading,setLoading]=useState(false);const[modalVisible,setModalVisible]=useState(false);const[activeTab,setActiveTab]=useState('customers');const[modalType,setModalType]=useState('payment');// 'payment' or 'debt'\nconst[submitting,setSubmitting]=useState(false);const[debtStats,setDebtStats]=useState({totalCustomerDebt:0,totalSupplierDebt:0,overduCustomerDebt:0,overdueSupplierDebt:0});const[supplierTransactions,setSupplierTransactions]=useState([]);const[customerTransactions,setCustomerTransactions]=useState([]);// üÜï Ant Design Form instance\nconst[form]=Form.useForm();const paymentMethods=[{value:'cash',label:'Ti·ªÅn m·∫∑t',icon:/*#__PURE__*/_jsx(DollarOutlined,{})},{value:'card',label:'Th·∫ª',icon:/*#__PURE__*/_jsx(CreditCardOutlined,{})},{value:'transfer',label:'Chuy·ªÉn kho·∫£n',icon:/*#__PURE__*/_jsx(WalletOutlined,{})},{value:'ewallet',label:'V√≠ ƒëi·ªán t·ª≠',icon:/*#__PURE__*/_jsx(WalletOutlined,{})}];useEffect(()=>{console.log('üöÄ DebtPage mounted, fetching data...');fetchData();},[]);useEffect(()=>{console.log('üîÑ Customers state updated:',customers);},[customers]);useEffect(()=>{console.log('üîÑ Suppliers state updated:',suppliers);},[suppliers]);// Process debts when customers/suppliers data changes\nuseEffect(()=>{if(customers.length>0){fetchCustomerDebts();}},[customers]);// eslint-disable-line react-hooks/exhaustive-deps\nuseEffect(()=>{if(suppliers.length>0){fetchSupplierDebts();}},[suppliers]);// eslint-disable-line react-hooks/exhaustive-deps\n// Fetch supplier transactions for history\nuseEffect(()=>{if(activeTab==='suppliers'){fetchSupplierTransactions();}},[activeTab]);// Fetch customer transactions for history\nuseEffect(()=>{if(activeTab==='customers'){fetchCustomerTransactions();}},[activeTab]);const fetchData=async()=>{setLoading(true);try{// First fetch all customers and suppliers\nawait Promise.all([fetchCustomers(),fetchSuppliers()]);// Then process debts (this will be done in useEffect when customers/suppliers change)\n}catch(error){message.error('L·ªói khi t·∫£i d·ªØ li·ªáu');}finally{setLoading(false);}};const fetchCustomerDebts=async()=>{try{// Use customers data that's already fetched and enhanced\nconst customersWithDebt=customers.filter(c=>(c.current_debt||0)>0);setCustomerDebts(customersWithDebt);// Calculate debt stats\nconst totalDebt=customersWithDebt.reduce((sum,c)=>sum+(c.current_debt||0),0);setDebtStats(prev=>_objectSpread(_objectSpread({},prev),{},{totalCustomerDebt:totalDebt}));}catch(error){console.error('Error processing customer debts:',error);setCustomerDebts([]);}};const fetchSupplierDebts=async()=>{try{// Use suppliers data that's already fetched and enhanced\nconst suppliersWithDebt=suppliers.filter(s=>(s.current_debt||0)>0);setSupplierDebts(suppliersWithDebt);// Calculate debt stats\nconst totalDebt=suppliersWithDebt.reduce((sum,s)=>sum+(s.current_debt||0),0);setDebtStats(prev=>_objectSpread(_objectSpread({},prev),{},{totalSupplierDebt:totalDebt}));}catch(error){console.error('Error processing supplier debts:',error);setSupplierDebts([]);}};const fetchSupplierTransactions=async()=>{try{const response=await financialAPI.getTransactions({type:'expense',category:'Tr·∫£ n·ª£ nh√† cung c·∫•p',limit:10});if(response.data.success){setSupplierTransactions(response.data.data||[]);}else{setSupplierTransactions([]);}}catch(error){setSupplierTransactions([]);}};const fetchCustomerTransactions=async()=>{try{const response=await financialAPI.getTransactions({type:'income',category:'Thu n·ª£ kh√°ch h√†ng',limit:10});if(response.data.success){setCustomerTransactions(response.data.data||[]);}else{setCustomerTransactions([]);}}catch(error){setCustomerTransactions([]);}};const fetchCustomers=async()=>{try{const response=await customersAPI.getAll();console.log('üë• Raw customers response:',response.data);if(response.data.success){// Kh√¥ng c√≤n mock, ch·ªâ l·∫•y s·ªë n·ª£ th·∫≠t t·ª´ API\nconst customersWithDebt=response.data.data.map(customer=>_objectSpread(_objectSpread({},customer),{},{current_debt:customer.current_debt||0,total_spent:customer.total_spent||0}));console.log('üí∞ Customers with debt:',customersWithDebt);console.log('üìä Total customers for dropdown:',customersWithDebt.length);setCustomers(customersWithDebt);}}catch(error){console.error('Error fetching customers:',error);// Fallback: Set empty array to avoid crashes\nsetCustomers([]);}};const fetchSuppliers=async()=>{try{const response=await suppliersAPI.getAll();console.log('üè≠ Raw suppliers response:',response.data);if(response.data.success){// Kh√¥ng c√≤n mock, ch·ªâ l·∫•y s·ªë n·ª£ th·∫≠t t·ª´ API\nconst suppliersWithDebt=response.data.data.map(supplier=>_objectSpread(_objectSpread({},supplier),{},{current_debt:supplier.current_debt||0,total_purchases:supplier.total_purchases||0}));console.log('üí∞ Suppliers with debt:',suppliersWithDebt);console.log('üìä Total suppliers for dropdown:',suppliersWithDebt.length);setSuppliers(suppliersWithDebt);}}catch(error){console.error('Error fetching suppliers:',error);// Fallback: Set empty array to avoid crashes\nsetSuppliers([]);}};// üÜï Enhanced form submission with proper error handling\nconst handlePayDebt=async values=>{try{var _values$transaction_d;setSubmitting(true);console.log('üí∞ Submitting payment data:',values);const transactionData={type:activeTab==='customers'?'income':'expense',category:activeTab==='customers'?'Thu n·ª£ kh√°ch h√†ng':'Tr·∫£ n·ª£ nh√† cung c·∫•p',amount:values.amount,description:values.description||\"Thanh to\\xE1n n\\u1EE3 \".concat(activeTab==='customers'?'kh√°ch h√†ng':'nh√† cung c·∫•p'),customer_id:activeTab==='customers'?values.entity_id:null,supplier_id:activeTab==='suppliers'?values.entity_id:null,payment_method:values.payment_method,transaction_date:((_values$transaction_d=values.transaction_date)===null||_values$transaction_d===void 0?void 0:_values$transaction_d.toISOString())||new Date().toISOString(),user_id:1};console.log('üì§ Transaction data to send:',transactionData);const response=await financialAPI.create(transactionData);if(response.data.success){toast.success('Ghi nh·∫≠n thanh to√°n th√†nh c√¥ng!');setModalVisible(false);form.resetFields();fetchData();}else{throw new Error(response.data.message||'L·ªói kh√¥ng x√°c ƒë·ªãnh');}}catch(error){console.error('‚ùå Payment submission error:',error);toast.error(error.message||'L·ªói khi ghi nh·∫≠n thanh to√°n');}finally{setSubmitting(false);}};// üÜï Enhanced modal close handler\nconst handleModalClose=()=>{setModalVisible(false);form.resetFields();setSubmitting(false);};const customerColumns=[{title:'M√£ KH',dataIndex:'code',key:'code',width:100},{title:'T√™n kh√°ch h√†ng',dataIndex:'name',key:'name',render:(name,record)=>/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{children:name}),record.phone&&/*#__PURE__*/_jsx(Text,{type:\"secondary\",style:{fontSize:12},children:record.phone})]})},{title:'Lo·∫°i KH',dataIndex:'customer_type',key:'customer_type',render:type=>{const colors={regular:'default',vip:'gold',wholesale:'blue'};const labels={regular:'Th∆∞·ªùng',vip:'VIP',wholesale:'S·ªâ'};return/*#__PURE__*/_jsx(Tag,{color:colors[type],children:labels[type]});}},{title:'S·ªë n·ª£',dataIndex:'current_debt',key:'current_debt',render:debt=>/*#__PURE__*/_jsxs(Text,{strong:true,style:{color:debt>0?'#ff4d4f':'#52c41a'},children:[debt.toLocaleString('vi-VN'),\" \\u20AB\"]}),sorter:(a,b)=>a.current_debt-b.current_debt},{title:'T·ªïng chi ti√™u',dataIndex:'total_spent',key:'total_spent',render:spent=>/*#__PURE__*/_jsxs(Text,{type:\"secondary\",children:[spent?spent.toLocaleString('vi-VN'):0,\" \\u20AB\"]})},{title:'Tr·∫°ng th√°i',key:'status',render:(_,record)=>{const debt=record.current_debt||0;if(debt===0){return/*#__PURE__*/_jsx(Badge,{status:\"success\",text:\"\\u0110\\xE3 thanh to\\xE1n\"});}else if(debt>1000000){return/*#__PURE__*/_jsx(Badge,{status:\"error\",text:\"N\\u1EE3 l\\u1EDBn\"});}else{return/*#__PURE__*/_jsx(Badge,{status:\"warning\",text:\"C\\xF3 n\\u1EE3\"});}}},{title:'Thao t√°c',key:'actions',render:(_,record)=>/*#__PURE__*/_jsx(Space,{children:/*#__PURE__*/_jsx(Button,{type:\"primary\",size:\"small\",icon:/*#__PURE__*/_jsx(DollarOutlined,{}),onClick:()=>{setModalType('payment');setActiveTab('customers');setModalVisible(true);// üÜï Set form values v·ªõi Ant Design Form\nform.setFieldsValue({entity_id:record.id,payment_method:'cash',transaction_date:dayjs(),amount:record.current_debt||0,description:\"Thanh to\\xE1n n\\u1EE3 kh\\xE1ch h\\xE0ng \".concat(record.name)});},children:\"Thanh to\\xE1n\"})})}];const supplierColumns=[{title:'M√£ NCC',dataIndex:'code',key:'code',width:100},{title:'T√™n nh√† cung c·∫•p',dataIndex:'name',key:'name',render:(name,record)=>/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{children:name}),record.phone&&/*#__PURE__*/_jsx(Text,{type:\"secondary\",style:{fontSize:12},children:record.phone})]})},{title:'ƒê·ªãa ch·ªâ',dataIndex:'address',key:'address',ellipsis:true},{title:'S·ªë n·ª£',dataIndex:'current_debt',key:'current_debt',render:debt=>/*#__PURE__*/_jsxs(Text,{strong:true,style:{color:debt>0?'#ff4d4f':'#52c41a'},children:[debt.toLocaleString('vi-VN'),\" \\u20AB\"]}),sorter:(a,b)=>a.current_debt-b.current_debt},{title:'Tr·∫°ng th√°i',key:'status',render:(_,record)=>{const debt=record.current_debt||0;if(debt===0){return/*#__PURE__*/_jsx(Badge,{status:\"success\",text:\"\\u0110\\xE3 thanh to\\xE1n\"});}else if(debt>5000000){return/*#__PURE__*/_jsx(Badge,{status:\"error\",text:\"N\\u1EE3 l\\u1EDBn\"});}else{return/*#__PURE__*/_jsx(Badge,{status:\"warning\",text:\"C\\xF3 n\\u1EE3\"});}}},{title:'Thao t√°c',key:'actions',render:(_,record)=>/*#__PURE__*/_jsx(Space,{children:/*#__PURE__*/_jsx(Button,{type:\"primary\",size:\"small\",icon:/*#__PURE__*/_jsx(DollarOutlined,{}),onClick:()=>{setModalType('payment');setActiveTab('suppliers');setModalVisible(true);// üÜï Set form values v·ªõi Ant Design Form\nform.setFieldsValue({entity_id:record.id,payment_method:'cash',transaction_date:dayjs(),amount:record.current_debt||0,description:\"Thanh to\\xE1n n\\u1EE3 nh\\xE0 cung c\\u1EA5p \".concat(record.name)});},children:\"Thanh to\\xE1n\"})})}];// Table columns for supplier transaction history\nconst supplierHistoryColumns=[{title:'Ng√†y giao d·ªãch',dataIndex:'transaction_date',key:'transaction_date',render:date=>date?new Date(date).toLocaleString('vi-VN',{timeZone:'Asia/Ho_Chi_Minh'}):'',width:140},{title:'S·ªë ti·ªÅn',dataIndex:'amount',key:'amount',render:amount=>/*#__PURE__*/_jsxs(\"span\",{style:{color:'#cf1322',fontWeight:500},children:[\"- \",amount.toLocaleString('vi-VN'),\" \\u20AB\"]}),width:120},{title:'M√¥ t·∫£',dataIndex:'description',key:'description',render:desc=>desc||'Thanh to√°n n·ª£ nh√† cung c·∫•p'}];const customerHistoryColumns=[{title:'Ng√†y giao d·ªãch',dataIndex:'transaction_date',key:'transaction_date',render:date=>date?new Date(date).toLocaleString('vi-VN',{timeZone:'Asia/Ho_Chi_Minh'}):'',width:140},{title:'S·ªë ti·ªÅn',dataIndex:'amount',key:'amount',render:amount=>/*#__PURE__*/_jsxs(\"span\",{style:{color:'#52c41a',fontWeight:500},children:[\"+ \",amount.toLocaleString('vi-VN'),\" \\u20AB\"]}),width:120},{title:'M√¥ t·∫£',dataIndex:'description',key:'description',render:desc=>desc||'Thu n·ª£ kh√°ch h√†ng'}];const renderDebtSummary=()=>{return/*#__PURE__*/_jsxs(Row,{gutter:16,style:{marginBottom:24},children:[/*#__PURE__*/_jsx(Col,{span:6,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(Statistic,{title:\"T\\u1ED5ng kh\\xE1ch h\\xE0ng n\\u1EE3\",value:customerDebts.length,valueStyle:{color:'#52c41a'},prefix:/*#__PURE__*/_jsx(UserOutlined,{})})})}),/*#__PURE__*/_jsx(Col,{span:6,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(Statistic,{title:\"T\\u1ED5ng n\\u1EE3 nh\\xE0 cung c\\u1EA5p\",value:debtStats.totalSupplierDebt,precision:0,valueStyle:{color:'#cf1322'},prefix:/*#__PURE__*/_jsx(ShopOutlined,{}),suffix:\"\\u20AB\"})})}),/*#__PURE__*/_jsx(Col,{span:6,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(Statistic,{title:\"T\\u1ED5ng n\\u1EE3 ph\\u1EA3i thu\",value:debtStats.totalCustomerDebt+debtStats.totalSupplierDebt,precision:0,valueStyle:{color:'#1890ff'},prefix:/*#__PURE__*/_jsx(DollarOutlined,{}),suffix:\"\\u20AB\"})})})]});};return/*#__PURE__*/_jsxs(\"div\",{style:{padding:24},children:[renderDebtSummary(),/*#__PURE__*/_jsx(Alert,{message:\"Qu\\u1EA3n l\\xFD n\\u1EE3\",description:\"Theo d\\xF5i v\\xE0 qu\\u1EA3n l\\xFD c\\xE1c kho\\u1EA3n n\\u1EE3 c\\u1EE7a kh\\xE1ch h\\xE0ng v\\xE0 nh\\xE0 cung c\\u1EA5p. H\\u1EC7 th\\u1ED1ng s\\u1EBD t\\u1EF1 \\u0111\\u1ED9ng c\\u1EADp nh\\u1EADt s\\u1ED1 d\\u01B0 n\\u1EE3 khi c\\xF3 giao d\\u1ECBch thanh to\\xE1n.\",type:\"info\",showIcon:true,style:{marginBottom:24}}),/*#__PURE__*/_jsxs(Tabs,{activeKey:activeTab,onChange:setActiveTab,children:[/*#__PURE__*/_jsx(TabPane,{tab:/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(UserOutlined,{}),\"Kh\\xE1ch h\\xE0ng n\\u1EE3 (\",customerDebts.length,\")\"]}),children:/*#__PURE__*/_jsxs(Row,{gutter:24,children:[/*#__PURE__*/_jsx(Col,{span:15,children:/*#__PURE__*/_jsx(Card,{title:\"Danh s\\xE1ch kh\\xE1ch h\\xE0ng c\\xF3 n\\u1EE3\",extra:/*#__PURE__*/_jsx(Button,{type:\"primary\",icon:/*#__PURE__*/_jsx(PlusOutlined,{}),onClick:()=>{setModalType('payment');setActiveTab('customers');setModalVisible(true);// üÜï Reset form v·ªõi values m·∫∑c ƒë·ªãnh\nform.setFieldsValue({payment_method:'cash',transaction_date:dayjs(),entity_id:undefined,amount:undefined,description:''});},children:\"Ghi nh\\u1EADn thanh to\\xE1n\"}),children:/*#__PURE__*/_jsx(Table,{columns:customerColumns,dataSource:customerDebts,loading:loading,rowKey:\"id\",pagination:{showSizeChanger:true,showQuickJumper:true,showTotal:(total,range)=>\"\".concat(range[0],\"-\").concat(range[1],\" c\\u1EE7a \").concat(total,\" kh\\xE1ch h\\xE0ng\")}})})}),/*#__PURE__*/_jsx(Col,{span:9,children:/*#__PURE__*/_jsx(Card,{title:\"L\\u1ECBch s\\u1EED thu n\\u1EE3 kh\\xE1ch h\\xE0ng\",bordered:true,style:{minHeight:400},children:/*#__PURE__*/_jsx(Table,{columns:customerHistoryColumns,dataSource:customerTransactions,rowKey:\"id\",size:\"small\",pagination:{pageSize:8},locale:{emptyText:'Ch∆∞a c√≥ giao d·ªãch'}})})})]})},\"customers\"),/*#__PURE__*/_jsx(TabPane,{tab:/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(ShopOutlined,{}),\"N\\u1EE3 nh\\xE0 cung c\\u1EA5p (\",supplierDebts.length,\")\"]}),children:/*#__PURE__*/_jsxs(Row,{gutter:24,children:[/*#__PURE__*/_jsx(Col,{span:15,children:/*#__PURE__*/_jsx(Card,{title:\"Danh s\\xE1ch nh\\xE0 cung c\\u1EA5p c\\xF3 n\\u1EE3\",extra:/*#__PURE__*/_jsx(Button,{type:\"primary\",icon:/*#__PURE__*/_jsx(PlusOutlined,{}),onClick:()=>{setModalType('payment');setActiveTab('suppliers');setModalVisible(true);// üÜï Reset form v·ªõi values m·∫∑c ƒë·ªãnh\nform.setFieldsValue({payment_method:'cash',transaction_date:dayjs(),entity_id:undefined,amount:undefined,description:''});},children:\"Ghi nh\\u1EADn thanh to\\xE1n\"}),children:/*#__PURE__*/_jsx(Table,{columns:supplierColumns,dataSource:supplierDebts,loading:loading,rowKey:\"id\",pagination:{showSizeChanger:true,showQuickJumper:true,showTotal:(total,range)=>\"\".concat(range[0],\"-\").concat(range[1],\" c\\u1EE7a \").concat(total,\" nh\\xE0 cung c\\u1EA5p\")}})})}),/*#__PURE__*/_jsx(Col,{span:9,children:/*#__PURE__*/_jsx(Card,{title:\"L\\u1ECBch s\\u1EED thanh to\\xE1n n\\u1EE3 nh\\xE0 cung c\\u1EA5p\",bordered:true,style:{minHeight:400},children:/*#__PURE__*/_jsx(Table,{columns:supplierHistoryColumns,dataSource:supplierTransactions,rowKey:\"id\",size:\"small\",pagination:{pageSize:8},locale:{emptyText:'Ch∆∞a c√≥ giao d·ªãch'}})})})]})},\"suppliers\")]}),/*#__PURE__*/_jsx(DebtPaymentModal,{open:modalVisible,onClose:handleModalClose,onSubmit:handlePayDebt,activeTab:activeTab,modalType:modalType,form:form,customers:customers,suppliers:suppliers,submitting:submitting})]});};export default DebtPage;","map":{"version":3,"names":["React","useState","useEffect","message","Card","Table","Button","Modal","Input","Select","DatePicker","Space","Tag","Row","Col","Statistic","Tabs","InputNumber","Alert","Badge","Typography","Form","PlusOutlined","UserOutlined","ShopOutlined","DollarOutlined","ExclamationCircleOutlined","CheckCircleOutlined","CreditCardOutlined","WalletOutlined","customersAPI","suppliersAPI","financialAPI","dayjs","DebtPaymentModal","toast","jsx","_jsx","jsxs","_jsxs","Option","TabPane","Text","DebtPage","customerDebts","setCustomerDebts","supplierDebts","setSupplierDebts","customers","setCustomers","suppliers","setSuppliers","loading","setLoading","modalVisible","setModalVisible","activeTab","setActiveTab","modalType","setModalType","submitting","setSubmitting","debtStats","setDebtStats","totalCustomerDebt","totalSupplierDebt","overduCustomerDebt","overdueSupplierDebt","supplierTransactions","setSupplierTransactions","customerTransactions","setCustomerTransactions","form","useForm","paymentMethods","value","label","icon","console","log","fetchData","length","fetchCustomerDebts","fetchSupplierDebts","fetchSupplierTransactions","fetchCustomerTransactions","Promise","all","fetchCustomers","fetchSuppliers","error","customersWithDebt","filter","c","current_debt","totalDebt","reduce","sum","prev","_objectSpread","suppliersWithDebt","s","response","getTransactions","type","category","limit","data","success","getAll","map","customer","total_spent","supplier","total_purchases","handlePayDebt","values","_values$transaction_d","transactionData","amount","description","concat","customer_id","entity_id","supplier_id","payment_method","transaction_date","toISOString","Date","user_id","create","resetFields","Error","handleModalClose","customerColumns","title","dataIndex","key","width","render","name","record","children","phone","style","fontSize","colors","regular","vip","wholesale","labels","color","debt","strong","toLocaleString","sorter","a","b","spent","_","status","text","size","onClick","setFieldsValue","id","supplierColumns","ellipsis","supplierHistoryColumns","date","timeZone","fontWeight","desc","customerHistoryColumns","renderDebtSummary","gutter","marginBottom","span","valueStyle","prefix","precision","suffix","padding","showIcon","activeKey","onChange","tab","extra","undefined","columns","dataSource","rowKey","pagination","showSizeChanger","showQuickJumper","showTotal","total","range","bordered","minHeight","pageSize","locale","emptyText","open","onClose","onSubmit"],"sources":["C:/Users/ADMIN/Desktop/kho/kho/client/src/pages/DebtPage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { message } from 'antd';\r\nimport {\r\n  Card,\r\n  Table,\r\n  Button,\r\n  Modal,\r\n  Input,\r\n  Select,\r\n  DatePicker,\r\n  Space,\r\n  Tag,\r\n  Row,\r\n  Col,\r\n  Statistic,\r\n  Tabs,\r\n  InputNumber,\r\n  Alert,\r\n  Badge,\r\n  Typography,\r\n  Form,\r\n} from 'antd';\r\nimport {\r\n  PlusOutlined,\r\n  UserOutlined,\r\n  ShopOutlined,\r\n  DollarOutlined,\r\n  ExclamationCircleOutlined,\r\n  CheckCircleOutlined,\r\n  CreditCardOutlined,\r\n  WalletOutlined,\r\n} from '@ant-design/icons';\r\nimport { customersAPI, suppliersAPI, financialAPI } from '../services/api';\r\nimport dayjs from 'dayjs';\r\nimport DebtPaymentModal from '../components/DebtPaymentModal';\r\nimport { toast } from 'sonner';\r\n\r\nconst { Option } = Select;\r\nconst { TabPane } = Tabs;\r\nconst { Text } = Typography;\r\n\r\nconst DebtPage = () => {\r\n  const [customerDebts, setCustomerDebts] = useState([]);\r\n  const [supplierDebts, setSupplierDebts] = useState([]);\r\n  const [customers, setCustomers] = useState([]);\r\n  const [suppliers, setSuppliers] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [modalVisible, setModalVisible] = useState(false);\r\n  const [activeTab, setActiveTab] = useState('customers');\r\n  const [modalType, setModalType] = useState('payment'); // 'payment' or 'debt'\r\n  const [submitting, setSubmitting] = useState(false);\r\n  const [debtStats, setDebtStats] = useState({\r\n    totalCustomerDebt: 0,\r\n    totalSupplierDebt: 0,\r\n    overduCustomerDebt: 0,\r\n    overdueSupplierDebt: 0,\r\n  });\r\n  const [supplierTransactions, setSupplierTransactions] = useState([]);\r\n  const [customerTransactions, setCustomerTransactions] = useState([]);\r\n\r\n  // üÜï Ant Design Form instance\r\n  const [form] = Form.useForm();\r\n\r\n  const paymentMethods = [\r\n    { value: 'cash', label: 'Ti·ªÅn m·∫∑t', icon: <DollarOutlined /> },\r\n    { value: 'card', label: 'Th·∫ª', icon: <CreditCardOutlined /> },\r\n    { value: 'transfer', label: 'Chuy·ªÉn kho·∫£n', icon: <WalletOutlined /> },\r\n    { value: 'ewallet', label: 'V√≠ ƒëi·ªán t·ª≠', icon: <WalletOutlined /> },\r\n  ];\r\n\r\n  useEffect(() => {\r\n    console.log('üöÄ DebtPage mounted, fetching data...');\r\n    fetchData();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    console.log('üîÑ Customers state updated:', customers);\r\n  }, [customers]);\r\n\r\n  useEffect(() => {\r\n    console.log('üîÑ Suppliers state updated:', suppliers);\r\n  }, [suppliers]);\r\n\r\n  // Process debts when customers/suppliers data changes\r\n  useEffect(() => {\r\n    if (customers.length > 0) {\r\n      fetchCustomerDebts();\r\n    }\r\n  }, [customers]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  useEffect(() => {\r\n    if (suppliers.length > 0) {\r\n      fetchSupplierDebts();\r\n    }\r\n  }, [suppliers]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  // Fetch supplier transactions for history\r\n  useEffect(() => {\r\n    if (activeTab === 'suppliers') {\r\n      fetchSupplierTransactions();\r\n    }\r\n  }, [activeTab]);\r\n\r\n  // Fetch customer transactions for history\r\n  useEffect(() => {\r\n    if (activeTab === 'customers') {\r\n      fetchCustomerTransactions();\r\n    }\r\n  }, [activeTab]);\r\n\r\n  const fetchData = async () => {\r\n    setLoading(true);\r\n    try {\r\n      // First fetch all customers and suppliers\r\n      await Promise.all([\r\n        fetchCustomers(),\r\n        fetchSuppliers(),\r\n      ]);\r\n      \r\n      // Then process debts (this will be done in useEffect when customers/suppliers change)\r\n    } catch (error) {\r\n      message.error('L·ªói khi t·∫£i d·ªØ li·ªáu');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const fetchCustomerDebts = async () => {\r\n    try {\r\n      // Use customers data that's already fetched and enhanced\r\n      const customersWithDebt = customers.filter(c => (c.current_debt || 0) > 0);\r\n      setCustomerDebts(customersWithDebt);\r\n      \r\n      // Calculate debt stats\r\n      const totalDebt = customersWithDebt.reduce((sum, c) => sum + (c.current_debt || 0), 0);\r\n      setDebtStats(prev => ({ ...prev, totalCustomerDebt: totalDebt }));\r\n    } catch (error) {\r\n      console.error('Error processing customer debts:', error);\r\n      setCustomerDebts([]);\r\n    }\r\n  };\r\n\r\n  const fetchSupplierDebts = async () => {\r\n    try {\r\n      // Use suppliers data that's already fetched and enhanced\r\n      const suppliersWithDebt = suppliers.filter(s => (s.current_debt || 0) > 0);\r\n      setSupplierDebts(suppliersWithDebt);\r\n      \r\n      // Calculate debt stats\r\n      const totalDebt = suppliersWithDebt.reduce((sum, s) => sum + (s.current_debt || 0), 0);\r\n      setDebtStats(prev => ({ ...prev, totalSupplierDebt: totalDebt }));\r\n    } catch (error) {\r\n      console.error('Error processing supplier debts:', error);\r\n      setSupplierDebts([]);\r\n    }\r\n  };\r\n\r\n  const fetchSupplierTransactions = async () => {\r\n    try {\r\n      const response = await financialAPI.getTransactions({ type: 'expense', category: 'Tr·∫£ n·ª£ nh√† cung c·∫•p', limit: 10 });\r\n      if (response.data.success) {\r\n        setSupplierTransactions(response.data.data || []);\r\n      } else {\r\n        setSupplierTransactions([]);\r\n      }\r\n    } catch (error) {\r\n      setSupplierTransactions([]);\r\n    }\r\n  };\r\n\r\n  const fetchCustomerTransactions = async () => {\r\n    try {\r\n      const response = await financialAPI.getTransactions({ type: 'income', category: 'Thu n·ª£ kh√°ch h√†ng', limit: 10 });\r\n      if (response.data.success) {\r\n        setCustomerTransactions(response.data.data || []);\r\n      } else {\r\n        setCustomerTransactions([]);\r\n      }\r\n    } catch (error) {\r\n      setCustomerTransactions([]);\r\n    }\r\n  };\r\n\r\n  const fetchCustomers = async () => {\r\n    try {\r\n      const response = await customersAPI.getAll();\r\n      console.log('üë• Raw customers response:', response.data);\r\n      \r\n      if (response.data.success) {\r\n        // Kh√¥ng c√≤n mock, ch·ªâ l·∫•y s·ªë n·ª£ th·∫≠t t·ª´ API\r\n        const customersWithDebt = response.data.data.map(customer => ({\r\n          ...customer,\r\n          current_debt: customer.current_debt || 0,\r\n          total_spent: customer.total_spent || 0\r\n        }));\r\n        \r\n        console.log('üí∞ Customers with debt:', customersWithDebt);\r\n        console.log('üìä Total customers for dropdown:', customersWithDebt.length);\r\n        setCustomers(customersWithDebt);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching customers:', error);\r\n      // Fallback: Set empty array to avoid crashes\r\n      setCustomers([]);\r\n    }\r\n  };\r\n\r\n  const fetchSuppliers = async () => {\r\n    try {\r\n      const response = await suppliersAPI.getAll();\r\n      console.log('üè≠ Raw suppliers response:', response.data);\r\n      \r\n      if (response.data.success) {\r\n        // Kh√¥ng c√≤n mock, ch·ªâ l·∫•y s·ªë n·ª£ th·∫≠t t·ª´ API\r\n        const suppliersWithDebt = response.data.data.map(supplier => ({\r\n          ...supplier,\r\n          current_debt: supplier.current_debt || 0,\r\n          total_purchases: supplier.total_purchases || 0\r\n        }));\r\n        \r\n        console.log('üí∞ Suppliers with debt:', suppliersWithDebt);\r\n        console.log('üìä Total suppliers for dropdown:', suppliersWithDebt.length);\r\n        setSuppliers(suppliersWithDebt);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching suppliers:', error);\r\n      // Fallback: Set empty array to avoid crashes\r\n      setSuppliers([]);\r\n    }\r\n  };\r\n\r\n  // üÜï Enhanced form submission with proper error handling\r\n  const handlePayDebt = async (values) => {\r\n    try {\r\n      setSubmitting(true);\r\n      console.log('üí∞ Submitting payment data:', values);\r\n      \r\n      const transactionData = {\r\n        type: activeTab === 'customers' ? 'income' : 'expense',\r\n        category: activeTab === 'customers' ? 'Thu n·ª£ kh√°ch h√†ng' : 'Tr·∫£ n·ª£ nh√† cung c·∫•p',\r\n        amount: values.amount,\r\n        description: values.description || `Thanh to√°n n·ª£ ${activeTab === 'customers' ? 'kh√°ch h√†ng' : 'nh√† cung c·∫•p'}`,\r\n        customer_id: activeTab === 'customers' ? values.entity_id : null,\r\n        supplier_id: activeTab === 'suppliers' ? values.entity_id : null,\r\n        payment_method: values.payment_method,\r\n        transaction_date: values.transaction_date?.toISOString() || new Date().toISOString(),\r\n        user_id: 1,\r\n      };\r\n\r\n      console.log('üì§ Transaction data to send:', transactionData);\r\n\r\n      const response = await financialAPI.create(transactionData);\r\n      if (response.data.success) {\r\n        toast.success('Ghi nh·∫≠n thanh to√°n th√†nh c√¥ng!');\r\n        setModalVisible(false);\r\n        form.resetFields();\r\n        fetchData();\r\n      } else {\r\n        throw new Error(response.data.message || 'L·ªói kh√¥ng x√°c ƒë·ªãnh');\r\n      }\r\n    } catch (error) {\r\n      console.error('‚ùå Payment submission error:', error);\r\n      toast.error(error.message || 'L·ªói khi ghi nh·∫≠n thanh to√°n');\r\n    } finally {\r\n      setSubmitting(false);\r\n    }\r\n  };\r\n\r\n  // üÜï Enhanced modal close handler\r\n  const handleModalClose = () => {\r\n    setModalVisible(false);\r\n    form.resetFields();\r\n    setSubmitting(false);\r\n  };\r\n\r\n  const customerColumns = [\r\n    {\r\n      title: 'M√£ KH',\r\n      dataIndex: 'code',\r\n      key: 'code',\r\n      width: 100,\r\n    },\r\n    {\r\n      title: 'T√™n kh√°ch h√†ng',\r\n      dataIndex: 'name',\r\n      key: 'name',\r\n      render: (name, record) => (\r\n        <div>\r\n          <div>{name}</div>\r\n          {record.phone && (\r\n            <Text type=\"secondary\" style={{ fontSize: 12 }}>\r\n              {record.phone}\r\n            </Text>\r\n          )}\r\n        </div>\r\n      ),\r\n    },\r\n    {\r\n      title: 'Lo·∫°i KH',\r\n      dataIndex: 'customer_type',\r\n      key: 'customer_type',\r\n      render: (type) => {\r\n        const colors = {\r\n          regular: 'default',\r\n          vip: 'gold',\r\n          wholesale: 'blue',\r\n        };\r\n        const labels = {\r\n          regular: 'Th∆∞·ªùng',\r\n          vip: 'VIP',\r\n          wholesale: 'S·ªâ',\r\n        };\r\n        return <Tag color={colors[type]}>{labels[type]}</Tag>;\r\n      },\r\n    },\r\n    {\r\n      title: 'S·ªë n·ª£',\r\n      dataIndex: 'current_debt',\r\n      key: 'current_debt',\r\n      render: (debt) => (\r\n        <Text strong style={{ color: debt > 0 ? '#ff4d4f' : '#52c41a' }}>\r\n          {debt.toLocaleString('vi-VN')} ‚Ç´\r\n        </Text>\r\n      ),\r\n      sorter: (a, b) => a.current_debt - b.current_debt,\r\n    },\r\n    {\r\n      title: 'T·ªïng chi ti√™u',\r\n      dataIndex: 'total_spent',\r\n      key: 'total_spent',\r\n      render: (spent) => (\r\n        <Text type=\"secondary\">\r\n          {spent ? spent.toLocaleString('vi-VN') : 0} ‚Ç´\r\n        </Text>\r\n      ),\r\n    },\r\n    {\r\n      title: 'Tr·∫°ng th√°i',\r\n      key: 'status',\r\n      render: (_, record) => {\r\n        const debt = record.current_debt || 0;\r\n        if (debt === 0) {\r\n          return <Badge status=\"success\" text=\"ƒê√£ thanh to√°n\" />;\r\n        } else if (debt > 1000000) {\r\n          return <Badge status=\"error\" text=\"N·ª£ l·ªõn\" />;\r\n        } else {\r\n          return <Badge status=\"warning\" text=\"C√≥ n·ª£\" />;\r\n        }\r\n      },\r\n    },\r\n    {\r\n      title: 'Thao t√°c',\r\n      key: 'actions',\r\n      render: (_, record) => (\r\n        <Space>\r\n          <Button\r\n            type=\"primary\"\r\n            size=\"small\"\r\n            icon={<DollarOutlined />}\r\n            onClick={() => {\r\n              setModalType('payment');\r\n              setActiveTab('customers');\r\n              setModalVisible(true);\r\n              // üÜï Set form values v·ªõi Ant Design Form\r\n              form.setFieldsValue({\r\n                entity_id: record.id,\r\n                payment_method: 'cash',\r\n                transaction_date: dayjs(),\r\n                amount: record.current_debt || 0,\r\n                description: `Thanh to√°n n·ª£ kh√°ch h√†ng ${record.name}`\r\n              });\r\n            }}\r\n          >\r\n            Thanh to√°n\r\n          </Button>\r\n        </Space>\r\n      ),\r\n    },\r\n  ];\r\n\r\n  const supplierColumns = [\r\n    {\r\n      title: 'M√£ NCC',\r\n      dataIndex: 'code',\r\n      key: 'code',\r\n      width: 100,\r\n    },\r\n    {\r\n      title: 'T√™n nh√† cung c·∫•p',\r\n      dataIndex: 'name',\r\n      key: 'name',\r\n      render: (name, record) => (\r\n        <div>\r\n          <div>{name}</div>\r\n          {record.phone && (\r\n            <Text type=\"secondary\" style={{ fontSize: 12 }}>\r\n              {record.phone}\r\n            </Text>\r\n          )}\r\n        </div>\r\n      ),\r\n    },\r\n    {\r\n      title: 'ƒê·ªãa ch·ªâ',\r\n      dataIndex: 'address',\r\n      key: 'address',\r\n      ellipsis: true,\r\n    },\r\n    {\r\n      title: 'S·ªë n·ª£',\r\n      dataIndex: 'current_debt',\r\n      key: 'current_debt',\r\n      render: (debt) => (\r\n        <Text strong style={{ color: debt > 0 ? '#ff4d4f' : '#52c41a' }}>\r\n          {debt.toLocaleString('vi-VN')} ‚Ç´\r\n        </Text>\r\n      ),\r\n      sorter: (a, b) => a.current_debt - b.current_debt,\r\n    },\r\n    {\r\n      title: 'Tr·∫°ng th√°i',\r\n      key: 'status',\r\n      render: (_, record) => {\r\n        const debt = record.current_debt || 0;\r\n        if (debt === 0) {\r\n          return <Badge status=\"success\" text=\"ƒê√£ thanh to√°n\" />;\r\n        } else if (debt > 5000000) {\r\n          return <Badge status=\"error\" text=\"N·ª£ l·ªõn\" />;\r\n        } else {\r\n          return <Badge status=\"warning\" text=\"C√≥ n·ª£\" />;\r\n        }\r\n      },\r\n    },\r\n    {\r\n      title: 'Thao t√°c',\r\n      key: 'actions',\r\n      render: (_, record) => (\r\n        <Space>\r\n          <Button\r\n            type=\"primary\"\r\n            size=\"small\"\r\n            icon={<DollarOutlined />}\r\n            onClick={() => {\r\n              setModalType('payment');\r\n              setActiveTab('suppliers');\r\n              setModalVisible(true);\r\n              // üÜï Set form values v·ªõi Ant Design Form\r\n              form.setFieldsValue({\r\n                entity_id: record.id,\r\n                payment_method: 'cash',\r\n                transaction_date: dayjs(),\r\n                amount: record.current_debt || 0,\r\n                description: `Thanh to√°n n·ª£ nh√† cung c·∫•p ${record.name}`\r\n              });\r\n            }}\r\n          >\r\n            Thanh to√°n\r\n          </Button>\r\n        </Space>\r\n      ),\r\n    },\r\n  ];\r\n\r\n  // Table columns for supplier transaction history\r\n  const supplierHistoryColumns = [\r\n    {\r\n      title: 'Ng√†y giao d·ªãch',\r\n      dataIndex: 'transaction_date',\r\n      key: 'transaction_date',\r\n      render: (date) => date ? new Date(date).toLocaleString('vi-VN', { timeZone: 'Asia/Ho_Chi_Minh' }) : '',\r\n      width: 140,\r\n    },\r\n    {\r\n      title: 'S·ªë ti·ªÅn',\r\n      dataIndex: 'amount',\r\n      key: 'amount',\r\n      render: (amount) => <span style={{ color: '#cf1322', fontWeight: 500 }}>- {amount.toLocaleString('vi-VN')} ‚Ç´</span>,\r\n      width: 120,\r\n    },\r\n    {\r\n      title: 'M√¥ t·∫£',\r\n      dataIndex: 'description',\r\n      key: 'description',\r\n      render: (desc) => desc || 'Thanh to√°n n·ª£ nh√† cung c·∫•p',\r\n    },\r\n  ];\r\n\r\n  const customerHistoryColumns = [\r\n    {\r\n      title: 'Ng√†y giao d·ªãch',\r\n      dataIndex: 'transaction_date',\r\n      key: 'transaction_date',\r\n      render: (date) => date ? new Date(date).toLocaleString('vi-VN', { timeZone: 'Asia/Ho_Chi_Minh' }) : '',\r\n      width: 140,\r\n    },\r\n    {\r\n      title: 'S·ªë ti·ªÅn',\r\n      dataIndex: 'amount',\r\n      key: 'amount',\r\n      render: (amount) => <span style={{ color: '#52c41a', fontWeight: 500 }}>+ {amount.toLocaleString('vi-VN')} ‚Ç´</span>,\r\n      width: 120,\r\n    },\r\n    {\r\n      title: 'M√¥ t·∫£',\r\n      dataIndex: 'description',\r\n      key: 'description',\r\n      render: (desc) => desc || 'Thu n·ª£ kh√°ch h√†ng',\r\n    },\r\n  ];\r\n\r\n  const renderDebtSummary = () => {\r\n    return (\r\n      <Row gutter={16} style={{ marginBottom: 24 }}>\r\n        <Col span={6}>\r\n          <Card>\r\n            <Statistic\r\n              title=\"T·ªïng kh√°ch h√†ng n·ª£\"\r\n              value={customerDebts.length}\r\n              valueStyle={{ color: '#52c41a' }}\r\n              prefix={<UserOutlined />}\r\n            />\r\n          </Card>\r\n        </Col>\r\n        <Col span={6}>\r\n          <Card>\r\n            <Statistic\r\n              title=\"T·ªïng n·ª£ nh√† cung c·∫•p\"\r\n              value={debtStats.totalSupplierDebt}\r\n              precision={0}\r\n              valueStyle={{ color: '#cf1322' }}\r\n              prefix={<ShopOutlined />}\r\n              suffix=\"‚Ç´\"\r\n            />\r\n          </Card>\r\n        </Col>\r\n        <Col span={6}>\r\n          <Card>\r\n            <Statistic\r\n              title=\"T·ªïng n·ª£ ph·∫£i thu\"\r\n              value={debtStats.totalCustomerDebt + debtStats.totalSupplierDebt}\r\n              precision={0}\r\n              valueStyle={{ color: '#1890ff' }}\r\n              prefix={<DollarOutlined />}\r\n              suffix=\"‚Ç´\"\r\n            />\r\n          </Card>\r\n        </Col>\r\n      </Row>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div style={{ padding: 24 }}>\r\n      {renderDebtSummary()}\r\n\r\n      <Alert\r\n        message=\"Qu·∫£n l√Ω n·ª£\"\r\n        description=\"Theo d√µi v√† qu·∫£n l√Ω c√°c kho·∫£n n·ª£ c·ªßa kh√°ch h√†ng v√† nh√† cung c·∫•p. H·ªá th·ªëng s·∫Ω t·ª± ƒë·ªông c·∫≠p nh·∫≠t s·ªë d∆∞ n·ª£ khi c√≥ giao d·ªãch thanh to√°n.\"\r\n        type=\"info\"\r\n        showIcon\r\n        style={{ marginBottom: 24 }}\r\n      />\r\n\r\n      <Tabs activeKey={activeTab} onChange={setActiveTab}>\r\n        <TabPane\r\n          tab={\r\n            <span>\r\n              <UserOutlined />\r\n              Kh√°ch h√†ng n·ª£ ({customerDebts.length})\r\n            </span>\r\n          }\r\n          key=\"customers\"\r\n        >\r\n          <Row gutter={24}>\r\n            <Col span={15}>\r\n              <Card\r\n                title=\"Danh s√°ch kh√°ch h√†ng c√≥ n·ª£\"\r\n                extra={\r\n                  <Button\r\n                    type=\"primary\"\r\n                    icon={<PlusOutlined />}\r\n                    onClick={() => {\r\n                      setModalType('payment');\r\n                      setActiveTab('customers');\r\n                      setModalVisible(true);\r\n                      // üÜï Reset form v·ªõi values m·∫∑c ƒë·ªãnh\r\n                      form.setFieldsValue({\r\n                        payment_method: 'cash',\r\n                        transaction_date: dayjs(),\r\n                        entity_id: undefined,\r\n                        amount: undefined,\r\n                        description: ''\r\n                      });\r\n                    }}\r\n                  >\r\n                    Ghi nh·∫≠n thanh to√°n\r\n                  </Button>\r\n                }\r\n              >\r\n                <Table\r\n                  columns={customerColumns}\r\n                  dataSource={customerDebts}\r\n                  loading={loading}\r\n                  rowKey=\"id\"\r\n                  pagination={{\r\n                    showSizeChanger: true,\r\n                    showQuickJumper: true,\r\n                    showTotal: (total, range) =>\r\n                      `${range[0]}-${range[1]} c·ªßa ${total} kh√°ch h√†ng`,\r\n                  }}\r\n                />\r\n              </Card>\r\n            </Col>\r\n            <Col span={9}>\r\n              <Card\r\n                title=\"L·ªãch s·ª≠ thu n·ª£ kh√°ch h√†ng\"\r\n                bordered={true}\r\n                style={{ minHeight: 400 }}\r\n              >\r\n                <Table\r\n                  columns={customerHistoryColumns}\r\n                  dataSource={customerTransactions}\r\n                  rowKey=\"id\"\r\n                  size=\"small\"\r\n                  pagination={{ pageSize: 8 }}\r\n                  locale={{ emptyText: 'Ch∆∞a c√≥ giao d·ªãch' }}\r\n                />\r\n              </Card>\r\n            </Col>\r\n          </Row>\r\n        </TabPane>\r\n\r\n        <TabPane\r\n          tab={\r\n            <span>\r\n              <ShopOutlined />\r\n              N·ª£ nh√† cung c·∫•p ({supplierDebts.length})\r\n            </span>\r\n          }\r\n          key=\"suppliers\"\r\n        >\r\n          <Row gutter={24}>\r\n            <Col span={15}>\r\n              <Card\r\n                title=\"Danh s√°ch nh√† cung c·∫•p c√≥ n·ª£\"\r\n                extra={\r\n                  <Button\r\n                    type=\"primary\"\r\n                    icon={<PlusOutlined />}\r\n                    onClick={() => {\r\n                      setModalType('payment');\r\n                      setActiveTab('suppliers');\r\n                      setModalVisible(true);\r\n                      // üÜï Reset form v·ªõi values m·∫∑c ƒë·ªãnh\r\n                      form.setFieldsValue({\r\n                        payment_method: 'cash',\r\n                        transaction_date: dayjs(),\r\n                        entity_id: undefined,\r\n                        amount: undefined,\r\n                        description: ''\r\n                      });\r\n                    }}\r\n                  >\r\n                    Ghi nh·∫≠n thanh to√°n\r\n                  </Button>\r\n                }\r\n              >\r\n                <Table\r\n                  columns={supplierColumns}\r\n                  dataSource={supplierDebts}\r\n                  loading={loading}\r\n                  rowKey=\"id\"\r\n                  pagination={{\r\n                    showSizeChanger: true,\r\n                    showQuickJumper: true,\r\n                    showTotal: (total, range) =>\r\n                      `${range[0]}-${range[1]} c·ªßa ${total} nh√† cung c·∫•p`,\r\n                  }}\r\n                />\r\n              </Card>\r\n            </Col>\r\n            <Col span={9}>\r\n              <Card\r\n                title=\"L·ªãch s·ª≠ thanh to√°n n·ª£ nh√† cung c·∫•p\"\r\n                bordered={true}\r\n                style={{ minHeight: 400 }}\r\n              >\r\n                <Table\r\n                  columns={supplierHistoryColumns}\r\n                  dataSource={supplierTransactions}\r\n                  rowKey=\"id\"\r\n                  size=\"small\"\r\n                  pagination={{ pageSize: 8 }}\r\n                  locale={{ emptyText: 'Ch∆∞a c√≥ giao d·ªãch' }}\r\n                />\r\n              </Card>\r\n            </Col>\r\n          </Row>\r\n        </TabPane>\r\n      </Tabs>\r\n\r\n      {/* üÜï Enhanced Modal with Ant Design Form */}\r\n      <DebtPaymentModal\r\n        open={modalVisible}\r\n        onClose={handleModalClose}\r\n        onSubmit={handlePayDebt}\r\n        activeTab={activeTab}\r\n        modalType={modalType}\r\n        form={form}\r\n        customers={customers}\r\n        suppliers={suppliers}\r\n        submitting={submitting}\r\n      />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DebtPage; "],"mappings":"0HAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAClD,OAASC,OAAO,KAAQ,MAAM,CAC9B,OACEC,IAAI,CACJC,KAAK,CACLC,MAAM,CACNC,KAAK,CACLC,KAAK,CACLC,MAAM,CACNC,UAAU,CACVC,KAAK,CACLC,GAAG,CACHC,GAAG,CACHC,GAAG,CACHC,SAAS,CACTC,IAAI,CACJC,WAAW,CACXC,KAAK,CACLC,KAAK,CACLC,UAAU,CACVC,IAAI,KACC,MAAM,CACb,OACEC,YAAY,CACZC,YAAY,CACZC,YAAY,CACZC,cAAc,CACdC,yBAAyB,CACzBC,mBAAmB,CACnBC,kBAAkB,CAClBC,cAAc,KACT,mBAAmB,CAC1B,OAASC,YAAY,CAAEC,YAAY,CAAEC,YAAY,KAAQ,iBAAiB,CAC1E,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,MAAO,CAAAC,gBAAgB,KAAM,gCAAgC,CAC7D,OAASC,KAAK,KAAQ,QAAQ,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE/B,KAAM,CAAEC,MAAO,CAAC,CAAG/B,MAAM,CACzB,KAAM,CAAEgC,OAAQ,CAAC,CAAGzB,IAAI,CACxB,KAAM,CAAE0B,IAAK,CAAC,CAAGtB,UAAU,CAE3B,KAAM,CAAAuB,QAAQ,CAAGA,CAAA,GAAM,CACrB,KAAM,CAACC,aAAa,CAAEC,gBAAgB,CAAC,CAAG5C,QAAQ,CAAC,EAAE,CAAC,CACtD,KAAM,CAAC6C,aAAa,CAAEC,gBAAgB,CAAC,CAAG9C,QAAQ,CAAC,EAAE,CAAC,CACtD,KAAM,CAAC+C,SAAS,CAAEC,YAAY,CAAC,CAAGhD,QAAQ,CAAC,EAAE,CAAC,CAC9C,KAAM,CAACiD,SAAS,CAAEC,YAAY,CAAC,CAAGlD,QAAQ,CAAC,EAAE,CAAC,CAC9C,KAAM,CAACmD,OAAO,CAAEC,UAAU,CAAC,CAAGpD,QAAQ,CAAC,KAAK,CAAC,CAC7C,KAAM,CAACqD,YAAY,CAAEC,eAAe,CAAC,CAAGtD,QAAQ,CAAC,KAAK,CAAC,CACvD,KAAM,CAACuD,SAAS,CAAEC,YAAY,CAAC,CAAGxD,QAAQ,CAAC,WAAW,CAAC,CACvD,KAAM,CAACyD,SAAS,CAAEC,YAAY,CAAC,CAAG1D,QAAQ,CAAC,SAAS,CAAC,CAAE;AACvD,KAAM,CAAC2D,UAAU,CAAEC,aAAa,CAAC,CAAG5D,QAAQ,CAAC,KAAK,CAAC,CACnD,KAAM,CAAC6D,SAAS,CAAEC,YAAY,CAAC,CAAG9D,QAAQ,CAAC,CACzC+D,iBAAiB,CAAE,CAAC,CACpBC,iBAAiB,CAAE,CAAC,CACpBC,kBAAkB,CAAE,CAAC,CACrBC,mBAAmB,CAAE,CACvB,CAAC,CAAC,CACF,KAAM,CAACC,oBAAoB,CAAEC,uBAAuB,CAAC,CAAGpE,QAAQ,CAAC,EAAE,CAAC,CACpE,KAAM,CAACqE,oBAAoB,CAAEC,uBAAuB,CAAC,CAAGtE,QAAQ,CAAC,EAAE,CAAC,CAEpE;AACA,KAAM,CAACuE,IAAI,CAAC,CAAGnD,IAAI,CAACoD,OAAO,CAAC,CAAC,CAE7B,KAAM,CAAAC,cAAc,CAAG,CACrB,CAAEC,KAAK,CAAE,MAAM,CAAEC,KAAK,CAAE,UAAU,CAAEC,IAAI,cAAExC,IAAA,CAACZ,cAAc,GAAE,CAAE,CAAC,CAC9D,CAAEkD,KAAK,CAAE,MAAM,CAAEC,KAAK,CAAE,KAAK,CAAEC,IAAI,cAAExC,IAAA,CAACT,kBAAkB,GAAE,CAAE,CAAC,CAC7D,CAAE+C,KAAK,CAAE,UAAU,CAAEC,KAAK,CAAE,cAAc,CAAEC,IAAI,cAAExC,IAAA,CAACR,cAAc,GAAE,CAAE,CAAC,CACtE,CAAE8C,KAAK,CAAE,SAAS,CAAEC,KAAK,CAAE,YAAY,CAAEC,IAAI,cAAExC,IAAA,CAACR,cAAc,GAAE,CAAE,CAAC,CACpE,CAED3B,SAAS,CAAC,IAAM,CACd4E,OAAO,CAACC,GAAG,CAAC,uCAAuC,CAAC,CACpDC,SAAS,CAAC,CAAC,CACb,CAAC,CAAE,EAAE,CAAC,CAEN9E,SAAS,CAAC,IAAM,CACd4E,OAAO,CAACC,GAAG,CAAC,6BAA6B,CAAE/B,SAAS,CAAC,CACvD,CAAC,CAAE,CAACA,SAAS,CAAC,CAAC,CAEf9C,SAAS,CAAC,IAAM,CACd4E,OAAO,CAACC,GAAG,CAAC,6BAA6B,CAAE7B,SAAS,CAAC,CACvD,CAAC,CAAE,CAACA,SAAS,CAAC,CAAC,CAEf;AACAhD,SAAS,CAAC,IAAM,CACd,GAAI8C,SAAS,CAACiC,MAAM,CAAG,CAAC,CAAE,CACxBC,kBAAkB,CAAC,CAAC,CACtB,CACF,CAAC,CAAE,CAAClC,SAAS,CAAC,CAAC,CAAE;AAEjB9C,SAAS,CAAC,IAAM,CACd,GAAIgD,SAAS,CAAC+B,MAAM,CAAG,CAAC,CAAE,CACxBE,kBAAkB,CAAC,CAAC,CACtB,CACF,CAAC,CAAE,CAACjC,SAAS,CAAC,CAAC,CAAE;AAEjB;AACAhD,SAAS,CAAC,IAAM,CACd,GAAIsD,SAAS,GAAK,WAAW,CAAE,CAC7B4B,yBAAyB,CAAC,CAAC,CAC7B,CACF,CAAC,CAAE,CAAC5B,SAAS,CAAC,CAAC,CAEf;AACAtD,SAAS,CAAC,IAAM,CACd,GAAIsD,SAAS,GAAK,WAAW,CAAE,CAC7B6B,yBAAyB,CAAC,CAAC,CAC7B,CACF,CAAC,CAAE,CAAC7B,SAAS,CAAC,CAAC,CAEf,KAAM,CAAAwB,SAAS,CAAG,KAAAA,CAAA,GAAY,CAC5B3B,UAAU,CAAC,IAAI,CAAC,CAChB,GAAI,CACF;AACA,KAAM,CAAAiC,OAAO,CAACC,GAAG,CAAC,CAChBC,cAAc,CAAC,CAAC,CAChBC,cAAc,CAAC,CAAC,CACjB,CAAC,CAEF;AACF,CAAE,MAAOC,KAAK,CAAE,CACdvF,OAAO,CAACuF,KAAK,CAAC,qBAAqB,CAAC,CACtC,CAAC,OAAS,CACRrC,UAAU,CAAC,KAAK,CAAC,CACnB,CACF,CAAC,CAED,KAAM,CAAA6B,kBAAkB,CAAG,KAAAA,CAAA,GAAY,CACrC,GAAI,CACF;AACA,KAAM,CAAAS,iBAAiB,CAAG3C,SAAS,CAAC4C,MAAM,CAACC,CAAC,EAAI,CAACA,CAAC,CAACC,YAAY,EAAI,CAAC,EAAI,CAAC,CAAC,CAC1EjD,gBAAgB,CAAC8C,iBAAiB,CAAC,CAEnC;AACA,KAAM,CAAAI,SAAS,CAAGJ,iBAAiB,CAACK,MAAM,CAAC,CAACC,GAAG,CAAEJ,CAAC,GAAKI,GAAG,EAAIJ,CAAC,CAACC,YAAY,EAAI,CAAC,CAAC,CAAE,CAAC,CAAC,CACtF/B,YAAY,CAACmC,IAAI,EAAAC,aAAA,CAAAA,aAAA,IAAUD,IAAI,MAAElC,iBAAiB,CAAE+B,SAAS,EAAG,CAAC,CACnE,CAAE,MAAOL,KAAK,CAAE,CACdZ,OAAO,CAACY,KAAK,CAAC,kCAAkC,CAAEA,KAAK,CAAC,CACxD7C,gBAAgB,CAAC,EAAE,CAAC,CACtB,CACF,CAAC,CAED,KAAM,CAAAsC,kBAAkB,CAAG,KAAAA,CAAA,GAAY,CACrC,GAAI,CACF;AACA,KAAM,CAAAiB,iBAAiB,CAAGlD,SAAS,CAAC0C,MAAM,CAACS,CAAC,EAAI,CAACA,CAAC,CAACP,YAAY,EAAI,CAAC,EAAI,CAAC,CAAC,CAC1E/C,gBAAgB,CAACqD,iBAAiB,CAAC,CAEnC;AACA,KAAM,CAAAL,SAAS,CAAGK,iBAAiB,CAACJ,MAAM,CAAC,CAACC,GAAG,CAAEI,CAAC,GAAKJ,GAAG,EAAII,CAAC,CAACP,YAAY,EAAI,CAAC,CAAC,CAAE,CAAC,CAAC,CACtF/B,YAAY,CAACmC,IAAI,EAAAC,aAAA,CAAAA,aAAA,IAAUD,IAAI,MAAEjC,iBAAiB,CAAE8B,SAAS,EAAG,CAAC,CACnE,CAAE,MAAOL,KAAK,CAAE,CACdZ,OAAO,CAACY,KAAK,CAAC,kCAAkC,CAAEA,KAAK,CAAC,CACxD3C,gBAAgB,CAAC,EAAE,CAAC,CACtB,CACF,CAAC,CAED,KAAM,CAAAqC,yBAAyB,CAAG,KAAAA,CAAA,GAAY,CAC5C,GAAI,CACF,KAAM,CAAAkB,QAAQ,CAAG,KAAM,CAAAtE,YAAY,CAACuE,eAAe,CAAC,CAAEC,IAAI,CAAE,SAAS,CAAEC,QAAQ,CAAE,qBAAqB,CAAEC,KAAK,CAAE,EAAG,CAAC,CAAC,CACpH,GAAIJ,QAAQ,CAACK,IAAI,CAACC,OAAO,CAAE,CACzBvC,uBAAuB,CAACiC,QAAQ,CAACK,IAAI,CAACA,IAAI,EAAI,EAAE,CAAC,CACnD,CAAC,IAAM,CACLtC,uBAAuB,CAAC,EAAE,CAAC,CAC7B,CACF,CAAE,MAAOqB,KAAK,CAAE,CACdrB,uBAAuB,CAAC,EAAE,CAAC,CAC7B,CACF,CAAC,CAED,KAAM,CAAAgB,yBAAyB,CAAG,KAAAA,CAAA,GAAY,CAC5C,GAAI,CACF,KAAM,CAAAiB,QAAQ,CAAG,KAAM,CAAAtE,YAAY,CAACuE,eAAe,CAAC,CAAEC,IAAI,CAAE,QAAQ,CAAEC,QAAQ,CAAE,mBAAmB,CAAEC,KAAK,CAAE,EAAG,CAAC,CAAC,CACjH,GAAIJ,QAAQ,CAACK,IAAI,CAACC,OAAO,CAAE,CACzBrC,uBAAuB,CAAC+B,QAAQ,CAACK,IAAI,CAACA,IAAI,EAAI,EAAE,CAAC,CACnD,CAAC,IAAM,CACLpC,uBAAuB,CAAC,EAAE,CAAC,CAC7B,CACF,CAAE,MAAOmB,KAAK,CAAE,CACdnB,uBAAuB,CAAC,EAAE,CAAC,CAC7B,CACF,CAAC,CAED,KAAM,CAAAiB,cAAc,CAAG,KAAAA,CAAA,GAAY,CACjC,GAAI,CACF,KAAM,CAAAc,QAAQ,CAAG,KAAM,CAAAxE,YAAY,CAAC+E,MAAM,CAAC,CAAC,CAC5C/B,OAAO,CAACC,GAAG,CAAC,4BAA4B,CAAEuB,QAAQ,CAACK,IAAI,CAAC,CAExD,GAAIL,QAAQ,CAACK,IAAI,CAACC,OAAO,CAAE,CACzB;AACA,KAAM,CAAAjB,iBAAiB,CAAGW,QAAQ,CAACK,IAAI,CAACA,IAAI,CAACG,GAAG,CAACC,QAAQ,EAAAZ,aAAA,CAAAA,aAAA,IACpDY,QAAQ,MACXjB,YAAY,CAAEiB,QAAQ,CAACjB,YAAY,EAAI,CAAC,CACxCkB,WAAW,CAAED,QAAQ,CAACC,WAAW,EAAI,CAAC,EACtC,CAAC,CAEHlC,OAAO,CAACC,GAAG,CAAC,yBAAyB,CAAEY,iBAAiB,CAAC,CACzDb,OAAO,CAACC,GAAG,CAAC,kCAAkC,CAAEY,iBAAiB,CAACV,MAAM,CAAC,CACzEhC,YAAY,CAAC0C,iBAAiB,CAAC,CACjC,CACF,CAAE,MAAOD,KAAK,CAAE,CACdZ,OAAO,CAACY,KAAK,CAAC,2BAA2B,CAAEA,KAAK,CAAC,CACjD;AACAzC,YAAY,CAAC,EAAE,CAAC,CAClB,CACF,CAAC,CAED,KAAM,CAAAwC,cAAc,CAAG,KAAAA,CAAA,GAAY,CACjC,GAAI,CACF,KAAM,CAAAa,QAAQ,CAAG,KAAM,CAAAvE,YAAY,CAAC8E,MAAM,CAAC,CAAC,CAC5C/B,OAAO,CAACC,GAAG,CAAC,4BAA4B,CAAEuB,QAAQ,CAACK,IAAI,CAAC,CAExD,GAAIL,QAAQ,CAACK,IAAI,CAACC,OAAO,CAAE,CACzB;AACA,KAAM,CAAAR,iBAAiB,CAAGE,QAAQ,CAACK,IAAI,CAACA,IAAI,CAACG,GAAG,CAACG,QAAQ,EAAAd,aAAA,CAAAA,aAAA,IACpDc,QAAQ,MACXnB,YAAY,CAAEmB,QAAQ,CAACnB,YAAY,EAAI,CAAC,CACxCoB,eAAe,CAAED,QAAQ,CAACC,eAAe,EAAI,CAAC,EAC9C,CAAC,CAEHpC,OAAO,CAACC,GAAG,CAAC,yBAAyB,CAAEqB,iBAAiB,CAAC,CACzDtB,OAAO,CAACC,GAAG,CAAC,kCAAkC,CAAEqB,iBAAiB,CAACnB,MAAM,CAAC,CACzE9B,YAAY,CAACiD,iBAAiB,CAAC,CACjC,CACF,CAAE,MAAOV,KAAK,CAAE,CACdZ,OAAO,CAACY,KAAK,CAAC,2BAA2B,CAAEA,KAAK,CAAC,CACjD;AACAvC,YAAY,CAAC,EAAE,CAAC,CAClB,CACF,CAAC,CAED;AACA,KAAM,CAAAgE,aAAa,CAAG,KAAO,CAAAC,MAAM,EAAK,CACtC,GAAI,KAAAC,qBAAA,CACFxD,aAAa,CAAC,IAAI,CAAC,CACnBiB,OAAO,CAACC,GAAG,CAAC,6BAA6B,CAAEqC,MAAM,CAAC,CAElD,KAAM,CAAAE,eAAe,CAAG,CACtBd,IAAI,CAAEhD,SAAS,GAAK,WAAW,CAAG,QAAQ,CAAG,SAAS,CACtDiD,QAAQ,CAAEjD,SAAS,GAAK,WAAW,CAAG,mBAAmB,CAAG,qBAAqB,CACjF+D,MAAM,CAAEH,MAAM,CAACG,MAAM,CACrBC,WAAW,CAAEJ,MAAM,CAACI,WAAW,2BAAAC,MAAA,CAAqBjE,SAAS,GAAK,WAAW,CAAG,YAAY,CAAG,cAAc,CAAE,CAC/GkE,WAAW,CAAElE,SAAS,GAAK,WAAW,CAAG4D,MAAM,CAACO,SAAS,CAAG,IAAI,CAChEC,WAAW,CAAEpE,SAAS,GAAK,WAAW,CAAG4D,MAAM,CAACO,SAAS,CAAG,IAAI,CAChEE,cAAc,CAAET,MAAM,CAACS,cAAc,CACrCC,gBAAgB,CAAE,EAAAT,qBAAA,CAAAD,MAAM,CAACU,gBAAgB,UAAAT,qBAAA,iBAAvBA,qBAAA,CAAyBU,WAAW,CAAC,CAAC,GAAI,GAAI,CAAAC,IAAI,CAAC,CAAC,CAACD,WAAW,CAAC,CAAC,CACpFE,OAAO,CAAE,CACX,CAAC,CAEDnD,OAAO,CAACC,GAAG,CAAC,8BAA8B,CAAEuC,eAAe,CAAC,CAE5D,KAAM,CAAAhB,QAAQ,CAAG,KAAM,CAAAtE,YAAY,CAACkG,MAAM,CAACZ,eAAe,CAAC,CAC3D,GAAIhB,QAAQ,CAACK,IAAI,CAACC,OAAO,CAAE,CACzBzE,KAAK,CAACyE,OAAO,CAAC,iCAAiC,CAAC,CAChDrD,eAAe,CAAC,KAAK,CAAC,CACtBiB,IAAI,CAAC2D,WAAW,CAAC,CAAC,CAClBnD,SAAS,CAAC,CAAC,CACb,CAAC,IAAM,CACL,KAAM,IAAI,CAAAoD,KAAK,CAAC9B,QAAQ,CAACK,IAAI,CAACxG,OAAO,EAAI,oBAAoB,CAAC,CAChE,CACF,CAAE,MAAOuF,KAAK,CAAE,CACdZ,OAAO,CAACY,KAAK,CAAC,6BAA6B,CAAEA,KAAK,CAAC,CACnDvD,KAAK,CAACuD,KAAK,CAACA,KAAK,CAACvF,OAAO,EAAI,6BAA6B,CAAC,CAC7D,CAAC,OAAS,CACR0D,aAAa,CAAC,KAAK,CAAC,CACtB,CACF,CAAC,CAED;AACA,KAAM,CAAAwE,gBAAgB,CAAGA,CAAA,GAAM,CAC7B9E,eAAe,CAAC,KAAK,CAAC,CACtBiB,IAAI,CAAC2D,WAAW,CAAC,CAAC,CAClBtE,aAAa,CAAC,KAAK,CAAC,CACtB,CAAC,CAED,KAAM,CAAAyE,eAAe,CAAG,CACtB,CACEC,KAAK,CAAE,OAAO,CACdC,SAAS,CAAE,MAAM,CACjBC,GAAG,CAAE,MAAM,CACXC,KAAK,CAAE,GACT,CAAC,CACD,CACEH,KAAK,CAAE,gBAAgB,CACvBC,SAAS,CAAE,MAAM,CACjBC,GAAG,CAAE,MAAM,CACXE,MAAM,CAAEA,CAACC,IAAI,CAAEC,MAAM,gBACnBtG,KAAA,QAAAuG,QAAA,eACEzG,IAAA,QAAAyG,QAAA,CAAMF,IAAI,CAAM,CAAC,CAChBC,MAAM,CAACE,KAAK,eACX1G,IAAA,CAACK,IAAI,EAAC8D,IAAI,CAAC,WAAW,CAACwC,KAAK,CAAE,CAAEC,QAAQ,CAAE,EAAG,CAAE,CAAAH,QAAA,CAC5CD,MAAM,CAACE,KAAK,CACT,CACP,EACE,CAET,CAAC,CACD,CACER,KAAK,CAAE,SAAS,CAChBC,SAAS,CAAE,eAAe,CAC1BC,GAAG,CAAE,eAAe,CACpBE,MAAM,CAAGnC,IAAI,EAAK,CAChB,KAAM,CAAA0C,MAAM,CAAG,CACbC,OAAO,CAAE,SAAS,CAClBC,GAAG,CAAE,MAAM,CACXC,SAAS,CAAE,MACb,CAAC,CACD,KAAM,CAAAC,MAAM,CAAG,CACbH,OAAO,CAAE,QAAQ,CACjBC,GAAG,CAAE,KAAK,CACVC,SAAS,CAAE,IACb,CAAC,CACD,mBAAOhH,IAAA,CAACzB,GAAG,EAAC2I,KAAK,CAAEL,MAAM,CAAC1C,IAAI,CAAE,CAAAsC,QAAA,CAAEQ,MAAM,CAAC9C,IAAI,CAAC,CAAM,CAAC,CACvD,CACF,CAAC,CACD,CACE+B,KAAK,CAAE,OAAO,CACdC,SAAS,CAAE,cAAc,CACzBC,GAAG,CAAE,cAAc,CACnBE,MAAM,CAAGa,IAAI,eACXjH,KAAA,CAACG,IAAI,EAAC+G,MAAM,MAACT,KAAK,CAAE,CAAEO,KAAK,CAAEC,IAAI,CAAG,CAAC,CAAG,SAAS,CAAG,SAAU,CAAE,CAAAV,QAAA,EAC7DU,IAAI,CAACE,cAAc,CAAC,OAAO,CAAC,CAAC,SAChC,EAAM,CACP,CACDC,MAAM,CAAEA,CAACC,CAAC,CAAEC,CAAC,GAAKD,CAAC,CAAC9D,YAAY,CAAG+D,CAAC,CAAC/D,YACvC,CAAC,CACD,CACEyC,KAAK,CAAE,eAAe,CACtBC,SAAS,CAAE,aAAa,CACxBC,GAAG,CAAE,aAAa,CAClBE,MAAM,CAAGmB,KAAK,eACZvH,KAAA,CAACG,IAAI,EAAC8D,IAAI,CAAC,WAAW,CAAAsC,QAAA,EACnBgB,KAAK,CAAGA,KAAK,CAACJ,cAAc,CAAC,OAAO,CAAC,CAAG,CAAC,CAAC,SAC7C,EAAM,CAEV,CAAC,CACD,CACEnB,KAAK,CAAE,YAAY,CACnBE,GAAG,CAAE,QAAQ,CACbE,MAAM,CAAEA,CAACoB,CAAC,CAAElB,MAAM,GAAK,CACrB,KAAM,CAAAW,IAAI,CAAGX,MAAM,CAAC/C,YAAY,EAAI,CAAC,CACrC,GAAI0D,IAAI,GAAK,CAAC,CAAE,CACd,mBAAOnH,IAAA,CAAClB,KAAK,EAAC6I,MAAM,CAAC,SAAS,CAACC,IAAI,CAAC,0BAAe,CAAE,CAAC,CACxD,CAAC,IAAM,IAAIT,IAAI,CAAG,OAAO,CAAE,CACzB,mBAAOnH,IAAA,CAAClB,KAAK,EAAC6I,MAAM,CAAC,OAAO,CAACC,IAAI,CAAC,kBAAQ,CAAE,CAAC,CAC/C,CAAC,IAAM,CACL,mBAAO5H,IAAA,CAAClB,KAAK,EAAC6I,MAAM,CAAC,SAAS,CAACC,IAAI,CAAC,eAAO,CAAE,CAAC,CAChD,CACF,CACF,CAAC,CACD,CACE1B,KAAK,CAAE,UAAU,CACjBE,GAAG,CAAE,SAAS,CACdE,MAAM,CAAEA,CAACoB,CAAC,CAAElB,MAAM,gBAChBxG,IAAA,CAAC1B,KAAK,EAAAmI,QAAA,cACJzG,IAAA,CAAC/B,MAAM,EACLkG,IAAI,CAAC,SAAS,CACd0D,IAAI,CAAC,OAAO,CACZrF,IAAI,cAAExC,IAAA,CAACZ,cAAc,GAAE,CAAE,CACzB0I,OAAO,CAAEA,CAAA,GAAM,CACbxG,YAAY,CAAC,SAAS,CAAC,CACvBF,YAAY,CAAC,WAAW,CAAC,CACzBF,eAAe,CAAC,IAAI,CAAC,CACrB;AACAiB,IAAI,CAAC4F,cAAc,CAAC,CAClBzC,SAAS,CAAEkB,MAAM,CAACwB,EAAE,CACpBxC,cAAc,CAAE,MAAM,CACtBC,gBAAgB,CAAE7F,KAAK,CAAC,CAAC,CACzBsF,MAAM,CAAEsB,MAAM,CAAC/C,YAAY,EAAI,CAAC,CAChC0B,WAAW,2CAAAC,MAAA,CAA8BoB,MAAM,CAACD,IAAI,CACtD,CAAC,CAAC,CACJ,CAAE,CAAAE,QAAA,CACH,eAED,CAAQ,CAAC,CACJ,CAEX,CAAC,CACF,CAED,KAAM,CAAAwB,eAAe,CAAG,CACtB,CACE/B,KAAK,CAAE,QAAQ,CACfC,SAAS,CAAE,MAAM,CACjBC,GAAG,CAAE,MAAM,CACXC,KAAK,CAAE,GACT,CAAC,CACD,CACEH,KAAK,CAAE,kBAAkB,CACzBC,SAAS,CAAE,MAAM,CACjBC,GAAG,CAAE,MAAM,CACXE,MAAM,CAAEA,CAACC,IAAI,CAAEC,MAAM,gBACnBtG,KAAA,QAAAuG,QAAA,eACEzG,IAAA,QAAAyG,QAAA,CAAMF,IAAI,CAAM,CAAC,CAChBC,MAAM,CAACE,KAAK,eACX1G,IAAA,CAACK,IAAI,EAAC8D,IAAI,CAAC,WAAW,CAACwC,KAAK,CAAE,CAAEC,QAAQ,CAAE,EAAG,CAAE,CAAAH,QAAA,CAC5CD,MAAM,CAACE,KAAK,CACT,CACP,EACE,CAET,CAAC,CACD,CACER,KAAK,CAAE,SAAS,CAChBC,SAAS,CAAE,SAAS,CACpBC,GAAG,CAAE,SAAS,CACd8B,QAAQ,CAAE,IACZ,CAAC,CACD,CACEhC,KAAK,CAAE,OAAO,CACdC,SAAS,CAAE,cAAc,CACzBC,GAAG,CAAE,cAAc,CACnBE,MAAM,CAAGa,IAAI,eACXjH,KAAA,CAACG,IAAI,EAAC+G,MAAM,MAACT,KAAK,CAAE,CAAEO,KAAK,CAAEC,IAAI,CAAG,CAAC,CAAG,SAAS,CAAG,SAAU,CAAE,CAAAV,QAAA,EAC7DU,IAAI,CAACE,cAAc,CAAC,OAAO,CAAC,CAAC,SAChC,EAAM,CACP,CACDC,MAAM,CAAEA,CAACC,CAAC,CAAEC,CAAC,GAAKD,CAAC,CAAC9D,YAAY,CAAG+D,CAAC,CAAC/D,YACvC,CAAC,CACD,CACEyC,KAAK,CAAE,YAAY,CACnBE,GAAG,CAAE,QAAQ,CACbE,MAAM,CAAEA,CAACoB,CAAC,CAAElB,MAAM,GAAK,CACrB,KAAM,CAAAW,IAAI,CAAGX,MAAM,CAAC/C,YAAY,EAAI,CAAC,CACrC,GAAI0D,IAAI,GAAK,CAAC,CAAE,CACd,mBAAOnH,IAAA,CAAClB,KAAK,EAAC6I,MAAM,CAAC,SAAS,CAACC,IAAI,CAAC,0BAAe,CAAE,CAAC,CACxD,CAAC,IAAM,IAAIT,IAAI,CAAG,OAAO,CAAE,CACzB,mBAAOnH,IAAA,CAAClB,KAAK,EAAC6I,MAAM,CAAC,OAAO,CAACC,IAAI,CAAC,kBAAQ,CAAE,CAAC,CAC/C,CAAC,IAAM,CACL,mBAAO5H,IAAA,CAAClB,KAAK,EAAC6I,MAAM,CAAC,SAAS,CAACC,IAAI,CAAC,eAAO,CAAE,CAAC,CAChD,CACF,CACF,CAAC,CACD,CACE1B,KAAK,CAAE,UAAU,CACjBE,GAAG,CAAE,SAAS,CACdE,MAAM,CAAEA,CAACoB,CAAC,CAAElB,MAAM,gBAChBxG,IAAA,CAAC1B,KAAK,EAAAmI,QAAA,cACJzG,IAAA,CAAC/B,MAAM,EACLkG,IAAI,CAAC,SAAS,CACd0D,IAAI,CAAC,OAAO,CACZrF,IAAI,cAAExC,IAAA,CAACZ,cAAc,GAAE,CAAE,CACzB0I,OAAO,CAAEA,CAAA,GAAM,CACbxG,YAAY,CAAC,SAAS,CAAC,CACvBF,YAAY,CAAC,WAAW,CAAC,CACzBF,eAAe,CAAC,IAAI,CAAC,CACrB;AACAiB,IAAI,CAAC4F,cAAc,CAAC,CAClBzC,SAAS,CAAEkB,MAAM,CAACwB,EAAE,CACpBxC,cAAc,CAAE,MAAM,CACtBC,gBAAgB,CAAE7F,KAAK,CAAC,CAAC,CACzBsF,MAAM,CAAEsB,MAAM,CAAC/C,YAAY,EAAI,CAAC,CAChC0B,WAAW,+CAAAC,MAAA,CAAgCoB,MAAM,CAACD,IAAI,CACxD,CAAC,CAAC,CACJ,CAAE,CAAAE,QAAA,CACH,eAED,CAAQ,CAAC,CACJ,CAEX,CAAC,CACF,CAED;AACA,KAAM,CAAA0B,sBAAsB,CAAG,CAC7B,CACEjC,KAAK,CAAE,gBAAgB,CACvBC,SAAS,CAAE,kBAAkB,CAC7BC,GAAG,CAAE,kBAAkB,CACvBE,MAAM,CAAG8B,IAAI,EAAKA,IAAI,CAAG,GAAI,CAAAzC,IAAI,CAACyC,IAAI,CAAC,CAACf,cAAc,CAAC,OAAO,CAAE,CAAEgB,QAAQ,CAAE,kBAAmB,CAAC,CAAC,CAAG,EAAE,CACtGhC,KAAK,CAAE,GACT,CAAC,CACD,CACEH,KAAK,CAAE,SAAS,CAChBC,SAAS,CAAE,QAAQ,CACnBC,GAAG,CAAE,QAAQ,CACbE,MAAM,CAAGpB,MAAM,eAAKhF,KAAA,SAAMyG,KAAK,CAAE,CAAEO,KAAK,CAAE,SAAS,CAAEoB,UAAU,CAAE,GAAI,CAAE,CAAA7B,QAAA,EAAC,IAAE,CAACvB,MAAM,CAACmC,cAAc,CAAC,OAAO,CAAC,CAAC,SAAE,EAAM,CAAC,CACnHhB,KAAK,CAAE,GACT,CAAC,CACD,CACEH,KAAK,CAAE,OAAO,CACdC,SAAS,CAAE,aAAa,CACxBC,GAAG,CAAE,aAAa,CAClBE,MAAM,CAAGiC,IAAI,EAAKA,IAAI,EAAI,4BAC5B,CAAC,CACF,CAED,KAAM,CAAAC,sBAAsB,CAAG,CAC7B,CACEtC,KAAK,CAAE,gBAAgB,CACvBC,SAAS,CAAE,kBAAkB,CAC7BC,GAAG,CAAE,kBAAkB,CACvBE,MAAM,CAAG8B,IAAI,EAAKA,IAAI,CAAG,GAAI,CAAAzC,IAAI,CAACyC,IAAI,CAAC,CAACf,cAAc,CAAC,OAAO,CAAE,CAAEgB,QAAQ,CAAE,kBAAmB,CAAC,CAAC,CAAG,EAAE,CACtGhC,KAAK,CAAE,GACT,CAAC,CACD,CACEH,KAAK,CAAE,SAAS,CAChBC,SAAS,CAAE,QAAQ,CACnBC,GAAG,CAAE,QAAQ,CACbE,MAAM,CAAGpB,MAAM,eAAKhF,KAAA,SAAMyG,KAAK,CAAE,CAAEO,KAAK,CAAE,SAAS,CAAEoB,UAAU,CAAE,GAAI,CAAE,CAAA7B,QAAA,EAAC,IAAE,CAACvB,MAAM,CAACmC,cAAc,CAAC,OAAO,CAAC,CAAC,SAAE,EAAM,CAAC,CACnHhB,KAAK,CAAE,GACT,CAAC,CACD,CACEH,KAAK,CAAE,OAAO,CACdC,SAAS,CAAE,aAAa,CACxBC,GAAG,CAAE,aAAa,CAClBE,MAAM,CAAGiC,IAAI,EAAKA,IAAI,EAAI,mBAC5B,CAAC,CACF,CAED,KAAM,CAAAE,iBAAiB,CAAGA,CAAA,GAAM,CAC9B,mBACEvI,KAAA,CAAC1B,GAAG,EAACkK,MAAM,CAAE,EAAG,CAAC/B,KAAK,CAAE,CAAEgC,YAAY,CAAE,EAAG,CAAE,CAAAlC,QAAA,eAC3CzG,IAAA,CAACvB,GAAG,EAACmK,IAAI,CAAE,CAAE,CAAAnC,QAAA,cACXzG,IAAA,CAACjC,IAAI,EAAA0I,QAAA,cACHzG,IAAA,CAACtB,SAAS,EACRwH,KAAK,CAAC,oCAAoB,CAC1B5D,KAAK,CAAE/B,aAAa,CAACqC,MAAO,CAC5BiG,UAAU,CAAE,CAAE3B,KAAK,CAAE,SAAU,CAAE,CACjC4B,MAAM,cAAE9I,IAAA,CAACd,YAAY,GAAE,CAAE,CAC1B,CAAC,CACE,CAAC,CACJ,CAAC,cACNc,IAAA,CAACvB,GAAG,EAACmK,IAAI,CAAE,CAAE,CAAAnC,QAAA,cACXzG,IAAA,CAACjC,IAAI,EAAA0I,QAAA,cACHzG,IAAA,CAACtB,SAAS,EACRwH,KAAK,CAAC,wCAAsB,CAC5B5D,KAAK,CAAEb,SAAS,CAACG,iBAAkB,CACnCmH,SAAS,CAAE,CAAE,CACbF,UAAU,CAAE,CAAE3B,KAAK,CAAE,SAAU,CAAE,CACjC4B,MAAM,cAAE9I,IAAA,CAACb,YAAY,GAAE,CAAE,CACzB6J,MAAM,CAAC,QAAG,CACX,CAAC,CACE,CAAC,CACJ,CAAC,cACNhJ,IAAA,CAACvB,GAAG,EAACmK,IAAI,CAAE,CAAE,CAAAnC,QAAA,cACXzG,IAAA,CAACjC,IAAI,EAAA0I,QAAA,cACHzG,IAAA,CAACtB,SAAS,EACRwH,KAAK,CAAC,iCAAkB,CACxB5D,KAAK,CAAEb,SAAS,CAACE,iBAAiB,CAAGF,SAAS,CAACG,iBAAkB,CACjEmH,SAAS,CAAE,CAAE,CACbF,UAAU,CAAE,CAAE3B,KAAK,CAAE,SAAU,CAAE,CACjC4B,MAAM,cAAE9I,IAAA,CAACZ,cAAc,GAAE,CAAE,CAC3B4J,MAAM,CAAC,QAAG,CACX,CAAC,CACE,CAAC,CACJ,CAAC,EACH,CAAC,CAEV,CAAC,CAED,mBACE9I,KAAA,QAAKyG,KAAK,CAAE,CAAEsC,OAAO,CAAE,EAAG,CAAE,CAAAxC,QAAA,EACzBgC,iBAAiB,CAAC,CAAC,cAEpBzI,IAAA,CAACnB,KAAK,EACJf,OAAO,CAAC,yBAAY,CACpBqH,WAAW,CAAC,wPAAqI,CACjJhB,IAAI,CAAC,MAAM,CACX+E,QAAQ,MACRvC,KAAK,CAAE,CAAEgC,YAAY,CAAE,EAAG,CAAE,CAC7B,CAAC,cAEFzI,KAAA,CAACvB,IAAI,EAACwK,SAAS,CAAEhI,SAAU,CAACiI,QAAQ,CAAEhI,YAAa,CAAAqF,QAAA,eACjDzG,IAAA,CAACI,OAAO,EACNiJ,GAAG,cACDnJ,KAAA,SAAAuG,QAAA,eACEzG,IAAA,CAACd,YAAY,GAAE,CAAC,6BACD,CAACqB,aAAa,CAACqC,MAAM,CAAC,GACvC,EAAM,CACP,CAAA6D,QAAA,cAGDvG,KAAA,CAAC1B,GAAG,EAACkK,MAAM,CAAE,EAAG,CAAAjC,QAAA,eACdzG,IAAA,CAACvB,GAAG,EAACmK,IAAI,CAAE,EAAG,CAAAnC,QAAA,cACZzG,IAAA,CAACjC,IAAI,EACHmI,KAAK,CAAC,6CAA4B,CAClCoD,KAAK,cACHtJ,IAAA,CAAC/B,MAAM,EACLkG,IAAI,CAAC,SAAS,CACd3B,IAAI,cAAExC,IAAA,CAACf,YAAY,GAAE,CAAE,CACvB6I,OAAO,CAAEA,CAAA,GAAM,CACbxG,YAAY,CAAC,SAAS,CAAC,CACvBF,YAAY,CAAC,WAAW,CAAC,CACzBF,eAAe,CAAC,IAAI,CAAC,CACrB;AACAiB,IAAI,CAAC4F,cAAc,CAAC,CAClBvC,cAAc,CAAE,MAAM,CACtBC,gBAAgB,CAAE7F,KAAK,CAAC,CAAC,CACzB0F,SAAS,CAAEiE,SAAS,CACpBrE,MAAM,CAAEqE,SAAS,CACjBpE,WAAW,CAAE,EACf,CAAC,CAAC,CACJ,CAAE,CAAAsB,QAAA,CACH,6BAED,CAAQ,CACT,CAAAA,QAAA,cAEDzG,IAAA,CAAChC,KAAK,EACJwL,OAAO,CAAEvD,eAAgB,CACzBwD,UAAU,CAAElJ,aAAc,CAC1BQ,OAAO,CAAEA,OAAQ,CACjB2I,MAAM,CAAC,IAAI,CACXC,UAAU,CAAE,CACVC,eAAe,CAAE,IAAI,CACrBC,eAAe,CAAE,IAAI,CACrBC,SAAS,CAAEA,CAACC,KAAK,CAAEC,KAAK,MAAA5E,MAAA,CACnB4E,KAAK,CAAC,CAAC,CAAC,MAAA5E,MAAA,CAAI4E,KAAK,CAAC,CAAC,CAAC,eAAA5E,MAAA,CAAQ2E,KAAK,qBACxC,CAAE,CACH,CAAC,CACE,CAAC,CACJ,CAAC,cACN/J,IAAA,CAACvB,GAAG,EAACmK,IAAI,CAAE,CAAE,CAAAnC,QAAA,cACXzG,IAAA,CAACjC,IAAI,EACHmI,KAAK,CAAC,gDAA2B,CACjC+D,QAAQ,CAAE,IAAK,CACftD,KAAK,CAAE,CAAEuD,SAAS,CAAE,GAAI,CAAE,CAAAzD,QAAA,cAE1BzG,IAAA,CAAChC,KAAK,EACJwL,OAAO,CAAEhB,sBAAuB,CAChCiB,UAAU,CAAExH,oBAAqB,CACjCyH,MAAM,CAAC,IAAI,CACX7B,IAAI,CAAC,OAAO,CACZ8B,UAAU,CAAE,CAAEQ,QAAQ,CAAE,CAAE,CAAE,CAC5BC,MAAM,CAAE,CAAEC,SAAS,CAAE,mBAAoB,CAAE,CAC5C,CAAC,CACE,CAAC,CACJ,CAAC,EACH,CAAC,EA1DF,WA2DG,CAAC,cAEVrK,IAAA,CAACI,OAAO,EACNiJ,GAAG,cACDnJ,KAAA,SAAAuG,QAAA,eACEzG,IAAA,CAACb,YAAY,GAAE,CAAC,iCACC,CAACsB,aAAa,CAACmC,MAAM,CAAC,GACzC,EAAM,CACP,CAAA6D,QAAA,cAGDvG,KAAA,CAAC1B,GAAG,EAACkK,MAAM,CAAE,EAAG,CAAAjC,QAAA,eACdzG,IAAA,CAACvB,GAAG,EAACmK,IAAI,CAAE,EAAG,CAAAnC,QAAA,cACZzG,IAAA,CAACjC,IAAI,EACHmI,KAAK,CAAC,iDAA8B,CACpCoD,KAAK,cACHtJ,IAAA,CAAC/B,MAAM,EACLkG,IAAI,CAAC,SAAS,CACd3B,IAAI,cAAExC,IAAA,CAACf,YAAY,GAAE,CAAE,CACvB6I,OAAO,CAAEA,CAAA,GAAM,CACbxG,YAAY,CAAC,SAAS,CAAC,CACvBF,YAAY,CAAC,WAAW,CAAC,CACzBF,eAAe,CAAC,IAAI,CAAC,CACrB;AACAiB,IAAI,CAAC4F,cAAc,CAAC,CAClBvC,cAAc,CAAE,MAAM,CACtBC,gBAAgB,CAAE7F,KAAK,CAAC,CAAC,CACzB0F,SAAS,CAAEiE,SAAS,CACpBrE,MAAM,CAAEqE,SAAS,CACjBpE,WAAW,CAAE,EACf,CAAC,CAAC,CACJ,CAAE,CAAAsB,QAAA,CACH,6BAED,CAAQ,CACT,CAAAA,QAAA,cAEDzG,IAAA,CAAChC,KAAK,EACJwL,OAAO,CAAEvB,eAAgB,CACzBwB,UAAU,CAAEhJ,aAAc,CAC1BM,OAAO,CAAEA,OAAQ,CACjB2I,MAAM,CAAC,IAAI,CACXC,UAAU,CAAE,CACVC,eAAe,CAAE,IAAI,CACrBC,eAAe,CAAE,IAAI,CACrBC,SAAS,CAAEA,CAACC,KAAK,CAAEC,KAAK,MAAA5E,MAAA,CACnB4E,KAAK,CAAC,CAAC,CAAC,MAAA5E,MAAA,CAAI4E,KAAK,CAAC,CAAC,CAAC,eAAA5E,MAAA,CAAQ2E,KAAK,yBACxC,CAAE,CACH,CAAC,CACE,CAAC,CACJ,CAAC,cACN/J,IAAA,CAACvB,GAAG,EAACmK,IAAI,CAAE,CAAE,CAAAnC,QAAA,cACXzG,IAAA,CAACjC,IAAI,EACHmI,KAAK,CAAC,8DAAoC,CAC1C+D,QAAQ,CAAE,IAAK,CACftD,KAAK,CAAE,CAAEuD,SAAS,CAAE,GAAI,CAAE,CAAAzD,QAAA,cAE1BzG,IAAA,CAAChC,KAAK,EACJwL,OAAO,CAAErB,sBAAuB,CAChCsB,UAAU,CAAE1H,oBAAqB,CACjC2H,MAAM,CAAC,IAAI,CACX7B,IAAI,CAAC,OAAO,CACZ8B,UAAU,CAAE,CAAEQ,QAAQ,CAAE,CAAE,CAAE,CAC5BC,MAAM,CAAE,CAAEC,SAAS,CAAE,mBAAoB,CAAE,CAC5C,CAAC,CACE,CAAC,CACJ,CAAC,EACH,CAAC,EA1DF,WA2DG,CAAC,EACN,CAAC,cAGPrK,IAAA,CAACH,gBAAgB,EACfyK,IAAI,CAAErJ,YAAa,CACnBsJ,OAAO,CAAEvE,gBAAiB,CAC1BwE,QAAQ,CAAE1F,aAAc,CACxB3D,SAAS,CAAEA,SAAU,CACrBE,SAAS,CAAEA,SAAU,CACrBc,IAAI,CAAEA,IAAK,CACXxB,SAAS,CAAEA,SAAU,CACrBE,SAAS,CAAEA,SAAU,CACrBU,UAAU,CAAEA,UAAW,CACxB,CAAC,EACC,CAAC,CAEV,CAAC,CAED,cAAe,CAAAjB,QAAQ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}