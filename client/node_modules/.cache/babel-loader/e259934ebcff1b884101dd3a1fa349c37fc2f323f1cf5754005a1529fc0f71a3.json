{"ast":null,"code":"import _objectSpread from\"C:/Users/ADMIN/Desktop/kho/kho/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{message}from'antd';import{Card,Table,Button,Modal,Input,Select,DatePicker,Space,Tag,Row,Col,Statistic,Tabs,InputNumber,Alert,Badge,Typography,Form}from'antd';import{PlusOutlined,UserOutlined,ShopOutlined,DollarOutlined,ExclamationCircleOutlined,CheckCircleOutlined,CreditCardOutlined,WalletOutlined}from'@ant-design/icons';import{customersAPI,suppliersAPI,financialAPI}from'../services/api';import dayjs from'dayjs';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const{Option}=Select;const{TabPane}=Tabs;const{Text}=Typography;const DebtPage=()=>{const[customerDebts,setCustomerDebts]=useState([]);const[supplierDebts,setSupplierDebts]=useState([]);const[customers,setCustomers]=useState([]);const[suppliers,setSuppliers]=useState([]);const[loading,setLoading]=useState(false);const[modalVisible,setModalVisible]=useState(false);const[activeTab,setActiveTab]=useState('customers');const[modalType,setModalType]=useState('payment');// 'payment' or 'debt'\nconst[submitting,setSubmitting]=useState(false);const[debtStats,setDebtStats]=useState({totalCustomerDebt:0,totalSupplierDebt:0,overduCustomerDebt:0,overdueSupplierDebt:0});const[supplierTransactions,setSupplierTransactions]=useState([]);// üÜï Ant Design Form instance\nconst[form]=Form.useForm();const paymentMethods=[{value:'cash',label:'Ti·ªÅn m·∫∑t',icon:/*#__PURE__*/_jsx(DollarOutlined,{})},{value:'card',label:'Th·∫ª',icon:/*#__PURE__*/_jsx(CreditCardOutlined,{})},{value:'transfer',label:'Chuy·ªÉn kho·∫£n',icon:/*#__PURE__*/_jsx(WalletOutlined,{})},{value:'ewallet',label:'V√≠ ƒëi·ªán t·ª≠',icon:/*#__PURE__*/_jsx(WalletOutlined,{})}];useEffect(()=>{console.log('üöÄ DebtPage mounted, fetching data...');fetchData();},[]);useEffect(()=>{console.log('üîÑ Customers state updated:',customers);},[customers]);useEffect(()=>{console.log('üîÑ Suppliers state updated:',suppliers);},[suppliers]);// Process debts when customers/suppliers data changes\nuseEffect(()=>{if(customers.length>0){fetchCustomerDebts();}},[customers]);// eslint-disable-line react-hooks/exhaustive-deps\nuseEffect(()=>{if(suppliers.length>0){fetchSupplierDebts();}},[suppliers]);// eslint-disable-line react-hooks/exhaustive-deps\n// Fetch supplier transactions for history\nuseEffect(()=>{if(activeTab==='suppliers'){fetchSupplierTransactions();}},[activeTab]);const fetchData=async()=>{setLoading(true);try{// First fetch all customers and suppliers\nawait Promise.all([fetchCustomers(),fetchSuppliers()]);// Then process debts (this will be done in useEffect when customers/suppliers change)\n}catch(error){message.error('L·ªói khi t·∫£i d·ªØ li·ªáu');}finally{setLoading(false);}};const fetchCustomerDebts=async()=>{try{// Use customers data that's already fetched and enhanced\nconst customersWithDebt=customers.filter(c=>(c.current_debt||0)>0);setCustomerDebts(customersWithDebt);// Calculate debt stats\nconst totalDebt=customersWithDebt.reduce((sum,c)=>sum+(c.current_debt||0),0);setDebtStats(prev=>_objectSpread(_objectSpread({},prev),{},{totalCustomerDebt:totalDebt}));}catch(error){console.error('Error processing customer debts:',error);setCustomerDebts([]);}};const fetchSupplierDebts=async()=>{try{// Use suppliers data that's already fetched and enhanced\nconst suppliersWithDebt=suppliers.filter(s=>(s.current_debt||0)>0);setSupplierDebts(suppliersWithDebt);// Calculate debt stats\nconst totalDebt=suppliersWithDebt.reduce((sum,s)=>sum+(s.current_debt||0),0);setDebtStats(prev=>_objectSpread(_objectSpread({},prev),{},{totalSupplierDebt:totalDebt}));}catch(error){console.error('Error processing supplier debts:',error);setSupplierDebts([]);}};const fetchSupplierTransactions=async()=>{try{const response=await financialAPI.getTransactions({type:'expense',category:'Tr·∫£ n·ª£ nh√† cung c·∫•p',limit:10});if(response.data.success){setSupplierTransactions(response.data.data||[]);}else{setSupplierTransactions([]);}}catch(error){setSupplierTransactions([]);}};const fetchCustomers=async()=>{try{const response=await customersAPI.getAll();console.log('üë• Raw customers response:',response.data);if(response.data.success){// Calculate debt for each customer (mock calculation for now)\nconst customersWithDebt=response.data.data.map(customer=>_objectSpread(_objectSpread({},customer),{},{current_debt:customer.current_debt||Math.floor(Math.random()*5000000),// Mock debt for demo\ntotal_spent:customer.total_spent||Math.floor(Math.random()*20000000)}));console.log('üí∞ Customers with debt:',customersWithDebt);console.log('üìä Total customers for dropdown:',customersWithDebt.length);setCustomers(customersWithDebt);}}catch(error){console.error('Error fetching customers:',error);// Fallback: Set empty array to avoid crashes\nsetCustomers([]);}};const fetchSuppliers=async()=>{try{const response=await suppliersAPI.getAll();console.log('üè≠ Raw suppliers response:',response.data);if(response.data.success){// Calculate debt for each supplier (mock calculation for now)\nconst suppliersWithDebt=response.data.data.map(supplier=>_objectSpread(_objectSpread({},supplier),{},{current_debt:supplier.current_debt||Math.floor(Math.random()*10000000),// Mock debt for demo\ntotal_purchases:supplier.total_purchases||Math.floor(Math.random()*50000000)}));console.log('üí∞ Suppliers with debt:',suppliersWithDebt);console.log('üìä Total suppliers for dropdown:',suppliersWithDebt.length);setSuppliers(suppliersWithDebt);}}catch(error){console.error('Error fetching suppliers:',error);// Fallback: Set empty array to avoid crashes\nsetSuppliers([]);}};// üÜï Enhanced form submission with proper error handling\nconst handlePayDebt=async values=>{try{var _values$transaction_d;setSubmitting(true);console.log('üí∞ Submitting payment data:',values);const transactionData={type:activeTab==='customers'?'income':'expense',category:activeTab==='customers'?'Thu n·ª£ kh√°ch h√†ng':'Tr·∫£ n·ª£ nh√† cung c·∫•p',amount:values.amount,description:values.description||\"Thanh to\\xE1n n\\u1EE3 \".concat(activeTab==='customers'?'kh√°ch h√†ng':'nh√† cung c·∫•p'),customer_id:activeTab==='customers'?values.entity_id:null,supplier_id:activeTab==='suppliers'?values.entity_id:null,payment_method:values.payment_method,transaction_date:((_values$transaction_d=values.transaction_date)===null||_values$transaction_d===void 0?void 0:_values$transaction_d.toISOString())||new Date().toISOString(),user_id:1};console.log('üì§ Transaction data to send:',transactionData);const response=await financialAPI.create(transactionData);if(response.data.success){message.success('Ghi nh·∫≠n thanh to√°n th√†nh c√¥ng!');setModalVisible(false);form.resetFields();fetchData();}else{throw new Error(response.data.message||'L·ªói kh√¥ng x√°c ƒë·ªãnh');}}catch(error){console.error('‚ùå Payment submission error:',error);message.error(error.message||'L·ªói khi ghi nh·∫≠n thanh to√°n');}finally{setSubmitting(false);}};// üÜï Enhanced modal close handler\nconst handleModalClose=()=>{setModalVisible(false);form.resetFields();setSubmitting(false);};const customerColumns=[{title:'M√£ KH',dataIndex:'code',key:'code',width:100},{title:'T√™n kh√°ch h√†ng',dataIndex:'name',key:'name',render:(name,record)=>/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{children:name}),record.phone&&/*#__PURE__*/_jsx(Text,{type:\"secondary\",style:{fontSize:12},children:record.phone})]})},{title:'Lo·∫°i KH',dataIndex:'customer_type',key:'customer_type',render:type=>{const colors={regular:'default',vip:'gold',wholesale:'blue'};const labels={regular:'Th∆∞·ªùng',vip:'VIP',wholesale:'S·ªâ'};return/*#__PURE__*/_jsx(Tag,{color:colors[type],children:labels[type]});}},{title:'S·ªë n·ª£',dataIndex:'current_debt',key:'current_debt',render:debt=>/*#__PURE__*/_jsxs(Text,{strong:true,style:{color:debt>0?'#ff4d4f':'#52c41a'},children:[debt.toLocaleString('vi-VN'),\" \\u20AB\"]}),sorter:(a,b)=>a.current_debt-b.current_debt},{title:'T·ªïng chi ti√™u',dataIndex:'total_spent',key:'total_spent',render:spent=>/*#__PURE__*/_jsxs(Text,{type:\"secondary\",children:[spent?spent.toLocaleString('vi-VN'):0,\" \\u20AB\"]})},{title:'Tr·∫°ng th√°i',key:'status',render:(_,record)=>{const debt=record.current_debt||0;if(debt===0){return/*#__PURE__*/_jsx(Badge,{status:\"success\",text:\"\\u0110\\xE3 thanh to\\xE1n\"});}else if(debt>1000000){return/*#__PURE__*/_jsx(Badge,{status:\"error\",text:\"N\\u1EE3 l\\u1EDBn\"});}else{return/*#__PURE__*/_jsx(Badge,{status:\"warning\",text:\"C\\xF3 n\\u1EE3\"});}}},{title:'Thao t√°c',key:'actions',render:(_,record)=>/*#__PURE__*/_jsx(Space,{children:/*#__PURE__*/_jsx(Button,{type:\"primary\",size:\"small\",icon:/*#__PURE__*/_jsx(DollarOutlined,{}),onClick:()=>{setModalType('payment');setActiveTab('customers');setModalVisible(true);// üÜï Set form values v·ªõi Ant Design Form\nform.setFieldsValue({entity_id:record.id,payment_method:'cash',transaction_date:dayjs(),amount:record.current_debt||0,description:\"Thanh to\\xE1n n\\u1EE3 kh\\xE1ch h\\xE0ng \".concat(record.name)});},children:\"Thanh to\\xE1n\"})})}];const supplierColumns=[{title:'M√£ NCC',dataIndex:'code',key:'code',width:100},{title:'T√™n nh√† cung c·∫•p',dataIndex:'name',key:'name',render:(name,record)=>/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{children:name}),record.phone&&/*#__PURE__*/_jsx(Text,{type:\"secondary\",style:{fontSize:12},children:record.phone})]})},{title:'ƒê·ªãa ch·ªâ',dataIndex:'address',key:'address',ellipsis:true},{title:'S·ªë n·ª£',dataIndex:'current_debt',key:'current_debt',render:debt=>/*#__PURE__*/_jsxs(Text,{strong:true,style:{color:debt>0?'#ff4d4f':'#52c41a'},children:[debt.toLocaleString('vi-VN'),\" \\u20AB\"]}),sorter:(a,b)=>a.current_debt-b.current_debt},{title:'Tr·∫°ng th√°i',key:'status',render:(_,record)=>{const debt=record.current_debt||0;if(debt===0){return/*#__PURE__*/_jsx(Badge,{status:\"success\",text:\"\\u0110\\xE3 thanh to\\xE1n\"});}else if(debt>5000000){return/*#__PURE__*/_jsx(Badge,{status:\"error\",text:\"N\\u1EE3 l\\u1EDBn\"});}else{return/*#__PURE__*/_jsx(Badge,{status:\"warning\",text:\"C\\xF3 n\\u1EE3\"});}}},{title:'Thao t√°c',key:'actions',render:(_,record)=>/*#__PURE__*/_jsx(Space,{children:/*#__PURE__*/_jsx(Button,{type:\"primary\",size:\"small\",icon:/*#__PURE__*/_jsx(DollarOutlined,{}),onClick:()=>{setModalType('payment');setActiveTab('suppliers');setModalVisible(true);// üÜï Set form values v·ªõi Ant Design Form\nform.setFieldsValue({entity_id:record.id,payment_method:'cash',transaction_date:dayjs(),amount:record.current_debt||0,description:\"Thanh to\\xE1n n\\u1EE3 nh\\xE0 cung c\\u1EA5p \".concat(record.name)});},children:\"Thanh to\\xE1n\"})})}];const renderDebtSummary=()=>{return/*#__PURE__*/_jsxs(Row,{gutter:16,style:{marginBottom:24},children:[/*#__PURE__*/_jsx(Col,{span:6,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(Statistic,{title:\"T\\u1ED5ng n\\u1EE3 kh\\xE1ch h\\xE0ng\",value:debtStats.totalCustomerDebt,precision:0,valueStyle:{color:'#cf1322'},prefix:/*#__PURE__*/_jsx(UserOutlined,{}),suffix:\"\\u20AB\"})})}),/*#__PURE__*/_jsx(Col,{span:6,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(Statistic,{title:\"T\\u1ED5ng n\\u1EE3 nh\\xE0 cung c\\u1EA5p\",value:debtStats.totalSupplierDebt,precision:0,valueStyle:{color:'#cf1322'},prefix:/*#__PURE__*/_jsx(ShopOutlined,{}),suffix:\"\\u20AB\"})})}),/*#__PURE__*/_jsx(Col,{span:6,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(Statistic,{title:\"T\\u1ED5ng n\\u1EE3 ph\\u1EA3i thu\",value:debtStats.totalCustomerDebt+debtStats.totalSupplierDebt,precision:0,valueStyle:{color:'#1890ff'},prefix:/*#__PURE__*/_jsx(DollarOutlined,{}),suffix:\"\\u20AB\"})})}),/*#__PURE__*/_jsx(Col,{span:6,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(Statistic,{title:\"S\\u1ED1 kh\\xE1ch h\\xE0ng c\\xF3 n\\u1EE3\",value:customerDebts.length,valueStyle:{color:'#52c41a'},prefix:/*#__PURE__*/_jsx(UserOutlined,{})})})}),/*#__PURE__*/_jsx(Col,{span:8,style:{minWidth:320},children:/*#__PURE__*/_jsx(Card,{title:\"L\\u1ECBch s\\u1EED thanh to\\xE1n n\\u1EE3 nh\\xE0 cung c\\u1EA5p\",bordered:true,style:{height:260,overflowY:'auto'},children:supplierTransactions.length===0?/*#__PURE__*/_jsx(\"div\",{style:{color:'#999',textAlign:'center',marginTop:32},children:\"Ch\\u01B0a c\\xF3 giao d\\u1ECBch\"}):/*#__PURE__*/_jsx(\"ul\",{style:{listStyle:'none',padding:0,margin:0},children:supplierTransactions.map(tx=>/*#__PURE__*/_jsxs(\"li\",{style:{marginBottom:12,borderBottom:'1px solid #f0f0f0',paddingBottom:8},children:[/*#__PURE__*/_jsxs(\"div\",{style:{fontWeight:500,color:'#cf1322'},children:[\"- \",tx.amount.toLocaleString('vi-VN'),\" \\u20AB\"]}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:12,color:'#666'},children:tx.description||'Thanh to√°n n·ª£ nh√† cung c·∫•p'}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:11,color:'#999'},children:tx.transaction_date?new Date(tx.transaction_date).toLocaleString('vi-VN',{timeZone:'Asia/Ho_Chi_Minh'}):''})]},tx.id))})})})]});};return/*#__PURE__*/_jsxs(\"div\",{style:{padding:24},children:[renderDebtSummary(),/*#__PURE__*/_jsx(Alert,{message:\"Qu\\u1EA3n l\\xFD n\\u1EE3\",description:\"Theo d\\xF5i v\\xE0 qu\\u1EA3n l\\xFD c\\xE1c kho\\u1EA3n n\\u1EE3 c\\u1EE7a kh\\xE1ch h\\xE0ng v\\xE0 nh\\xE0 cung c\\u1EA5p. H\\u1EC7 th\\u1ED1ng s\\u1EBD t\\u1EF1 \\u0111\\u1ED9ng c\\u1EADp nh\\u1EADt s\\u1ED1 d\\u01B0 n\\u1EE3 khi c\\xF3 giao d\\u1ECBch thanh to\\xE1n.\",type:\"info\",showIcon:true,style:{marginBottom:24}}),/*#__PURE__*/_jsxs(Tabs,{activeKey:activeTab,onChange:setActiveTab,children:[/*#__PURE__*/_jsx(TabPane,{tab:/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(UserOutlined,{}),\"N\\u1EE3 kh\\xE1ch h\\xE0ng (\",customerDebts.length,\")\"]}),children:/*#__PURE__*/_jsx(Card,{title:\"Danh s\\xE1ch kh\\xE1ch h\\xE0ng c\\xF3 n\\u1EE3\",extra:/*#__PURE__*/_jsx(Button,{type:\"primary\",icon:/*#__PURE__*/_jsx(PlusOutlined,{}),onClick:()=>{setModalType('payment');setActiveTab('customers');setModalVisible(true);// üÜï Reset form v·ªõi values m·∫∑c ƒë·ªãnh\nform.setFieldsValue({payment_method:'cash',transaction_date:dayjs(),entity_id:undefined,amount:undefined,description:''});},children:\"Ghi nh\\u1EADn thanh to\\xE1n\"}),children:/*#__PURE__*/_jsx(Table,{columns:customerColumns,dataSource:customerDebts,loading:loading,rowKey:\"id\",pagination:{showSizeChanger:true,showQuickJumper:true,showTotal:(total,range)=>\"\".concat(range[0],\"-\").concat(range[1],\" c\\u1EE7a \").concat(total,\" kh\\xE1ch h\\xE0ng\")}})})},\"customers\"),/*#__PURE__*/_jsx(TabPane,{tab:/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(ShopOutlined,{}),\"N\\u1EE3 nh\\xE0 cung c\\u1EA5p (\",supplierDebts.length,\")\"]}),children:/*#__PURE__*/_jsx(Card,{title:\"Danh s\\xE1ch nh\\xE0 cung c\\u1EA5p c\\xF3 n\\u1EE3\",extra:/*#__PURE__*/_jsx(Button,{type:\"primary\",icon:/*#__PURE__*/_jsx(PlusOutlined,{}),onClick:()=>{setModalType('payment');setActiveTab('suppliers');setModalVisible(true);// üÜï Reset form v·ªõi values m·∫∑c ƒë·ªãnh\nform.setFieldsValue({payment_method:'cash',transaction_date:dayjs(),entity_id:undefined,amount:undefined,description:''});},children:\"Ghi nh\\u1EADn thanh to\\xE1n\"}),children:/*#__PURE__*/_jsx(Table,{columns:supplierColumns,dataSource:supplierDebts,loading:loading,rowKey:\"id\",pagination:{showSizeChanger:true,showQuickJumper:true,showTotal:(total,range)=>\"\".concat(range[0],\"-\").concat(range[1],\" c\\u1EE7a \").concat(total,\" nh\\xE0 cung c\\u1EA5p\")}})})},\"suppliers\")]}),/*#__PURE__*/_jsx(Modal,{title:/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'8px'},children:[/*#__PURE__*/_jsx(DollarOutlined,{style:{color:'#52c41a'}}),/*#__PURE__*/_jsxs(\"span\",{children:[\"Ghi nh\\u1EADn thanh to\\xE1n \",activeTab==='customers'?'n·ª£ kh√°ch h√†ng':'n·ª£ nh√† cung c·∫•p']})]}),open:modalVisible,onCancel:handleModalClose,footer:null,width:700,destroyOnClose:true,children:/*#__PURE__*/_jsxs(Form,{form:form,layout:\"vertical\",onFinish:handlePayDebt,initialValues:{payment_method:'cash',transaction_date:dayjs()},children:[/*#__PURE__*/_jsx(Form.Item,{label:\"\".concat(activeTab==='customers'?'Kh√°ch h√†ng':'Nh√† cung c·∫•p'),name:\"entity_id\",rules:[{required:true,message:\"Vui l\\xF2ng ch\\u1ECDn \".concat(activeTab==='customers'?'kh√°ch h√†ng':'nh√† cung c·∫•p')}],children:/*#__PURE__*/_jsx(Select,{placeholder:\"Ch\\u1ECDn \".concat(activeTab==='customers'?'kh√°ch h√†ng':'nh√† cung c·∫•p'),style:{width:'100%'},showSearch:true,filterOption:(input,option)=>{const children=typeof option.children==='string'?option.children:'';return children.toLowerCase().indexOf(input.toLowerCase())>=0;},size:\"large\",children:(()=>{const entities=activeTab==='customers'?customers:suppliers;console.log(\"\\uD83D\\uDD0D Rendering dropdown for \".concat(activeTab,\":\"),entities);console.log(\"\\uD83D\\uDCCB Total entities to render: \".concat(entities.length));return entities&&entities.length>0?entities.map(entity=>{// üõ°Ô∏è Safety check ƒë·ªÉ tr√°nh undefined\nif(!entity||!entity.id||!entity.name){console.warn('‚ö†Ô∏è Invalid entity found:',entity);return null;}return/*#__PURE__*/_jsx(Option,{value:entity.id,children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:'bold'},children:entity.name}),entity.phone&&/*#__PURE__*/_jsxs(Text,{type:\"secondary\",style:{fontSize:12},children:[\"\\uD83D\\uDCDE \",entity.phone]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Text,{type:\"secondary\",style:{fontSize:12,color:'#ff4d4f'},children:[\"\\uD83D\\uDCB0 N\\u1EE3 hi\\u1EC7n t\\u1EA1i: \",(entity.current_debt||0).toLocaleString('vi-VN'),\" \\u20AB\"]})})]})},entity.id);}).filter(Boolean):[];// Filter out null entries\n})()})}),/*#__PURE__*/_jsxs(Row,{gutter:16,children:[/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:\"S\\u1ED1 ti\\u1EC1n thanh to\\xE1n\",name:\"amount\",rules:[{required:true,message:'Vui l√≤ng nh·∫≠p s·ªë ti·ªÅn'},{type:'number',min:1,message:'S·ªë ti·ªÅn ph·∫£i l·ªõn h∆°n 0'}],children:/*#__PURE__*/_jsx(InputNumber,{placeholder:\"Nh\\u1EADp s\\u1ED1 ti\\u1EC1n\",style:{width:'100%'},formatter:value=>\"\".concat(value).replace(/\\B(?=(\\d{3})+(?!\\d))/g,','),parser:value=>value?value.replace(/\\$\\s?|(,*)/g,''):'',min:0,size:\"large\",addonAfter:\"\\u20AB\"})})}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:\"Ph\\u01B0\\u01A1ng th\\u1EE9c thanh to\\xE1n\",name:\"payment_method\",rules:[{required:true,message:'Vui l√≤ng ch·ªçn ph∆∞∆°ng th·ª©c thanh to√°n'}],children:/*#__PURE__*/_jsx(Select,{placeholder:\"Ch\\u1ECDn ph\\u01B0\\u01A1ng th\\u1EE9c\",style:{width:'100%'},size:\"large\",children:paymentMethods.map(method=>/*#__PURE__*/_jsx(Option,{value:method.value,children:/*#__PURE__*/_jsxs(Space,{children:[method.icon,method.label]})},method.value))})})})]}),/*#__PURE__*/_jsx(Form.Item,{label:\"M\\xF4 t\\u1EA3\",name:\"description\",children:/*#__PURE__*/_jsx(Input.TextArea,{placeholder:\"Nh\\u1EADp m\\xF4 t\\u1EA3 thanh to\\xE1n (t\\xF9y ch\\u1ECDn)\",rows:3,showCount:true,maxLength:500})}),/*#__PURE__*/_jsx(Form.Item,{label:\"Ng\\xE0y thanh to\\xE1n\",name:\"transaction_date\",rules:[{required:true,message:'Vui l√≤ng ch·ªçn ng√†y thanh to√°n'}],children:/*#__PURE__*/_jsx(DatePicker,{style:{width:'100%'},size:\"large\",format:\"DD/MM/YYYY\",placeholder:\"Ch\\u1ECDn ng\\xE0y thanh to\\xE1n\"})}),/*#__PURE__*/_jsx(Form.Item,{style:{textAlign:'right',marginTop:24,marginBottom:0},children:/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsx(Button,{onClick:handleModalClose,size:\"large\",children:\"H\\u1EE7y\"}),/*#__PURE__*/_jsx(Button,{type:\"primary\",htmlType:\"submit\",loading:submitting,icon:/*#__PURE__*/_jsx(DollarOutlined,{}),size:\"large\",children:\"Ghi nh\\u1EADn thanh to\\xE1n\"})]})})]})})]});};export default DebtPage;","map":{"version":3,"names":["React","useState","useEffect","message","Card","Table","Button","Modal","Input","Select","DatePicker","Space","Tag","Row","Col","Statistic","Tabs","InputNumber","Alert","Badge","Typography","Form","PlusOutlined","UserOutlined","ShopOutlined","DollarOutlined","ExclamationCircleOutlined","CheckCircleOutlined","CreditCardOutlined","WalletOutlined","customersAPI","suppliersAPI","financialAPI","dayjs","jsx","_jsx","jsxs","_jsxs","Option","TabPane","Text","DebtPage","customerDebts","setCustomerDebts","supplierDebts","setSupplierDebts","customers","setCustomers","suppliers","setSuppliers","loading","setLoading","modalVisible","setModalVisible","activeTab","setActiveTab","modalType","setModalType","submitting","setSubmitting","debtStats","setDebtStats","totalCustomerDebt","totalSupplierDebt","overduCustomerDebt","overdueSupplierDebt","supplierTransactions","setSupplierTransactions","form","useForm","paymentMethods","value","label","icon","console","log","fetchData","length","fetchCustomerDebts","fetchSupplierDebts","fetchSupplierTransactions","Promise","all","fetchCustomers","fetchSuppliers","error","customersWithDebt","filter","c","current_debt","totalDebt","reduce","sum","prev","_objectSpread","suppliersWithDebt","s","response","getTransactions","type","category","limit","data","success","getAll","map","customer","Math","floor","random","total_spent","supplier","total_purchases","handlePayDebt","values","_values$transaction_d","transactionData","amount","description","concat","customer_id","entity_id","supplier_id","payment_method","transaction_date","toISOString","Date","user_id","create","resetFields","Error","handleModalClose","customerColumns","title","dataIndex","key","width","render","name","record","children","phone","style","fontSize","colors","regular","vip","wholesale","labels","color","debt","strong","toLocaleString","sorter","a","b","spent","_","status","text","size","onClick","setFieldsValue","id","supplierColumns","ellipsis","renderDebtSummary","gutter","marginBottom","span","precision","valueStyle","prefix","suffix","minWidth","bordered","height","overflowY","textAlign","marginTop","listStyle","padding","margin","tx","borderBottom","paddingBottom","fontWeight","timeZone","showIcon","activeKey","onChange","tab","extra","undefined","columns","dataSource","rowKey","pagination","showSizeChanger","showQuickJumper","showTotal","total","range","display","alignItems","gap","open","onCancel","footer","destroyOnClose","layout","onFinish","initialValues","Item","rules","required","placeholder","showSearch","filterOption","input","option","toLowerCase","indexOf","entities","entity","warn","Boolean","min","formatter","replace","parser","addonAfter","method","TextArea","rows","showCount","maxLength","format","htmlType"],"sources":["C:/Users/ADMIN/Desktop/kho/kho/client/src/pages/DebtPage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { message } from 'antd';\r\nimport {\r\n  Card,\r\n  Table,\r\n  Button,\r\n  Modal,\r\n  Input,\r\n  Select,\r\n  DatePicker,\r\n  Space,\r\n  Tag,\r\n  Row,\r\n  Col,\r\n  Statistic,\r\n  Tabs,\r\n  InputNumber,\r\n  Alert,\r\n  Badge,\r\n  Typography,\r\n  Form,\r\n} from 'antd';\r\nimport {\r\n  PlusOutlined,\r\n  UserOutlined,\r\n  ShopOutlined,\r\n  DollarOutlined,\r\n  ExclamationCircleOutlined,\r\n  CheckCircleOutlined,\r\n  CreditCardOutlined,\r\n  WalletOutlined,\r\n} from '@ant-design/icons';\r\nimport { customersAPI, suppliersAPI, financialAPI } from '../services/api';\r\nimport dayjs from 'dayjs';\r\n\r\nconst { Option } = Select;\r\nconst { TabPane } = Tabs;\r\nconst { Text } = Typography;\r\n\r\nconst DebtPage = () => {\r\n  const [customerDebts, setCustomerDebts] = useState([]);\r\n  const [supplierDebts, setSupplierDebts] = useState([]);\r\n  const [customers, setCustomers] = useState([]);\r\n  const [suppliers, setSuppliers] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [modalVisible, setModalVisible] = useState(false);\r\n  const [activeTab, setActiveTab] = useState('customers');\r\n  const [modalType, setModalType] = useState('payment'); // 'payment' or 'debt'\r\n  const [submitting, setSubmitting] = useState(false);\r\n  const [debtStats, setDebtStats] = useState({\r\n    totalCustomerDebt: 0,\r\n    totalSupplierDebt: 0,\r\n    overduCustomerDebt: 0,\r\n    overdueSupplierDebt: 0,\r\n  });\r\n  const [supplierTransactions, setSupplierTransactions] = useState([]);\r\n\r\n  // üÜï Ant Design Form instance\r\n  const [form] = Form.useForm();\r\n\r\n  const paymentMethods = [\r\n    { value: 'cash', label: 'Ti·ªÅn m·∫∑t', icon: <DollarOutlined /> },\r\n    { value: 'card', label: 'Th·∫ª', icon: <CreditCardOutlined /> },\r\n    { value: 'transfer', label: 'Chuy·ªÉn kho·∫£n', icon: <WalletOutlined /> },\r\n    { value: 'ewallet', label: 'V√≠ ƒëi·ªán t·ª≠', icon: <WalletOutlined /> },\r\n  ];\r\n\r\n  useEffect(() => {\r\n    console.log('üöÄ DebtPage mounted, fetching data...');\r\n    fetchData();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    console.log('üîÑ Customers state updated:', customers);\r\n  }, [customers]);\r\n\r\n  useEffect(() => {\r\n    console.log('üîÑ Suppliers state updated:', suppliers);\r\n  }, [suppliers]);\r\n\r\n  // Process debts when customers/suppliers data changes\r\n  useEffect(() => {\r\n    if (customers.length > 0) {\r\n      fetchCustomerDebts();\r\n    }\r\n  }, [customers]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  useEffect(() => {\r\n    if (suppliers.length > 0) {\r\n      fetchSupplierDebts();\r\n    }\r\n  }, [suppliers]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  // Fetch supplier transactions for history\r\n  useEffect(() => {\r\n    if (activeTab === 'suppliers') {\r\n      fetchSupplierTransactions();\r\n    }\r\n  }, [activeTab]);\r\n\r\n  const fetchData = async () => {\r\n    setLoading(true);\r\n    try {\r\n      // First fetch all customers and suppliers\r\n      await Promise.all([\r\n        fetchCustomers(),\r\n        fetchSuppliers(),\r\n      ]);\r\n      \r\n      // Then process debts (this will be done in useEffect when customers/suppliers change)\r\n    } catch (error) {\r\n      message.error('L·ªói khi t·∫£i d·ªØ li·ªáu');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const fetchCustomerDebts = async () => {\r\n    try {\r\n      // Use customers data that's already fetched and enhanced\r\n      const customersWithDebt = customers.filter(c => (c.current_debt || 0) > 0);\r\n      setCustomerDebts(customersWithDebt);\r\n      \r\n      // Calculate debt stats\r\n      const totalDebt = customersWithDebt.reduce((sum, c) => sum + (c.current_debt || 0), 0);\r\n      setDebtStats(prev => ({ ...prev, totalCustomerDebt: totalDebt }));\r\n    } catch (error) {\r\n      console.error('Error processing customer debts:', error);\r\n      setCustomerDebts([]);\r\n    }\r\n  };\r\n\r\n  const fetchSupplierDebts = async () => {\r\n    try {\r\n      // Use suppliers data that's already fetched and enhanced\r\n      const suppliersWithDebt = suppliers.filter(s => (s.current_debt || 0) > 0);\r\n      setSupplierDebts(suppliersWithDebt);\r\n      \r\n      // Calculate debt stats\r\n      const totalDebt = suppliersWithDebt.reduce((sum, s) => sum + (s.current_debt || 0), 0);\r\n      setDebtStats(prev => ({ ...prev, totalSupplierDebt: totalDebt }));\r\n    } catch (error) {\r\n      console.error('Error processing supplier debts:', error);\r\n      setSupplierDebts([]);\r\n    }\r\n  };\r\n\r\n  const fetchSupplierTransactions = async () => {\r\n    try {\r\n      const response = await financialAPI.getTransactions({ type: 'expense', category: 'Tr·∫£ n·ª£ nh√† cung c·∫•p', limit: 10 });\r\n      if (response.data.success) {\r\n        setSupplierTransactions(response.data.data || []);\r\n      } else {\r\n        setSupplierTransactions([]);\r\n      }\r\n    } catch (error) {\r\n      setSupplierTransactions([]);\r\n    }\r\n  };\r\n\r\n  const fetchCustomers = async () => {\r\n    try {\r\n      const response = await customersAPI.getAll();\r\n      console.log('üë• Raw customers response:', response.data);\r\n      \r\n      if (response.data.success) {\r\n        // Calculate debt for each customer (mock calculation for now)\r\n        const customersWithDebt = response.data.data.map(customer => ({\r\n          ...customer,\r\n          current_debt: customer.current_debt || Math.floor(Math.random() * 5000000), // Mock debt for demo\r\n          total_spent: customer.total_spent || Math.floor(Math.random() * 20000000)\r\n        }));\r\n        \r\n        console.log('üí∞ Customers with debt:', customersWithDebt);\r\n        console.log('üìä Total customers for dropdown:', customersWithDebt.length);\r\n        setCustomers(customersWithDebt);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching customers:', error);\r\n      // Fallback: Set empty array to avoid crashes\r\n      setCustomers([]);\r\n    }\r\n  };\r\n\r\n  const fetchSuppliers = async () => {\r\n    try {\r\n      const response = await suppliersAPI.getAll();\r\n      console.log('üè≠ Raw suppliers response:', response.data);\r\n      \r\n      if (response.data.success) {\r\n        // Calculate debt for each supplier (mock calculation for now)\r\n        const suppliersWithDebt = response.data.data.map(supplier => ({\r\n          ...supplier,\r\n          current_debt: supplier.current_debt || Math.floor(Math.random() * 10000000), // Mock debt for demo\r\n          total_purchases: supplier.total_purchases || Math.floor(Math.random() * 50000000)\r\n        }));\r\n        \r\n        console.log('üí∞ Suppliers with debt:', suppliersWithDebt);\r\n        console.log('üìä Total suppliers for dropdown:', suppliersWithDebt.length);\r\n        setSuppliers(suppliersWithDebt);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching suppliers:', error);\r\n      // Fallback: Set empty array to avoid crashes\r\n      setSuppliers([]);\r\n    }\r\n  };\r\n\r\n  // üÜï Enhanced form submission with proper error handling\r\n  const handlePayDebt = async (values) => {\r\n    try {\r\n      setSubmitting(true);\r\n      console.log('üí∞ Submitting payment data:', values);\r\n      \r\n      const transactionData = {\r\n        type: activeTab === 'customers' ? 'income' : 'expense',\r\n        category: activeTab === 'customers' ? 'Thu n·ª£ kh√°ch h√†ng' : 'Tr·∫£ n·ª£ nh√† cung c·∫•p',\r\n        amount: values.amount,\r\n        description: values.description || `Thanh to√°n n·ª£ ${activeTab === 'customers' ? 'kh√°ch h√†ng' : 'nh√† cung c·∫•p'}`,\r\n        customer_id: activeTab === 'customers' ? values.entity_id : null,\r\n        supplier_id: activeTab === 'suppliers' ? values.entity_id : null,\r\n        payment_method: values.payment_method,\r\n        transaction_date: values.transaction_date?.toISOString() || new Date().toISOString(),\r\n        user_id: 1,\r\n      };\r\n\r\n      console.log('üì§ Transaction data to send:', transactionData);\r\n\r\n      const response = await financialAPI.create(transactionData);\r\n      if (response.data.success) {\r\n        message.success('Ghi nh·∫≠n thanh to√°n th√†nh c√¥ng!');\r\n        setModalVisible(false);\r\n        form.resetFields();\r\n        fetchData();\r\n      } else {\r\n        throw new Error(response.data.message || 'L·ªói kh√¥ng x√°c ƒë·ªãnh');\r\n      }\r\n    } catch (error) {\r\n      console.error('‚ùå Payment submission error:', error);\r\n      message.error(error.message || 'L·ªói khi ghi nh·∫≠n thanh to√°n');\r\n    } finally {\r\n      setSubmitting(false);\r\n    }\r\n  };\r\n\r\n  // üÜï Enhanced modal close handler\r\n  const handleModalClose = () => {\r\n    setModalVisible(false);\r\n    form.resetFields();\r\n    setSubmitting(false);\r\n  };\r\n\r\n  const customerColumns = [\r\n    {\r\n      title: 'M√£ KH',\r\n      dataIndex: 'code',\r\n      key: 'code',\r\n      width: 100,\r\n    },\r\n    {\r\n      title: 'T√™n kh√°ch h√†ng',\r\n      dataIndex: 'name',\r\n      key: 'name',\r\n      render: (name, record) => (\r\n        <div>\r\n          <div>{name}</div>\r\n          {record.phone && (\r\n            <Text type=\"secondary\" style={{ fontSize: 12 }}>\r\n              {record.phone}\r\n            </Text>\r\n          )}\r\n        </div>\r\n      ),\r\n    },\r\n    {\r\n      title: 'Lo·∫°i KH',\r\n      dataIndex: 'customer_type',\r\n      key: 'customer_type',\r\n      render: (type) => {\r\n        const colors = {\r\n          regular: 'default',\r\n          vip: 'gold',\r\n          wholesale: 'blue',\r\n        };\r\n        const labels = {\r\n          regular: 'Th∆∞·ªùng',\r\n          vip: 'VIP',\r\n          wholesale: 'S·ªâ',\r\n        };\r\n        return <Tag color={colors[type]}>{labels[type]}</Tag>;\r\n      },\r\n    },\r\n    {\r\n      title: 'S·ªë n·ª£',\r\n      dataIndex: 'current_debt',\r\n      key: 'current_debt',\r\n      render: (debt) => (\r\n        <Text strong style={{ color: debt > 0 ? '#ff4d4f' : '#52c41a' }}>\r\n          {debt.toLocaleString('vi-VN')} ‚Ç´\r\n        </Text>\r\n      ),\r\n      sorter: (a, b) => a.current_debt - b.current_debt,\r\n    },\r\n    {\r\n      title: 'T·ªïng chi ti√™u',\r\n      dataIndex: 'total_spent',\r\n      key: 'total_spent',\r\n      render: (spent) => (\r\n        <Text type=\"secondary\">\r\n          {spent ? spent.toLocaleString('vi-VN') : 0} ‚Ç´\r\n        </Text>\r\n      ),\r\n    },\r\n    {\r\n      title: 'Tr·∫°ng th√°i',\r\n      key: 'status',\r\n      render: (_, record) => {\r\n        const debt = record.current_debt || 0;\r\n        if (debt === 0) {\r\n          return <Badge status=\"success\" text=\"ƒê√£ thanh to√°n\" />;\r\n        } else if (debt > 1000000) {\r\n          return <Badge status=\"error\" text=\"N·ª£ l·ªõn\" />;\r\n        } else {\r\n          return <Badge status=\"warning\" text=\"C√≥ n·ª£\" />;\r\n        }\r\n      },\r\n    },\r\n    {\r\n      title: 'Thao t√°c',\r\n      key: 'actions',\r\n      render: (_, record) => (\r\n        <Space>\r\n          <Button\r\n            type=\"primary\"\r\n            size=\"small\"\r\n            icon={<DollarOutlined />}\r\n            onClick={() => {\r\n              setModalType('payment');\r\n              setActiveTab('customers');\r\n              setModalVisible(true);\r\n              // üÜï Set form values v·ªõi Ant Design Form\r\n              form.setFieldsValue({\r\n                entity_id: record.id,\r\n                payment_method: 'cash',\r\n                transaction_date: dayjs(),\r\n                amount: record.current_debt || 0,\r\n                description: `Thanh to√°n n·ª£ kh√°ch h√†ng ${record.name}`\r\n              });\r\n            }}\r\n          >\r\n            Thanh to√°n\r\n          </Button>\r\n        </Space>\r\n      ),\r\n    },\r\n  ];\r\n\r\n  const supplierColumns = [\r\n    {\r\n      title: 'M√£ NCC',\r\n      dataIndex: 'code',\r\n      key: 'code',\r\n      width: 100,\r\n    },\r\n    {\r\n      title: 'T√™n nh√† cung c·∫•p',\r\n      dataIndex: 'name',\r\n      key: 'name',\r\n      render: (name, record) => (\r\n        <div>\r\n          <div>{name}</div>\r\n          {record.phone && (\r\n            <Text type=\"secondary\" style={{ fontSize: 12 }}>\r\n              {record.phone}\r\n            </Text>\r\n          )}\r\n        </div>\r\n      ),\r\n    },\r\n    {\r\n      title: 'ƒê·ªãa ch·ªâ',\r\n      dataIndex: 'address',\r\n      key: 'address',\r\n      ellipsis: true,\r\n    },\r\n    {\r\n      title: 'S·ªë n·ª£',\r\n      dataIndex: 'current_debt',\r\n      key: 'current_debt',\r\n      render: (debt) => (\r\n        <Text strong style={{ color: debt > 0 ? '#ff4d4f' : '#52c41a' }}>\r\n          {debt.toLocaleString('vi-VN')} ‚Ç´\r\n        </Text>\r\n      ),\r\n      sorter: (a, b) => a.current_debt - b.current_debt,\r\n    },\r\n    {\r\n      title: 'Tr·∫°ng th√°i',\r\n      key: 'status',\r\n      render: (_, record) => {\r\n        const debt = record.current_debt || 0;\r\n        if (debt === 0) {\r\n          return <Badge status=\"success\" text=\"ƒê√£ thanh to√°n\" />;\r\n        } else if (debt > 5000000) {\r\n          return <Badge status=\"error\" text=\"N·ª£ l·ªõn\" />;\r\n        } else {\r\n          return <Badge status=\"warning\" text=\"C√≥ n·ª£\" />;\r\n        }\r\n      },\r\n    },\r\n    {\r\n      title: 'Thao t√°c',\r\n      key: 'actions',\r\n      render: (_, record) => (\r\n        <Space>\r\n          <Button\r\n            type=\"primary\"\r\n            size=\"small\"\r\n            icon={<DollarOutlined />}\r\n            onClick={() => {\r\n              setModalType('payment');\r\n              setActiveTab('suppliers');\r\n              setModalVisible(true);\r\n              // üÜï Set form values v·ªõi Ant Design Form\r\n              form.setFieldsValue({\r\n                entity_id: record.id,\r\n                payment_method: 'cash',\r\n                transaction_date: dayjs(),\r\n                amount: record.current_debt || 0,\r\n                description: `Thanh to√°n n·ª£ nh√† cung c·∫•p ${record.name}`\r\n              });\r\n            }}\r\n          >\r\n            Thanh to√°n\r\n          </Button>\r\n        </Space>\r\n      ),\r\n    },\r\n  ];\r\n\r\n  const renderDebtSummary = () => {\r\n    return (\r\n      <Row gutter={16} style={{ marginBottom: 24 }}>\r\n        <Col span={6}>\r\n          <Card>\r\n            <Statistic\r\n              title=\"T·ªïng n·ª£ kh√°ch h√†ng\"\r\n              value={debtStats.totalCustomerDebt}\r\n              precision={0}\r\n              valueStyle={{ color: '#cf1322' }}\r\n              prefix={<UserOutlined />}\r\n              suffix=\"‚Ç´\"\r\n            />\r\n          </Card>\r\n        </Col>\r\n        <Col span={6}>\r\n          <Card>\r\n            <Statistic\r\n              title=\"T·ªïng n·ª£ nh√† cung c·∫•p\"\r\n              value={debtStats.totalSupplierDebt}\r\n              precision={0}\r\n              valueStyle={{ color: '#cf1322' }}\r\n              prefix={<ShopOutlined />}\r\n              suffix=\"‚Ç´\"\r\n            />\r\n          </Card>\r\n        </Col>\r\n        <Col span={6}>\r\n          <Card>\r\n            <Statistic\r\n              title=\"T·ªïng n·ª£ ph·∫£i thu\"\r\n              value={debtStats.totalCustomerDebt + debtStats.totalSupplierDebt}\r\n              precision={0}\r\n              valueStyle={{ color: '#1890ff' }}\r\n              prefix={<DollarOutlined />}\r\n              suffix=\"‚Ç´\"\r\n            />\r\n          </Card>\r\n        </Col>\r\n        <Col span={6}>\r\n          <Card>\r\n            <Statistic\r\n              title=\"S·ªë kh√°ch h√†ng c√≥ n·ª£\"\r\n              value={customerDebts.length}\r\n              valueStyle={{ color: '#52c41a' }}\r\n              prefix={<UserOutlined />}\r\n            />\r\n          </Card>\r\n        </Col>\r\n        {/* L·ªãch s·ª≠ giao d·ªãch b√™n ph·∫£i √¥ N·ª£ nh√† cung c·∫•p */}\r\n        <Col span={8} style={{ minWidth: 320 }}>\r\n          <Card title=\"L·ªãch s·ª≠ thanh to√°n n·ª£ nh√† cung c·∫•p\" bordered={true} style={{ height: 260, overflowY: 'auto' }}>\r\n            {supplierTransactions.length === 0 ? (\r\n              <div style={{ color: '#999', textAlign: 'center', marginTop: 32 }}>Ch∆∞a c√≥ giao d·ªãch</div>\r\n            ) : (\r\n              <ul style={{ listStyle: 'none', padding: 0, margin: 0 }}>\r\n                {supplierTransactions.map(tx => (\r\n                  <li key={tx.id} style={{ marginBottom: 12, borderBottom: '1px solid #f0f0f0', paddingBottom: 8 }}>\r\n                    <div style={{ fontWeight: 500, color: '#cf1322' }}>- {tx.amount.toLocaleString('vi-VN')} ‚Ç´</div>\r\n                    <div style={{ fontSize: 12, color: '#666' }}>{tx.description || 'Thanh to√°n n·ª£ nh√† cung c·∫•p'}</div>\r\n                    <div style={{ fontSize: 11, color: '#999' }}>{tx.transaction_date ? new Date(tx.transaction_date).toLocaleString('vi-VN', { timeZone: 'Asia/Ho_Chi_Minh' }) : ''}</div>\r\n                  </li>\r\n                ))}\r\n              </ul>\r\n            )}\r\n          </Card>\r\n        </Col>\r\n      </Row>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div style={{ padding: 24 }}>\r\n      {renderDebtSummary()}\r\n\r\n      <Alert\r\n        message=\"Qu·∫£n l√Ω n·ª£\"\r\n        description=\"Theo d√µi v√† qu·∫£n l√Ω c√°c kho·∫£n n·ª£ c·ªßa kh√°ch h√†ng v√† nh√† cung c·∫•p. H·ªá th·ªëng s·∫Ω t·ª± ƒë·ªông c·∫≠p nh·∫≠t s·ªë d∆∞ n·ª£ khi c√≥ giao d·ªãch thanh to√°n.\"\r\n        type=\"info\"\r\n        showIcon\r\n        style={{ marginBottom: 24 }}\r\n      />\r\n\r\n      <Tabs activeKey={activeTab} onChange={setActiveTab}>\r\n        <TabPane\r\n          tab={\r\n            <span>\r\n              <UserOutlined />\r\n              N·ª£ kh√°ch h√†ng ({customerDebts.length})\r\n            </span>\r\n          }\r\n          key=\"customers\"\r\n        >\r\n          <Card\r\n            title=\"Danh s√°ch kh√°ch h√†ng c√≥ n·ª£\"\r\n            extra={\r\n              <Button\r\n                type=\"primary\"\r\n                icon={<PlusOutlined />}\r\n                onClick={() => {\r\n                  setModalType('payment');\r\n                  setActiveTab('customers');\r\n                  setModalVisible(true);\r\n                  // üÜï Reset form v·ªõi values m·∫∑c ƒë·ªãnh\r\n                  form.setFieldsValue({\r\n                    payment_method: 'cash',\r\n                    transaction_date: dayjs(),\r\n                    entity_id: undefined,\r\n                    amount: undefined,\r\n                    description: ''\r\n                  });\r\n                }}\r\n              >\r\n                Ghi nh·∫≠n thanh to√°n\r\n              </Button>\r\n            }\r\n          >\r\n            <Table\r\n              columns={customerColumns}\r\n              dataSource={customerDebts}\r\n              loading={loading}\r\n              rowKey=\"id\"\r\n              pagination={{\r\n                showSizeChanger: true,\r\n                showQuickJumper: true,\r\n                showTotal: (total, range) =>\r\n                  `${range[0]}-${range[1]} c·ªßa ${total} kh√°ch h√†ng`,\r\n              }}\r\n            />\r\n          </Card>\r\n        </TabPane>\r\n\r\n        <TabPane\r\n          tab={\r\n            <span>\r\n              <ShopOutlined />\r\n              N·ª£ nh√† cung c·∫•p ({supplierDebts.length})\r\n            </span>\r\n          }\r\n          key=\"suppliers\"\r\n        >\r\n          <Card\r\n            title=\"Danh s√°ch nh√† cung c·∫•p c√≥ n·ª£\"\r\n            extra={\r\n              <Button\r\n                type=\"primary\"\r\n                icon={<PlusOutlined />}\r\n                onClick={() => {\r\n                  setModalType('payment');\r\n                  setActiveTab('suppliers');\r\n                  setModalVisible(true);\r\n                  // üÜï Reset form v·ªõi values m·∫∑c ƒë·ªãnh\r\n                  form.setFieldsValue({\r\n                    payment_method: 'cash',\r\n                    transaction_date: dayjs(),\r\n                    entity_id: undefined,\r\n                    amount: undefined,\r\n                    description: ''\r\n                  });\r\n                }}\r\n              >\r\n                Ghi nh·∫≠n thanh to√°n\r\n              </Button>\r\n            }\r\n          >\r\n            <Table\r\n              columns={supplierColumns}\r\n              dataSource={supplierDebts}\r\n              loading={loading}\r\n              rowKey=\"id\"\r\n              pagination={{\r\n                showSizeChanger: true,\r\n                showQuickJumper: true,\r\n                showTotal: (total, range) =>\r\n                  `${range[0]}-${range[1]} c·ªßa ${total} nh√† cung c·∫•p`,\r\n              }}\r\n            />\r\n          </Card>\r\n        </TabPane>\r\n      </Tabs>\r\n\r\n      {/* üÜï Enhanced Modal with Ant Design Form */}\r\n      <Modal\r\n        title={\r\n          <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\r\n            <DollarOutlined style={{ color: '#52c41a' }} />\r\n            <span>Ghi nh·∫≠n thanh to√°n {activeTab === 'customers' ? 'n·ª£ kh√°ch h√†ng' : 'n·ª£ nh√† cung c·∫•p'}</span>\r\n          </div>\r\n        }\r\n        open={modalVisible}\r\n        onCancel={handleModalClose}\r\n        footer={null}\r\n        width={700}\r\n        destroyOnClose={true}\r\n      >\r\n        <Form\r\n          form={form}\r\n          layout=\"vertical\"\r\n          onFinish={handlePayDebt}\r\n          initialValues={{\r\n            payment_method: 'cash',\r\n            transaction_date: dayjs(),\r\n          }}\r\n        >\r\n          <Form.Item\r\n            label={`${activeTab === 'customers' ? 'Kh√°ch h√†ng' : 'Nh√† cung c·∫•p'}`}\r\n            name=\"entity_id\"\r\n            rules={[\r\n              { required: true, message: `Vui l√≤ng ch·ªçn ${activeTab === 'customers' ? 'kh√°ch h√†ng' : 'nh√† cung c·∫•p'}` }\r\n            ]}\r\n          >\r\n            <Select\r\n              placeholder={`Ch·ªçn ${activeTab === 'customers' ? 'kh√°ch h√†ng' : 'nh√† cung c·∫•p'}`}\r\n              style={{ width: '100%' }}\r\n              showSearch\r\n              filterOption={(input, option) => {\r\n                const children = typeof option.children === 'string' ? option.children : '';\r\n                return children.toLowerCase().indexOf(input.toLowerCase()) >= 0;\r\n              }}\r\n              size=\"large\"\r\n            >\r\n              {(() => {\r\n                const entities = activeTab === 'customers' ? customers : suppliers;\r\n                console.log(`üîç Rendering dropdown for ${activeTab}:`, entities);\r\n                console.log(`üìã Total entities to render: ${entities.length}`);\r\n                \r\n                return entities && entities.length > 0 ? entities.map((entity) => {\r\n                  // üõ°Ô∏è Safety check ƒë·ªÉ tr√°nh undefined\r\n                  if (!entity || !entity.id || !entity.name) {\r\n                    console.warn('‚ö†Ô∏è Invalid entity found:', entity);\r\n                    return null;\r\n                  }\r\n                  \r\n                  return (\r\n                    <Option key={entity.id} value={entity.id}>\r\n                      <div>\r\n                        <div style={{ fontWeight: 'bold' }}>{entity.name}</div>\r\n                        {entity.phone && (\r\n                          <Text type=\"secondary\" style={{ fontSize: 12 }}>\r\n                            üìû {entity.phone}\r\n                          </Text>\r\n                        )}\r\n                        <div>\r\n                          <Text type=\"secondary\" style={{ fontSize: 12, color: '#ff4d4f' }}>\r\n                            üí∞ N·ª£ hi·ªán t·∫°i: {(entity.current_debt || 0).toLocaleString('vi-VN')} ‚Ç´\r\n                          </Text>\r\n                        </div>\r\n                      </div>\r\n                    </Option>\r\n                  );\r\n                }).filter(Boolean) : []; // Filter out null entries\r\n              })()}\r\n            </Select>\r\n          </Form.Item>\r\n\r\n          <Row gutter={16}>\r\n            <Col span={12}>\r\n              <Form.Item\r\n                label=\"S·ªë ti·ªÅn thanh to√°n\"\r\n                name=\"amount\"\r\n                rules={[\r\n                  { required: true, message: 'Vui l√≤ng nh·∫≠p s·ªë ti·ªÅn' },\r\n                  { type: 'number', min: 1, message: 'S·ªë ti·ªÅn ph·∫£i l·ªõn h∆°n 0' }\r\n                ]}\r\n              >\r\n                <InputNumber\r\n                  placeholder=\"Nh·∫≠p s·ªë ti·ªÅn\"\r\n                  style={{ width: '100%' }}\r\n                  formatter={(value) => `${value}`.replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',')}\r\n                  parser={(value) => value ? value.replace(/\\$\\s?|(,*)/g, '') : ''}\r\n                  min={0}\r\n                  size=\"large\"\r\n                  addonAfter=\"‚Ç´\"\r\n                />\r\n              </Form.Item>\r\n            </Col>\r\n            <Col span={12}>\r\n              <Form.Item\r\n                label=\"Ph∆∞∆°ng th·ª©c thanh to√°n\"\r\n                name=\"payment_method\"\r\n                rules={[{ required: true, message: 'Vui l√≤ng ch·ªçn ph∆∞∆°ng th·ª©c thanh to√°n' }]}\r\n              >\r\n                <Select\r\n                  placeholder=\"Ch·ªçn ph∆∞∆°ng th·ª©c\"\r\n                  style={{ width: '100%' }}\r\n                  size=\"large\"\r\n                >\r\n                  {paymentMethods.map((method) => (\r\n                    <Option key={method.value} value={method.value}>\r\n                      <Space>\r\n                        {method.icon}\r\n                        {method.label}\r\n                      </Space>\r\n                    </Option>\r\n                  ))}\r\n                </Select>\r\n              </Form.Item>\r\n            </Col>\r\n          </Row>\r\n\r\n          <Form.Item\r\n            label=\"M√¥ t·∫£\"\r\n            name=\"description\"\r\n          >\r\n            <Input.TextArea\r\n              placeholder=\"Nh·∫≠p m√¥ t·∫£ thanh to√°n (t√πy ch·ªçn)\"\r\n              rows={3}\r\n              showCount\r\n              maxLength={500}\r\n            />\r\n          </Form.Item>\r\n\r\n          <Form.Item\r\n            label=\"Ng√†y thanh to√°n\"\r\n            name=\"transaction_date\"\r\n            rules={[{ required: true, message: 'Vui l√≤ng ch·ªçn ng√†y thanh to√°n' }]}\r\n          >\r\n            <DatePicker\r\n              style={{ width: '100%' }}\r\n              size=\"large\"\r\n              format=\"DD/MM/YYYY\"\r\n              placeholder=\"Ch·ªçn ng√†y thanh to√°n\"\r\n            />\r\n          </Form.Item>\r\n\r\n          <Form.Item style={{ textAlign: 'right', marginTop: 24, marginBottom: 0 }}>\r\n            <Space>\r\n              <Button onClick={handleModalClose} size=\"large\">\r\n                H·ªßy\r\n              </Button>\r\n              <Button\r\n                type=\"primary\"\r\n                htmlType=\"submit\"\r\n                loading={submitting}\r\n                icon={<DollarOutlined />}\r\n                size=\"large\"\r\n              >\r\n                Ghi nh·∫≠n thanh to√°n\r\n              </Button>\r\n            </Space>\r\n          </Form.Item>\r\n        </Form>\r\n      </Modal>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DebtPage; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}