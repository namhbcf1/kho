{"ast":null,"code":"import _objectSpread from\"C:/Users/ADMIN/Desktop/kho/kho/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{message}from'antd';import{Card,Table,Button,Modal,Input,Select,DatePicker,Space,Tag,Row,Col,Statistic,Tabs,InputNumber,Alert,Badge,Typography,Form}from'antd';import{PlusOutlined,UserOutlined,ShopOutlined,DollarOutlined,ExclamationCircleOutlined,CheckCircleOutlined,CreditCardOutlined,WalletOutlined}from'@ant-design/icons';import{customersAPI,suppliersAPI,financialAPI}from'../services/api';import dayjs from'dayjs';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const{Option}=Select;const{TabPane}=Tabs;const{Text}=Typography;const DebtPage=()=>{const[customerDebts,setCustomerDebts]=useState([]);const[supplierDebts,setSupplierDebts]=useState([]);const[customers,setCustomers]=useState([]);const[suppliers,setSuppliers]=useState([]);const[loading,setLoading]=useState(false);const[modalVisible,setModalVisible]=useState(false);const[activeTab,setActiveTab]=useState('customers');const[modalType,setModalType]=useState('payment');// 'payment' or 'debt'\nconst[submitting,setSubmitting]=useState(false);const[debtStats,setDebtStats]=useState({totalCustomerDebt:0,totalSupplierDebt:0,overduCustomerDebt:0,overdueSupplierDebt:0});const[supplierTransactions,setSupplierTransactions]=useState([]);// üÜï Ant Design Form instance\nconst[form]=Form.useForm();const paymentMethods=[{value:'cash',label:'Ti·ªÅn m·∫∑t',icon:/*#__PURE__*/_jsx(DollarOutlined,{})},{value:'card',label:'Th·∫ª',icon:/*#__PURE__*/_jsx(CreditCardOutlined,{})},{value:'transfer',label:'Chuy·ªÉn kho·∫£n',icon:/*#__PURE__*/_jsx(WalletOutlined,{})},{value:'ewallet',label:'V√≠ ƒëi·ªán t·ª≠',icon:/*#__PURE__*/_jsx(WalletOutlined,{})}];useEffect(()=>{console.log('üöÄ DebtPage mounted, fetching data...');fetchData();},[]);useEffect(()=>{console.log('üîÑ Customers state updated:',customers);},[customers]);useEffect(()=>{console.log('üîÑ Suppliers state updated:',suppliers);},[suppliers]);// Process debts when customers/suppliers data changes\nuseEffect(()=>{if(customers.length>0){fetchCustomerDebts();}},[customers]);// eslint-disable-line react-hooks/exhaustive-deps\nuseEffect(()=>{if(suppliers.length>0){fetchSupplierDebts();}},[suppliers]);// eslint-disable-line react-hooks/exhaustive-deps\n// Fetch supplier transactions for history\nuseEffect(()=>{if(activeTab==='suppliers'){fetchSupplierTransactions();}},[activeTab]);const fetchData=async()=>{setLoading(true);try{// First fetch all customers and suppliers\nawait Promise.all([fetchCustomers(),fetchSuppliers()]);// Then process debts (this will be done in useEffect when customers/suppliers change)\n}catch(error){message.error('L·ªói khi t·∫£i d·ªØ li·ªáu');}finally{setLoading(false);}};const fetchCustomerDebts=async()=>{try{// Use customers data that's already fetched and enhanced\nconst customersWithDebt=customers.filter(c=>(c.current_debt||0)>0);setCustomerDebts(customersWithDebt);// Calculate debt stats\nconst totalDebt=customersWithDebt.reduce((sum,c)=>sum+(c.current_debt||0),0);setDebtStats(prev=>_objectSpread(_objectSpread({},prev),{},{totalCustomerDebt:totalDebt}));}catch(error){console.error('Error processing customer debts:',error);setCustomerDebts([]);}};const fetchSupplierDebts=async()=>{try{// Use suppliers data that's already fetched and enhanced\nconst suppliersWithDebt=suppliers.filter(s=>(s.current_debt||0)>0);setSupplierDebts(suppliersWithDebt);// Calculate debt stats\nconst totalDebt=suppliersWithDebt.reduce((sum,s)=>sum+(s.current_debt||0),0);setDebtStats(prev=>_objectSpread(_objectSpread({},prev),{},{totalSupplierDebt:totalDebt}));}catch(error){console.error('Error processing supplier debts:',error);setSupplierDebts([]);}};const fetchSupplierTransactions=async()=>{try{const response=await financialAPI.getTransactions({type:'expense',category:'Tr·∫£ n·ª£ nh√† cung c·∫•p',limit:10});if(response.data.success){setSupplierTransactions(response.data.data||[]);}else{setSupplierTransactions([]);}}catch(error){setSupplierTransactions([]);}};const fetchCustomers=async()=>{try{const response=await customersAPI.getAll();console.log('üë• Raw customers response:',response.data);if(response.data.success){// Kh√¥ng c√≤n mock, ch·ªâ l·∫•y s·ªë n·ª£ th·∫≠t t·ª´ API\nconst customersWithDebt=response.data.data.map(customer=>_objectSpread(_objectSpread({},customer),{},{current_debt:customer.current_debt||0,total_spent:customer.total_spent||0}));console.log('üí∞ Customers with debt:',customersWithDebt);console.log('üìä Total customers for dropdown:',customersWithDebt.length);setCustomers(customersWithDebt);}}catch(error){console.error('Error fetching customers:',error);// Fallback: Set empty array to avoid crashes\nsetCustomers([]);}};const fetchSuppliers=async()=>{try{const response=await suppliersAPI.getAll();console.log('üè≠ Raw suppliers response:',response.data);if(response.data.success){// Kh√¥ng c√≤n mock, ch·ªâ l·∫•y s·ªë n·ª£ th·∫≠t t·ª´ API\nconst suppliersWithDebt=response.data.data.map(supplier=>_objectSpread(_objectSpread({},supplier),{},{current_debt:supplier.current_debt||0,total_purchases:supplier.total_purchases||0}));console.log('üí∞ Suppliers with debt:',suppliersWithDebt);console.log('üìä Total suppliers for dropdown:',suppliersWithDebt.length);setSuppliers(suppliersWithDebt);}}catch(error){console.error('Error fetching suppliers:',error);// Fallback: Set empty array to avoid crashes\nsetSuppliers([]);}};// üÜï Enhanced form submission with proper error handling\nconst handlePayDebt=async values=>{try{var _values$transaction_d;setSubmitting(true);console.log('üí∞ Submitting payment data:',values);const transactionData={type:activeTab==='customers'?'income':'expense',category:activeTab==='customers'?'Thu n·ª£ kh√°ch h√†ng':'Tr·∫£ n·ª£ nh√† cung c·∫•p',amount:values.amount,description:values.description||\"Thanh to\\xE1n n\\u1EE3 \".concat(activeTab==='customers'?'kh√°ch h√†ng':'nh√† cung c·∫•p'),customer_id:activeTab==='customers'?values.entity_id:null,supplier_id:activeTab==='suppliers'?values.entity_id:null,payment_method:values.payment_method,transaction_date:((_values$transaction_d=values.transaction_date)===null||_values$transaction_d===void 0?void 0:_values$transaction_d.toISOString())||new Date().toISOString(),user_id:1};console.log('üì§ Transaction data to send:',transactionData);const response=await financialAPI.create(transactionData);if(response.data.success){message.success('Ghi nh·∫≠n thanh to√°n th√†nh c√¥ng!');setModalVisible(false);form.resetFields();fetchData();}else{throw new Error(response.data.message||'L·ªói kh√¥ng x√°c ƒë·ªãnh');}}catch(error){console.error('‚ùå Payment submission error:',error);message.error(error.message||'L·ªói khi ghi nh·∫≠n thanh to√°n');}finally{setSubmitting(false);}};// üÜï Enhanced modal close handler\nconst handleModalClose=()=>{setModalVisible(false);form.resetFields();setSubmitting(false);};const customerColumns=[{title:'M√£ KH',dataIndex:'code',key:'code',width:100},{title:'T√™n kh√°ch h√†ng',dataIndex:'name',key:'name',render:(name,record)=>/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{children:name}),record.phone&&/*#__PURE__*/_jsx(Text,{type:\"secondary\",style:{fontSize:12},children:record.phone})]})},{title:'Lo·∫°i KH',dataIndex:'customer_type',key:'customer_type',render:type=>{const colors={regular:'default',vip:'gold',wholesale:'blue'};const labels={regular:'Th∆∞·ªùng',vip:'VIP',wholesale:'S·ªâ'};return/*#__PURE__*/_jsx(Tag,{color:colors[type],children:labels[type]});}},{title:'S·ªë n·ª£',dataIndex:'current_debt',key:'current_debt',render:debt=>/*#__PURE__*/_jsxs(Text,{strong:true,style:{color:debt>0?'#ff4d4f':'#52c41a'},children:[debt.toLocaleString('vi-VN'),\" \\u20AB\"]}),sorter:(a,b)=>a.current_debt-b.current_debt},{title:'T·ªïng chi ti√™u',dataIndex:'total_spent',key:'total_spent',render:spent=>/*#__PURE__*/_jsxs(Text,{type:\"secondary\",children:[spent?spent.toLocaleString('vi-VN'):0,\" \\u20AB\"]})},{title:'Tr·∫°ng th√°i',key:'status',render:(_,record)=>{const debt=record.current_debt||0;if(debt===0){return/*#__PURE__*/_jsx(Badge,{status:\"success\",text:\"\\u0110\\xE3 thanh to\\xE1n\"});}else if(debt>1000000){return/*#__PURE__*/_jsx(Badge,{status:\"error\",text:\"N\\u1EE3 l\\u1EDBn\"});}else{return/*#__PURE__*/_jsx(Badge,{status:\"warning\",text:\"C\\xF3 n\\u1EE3\"});}}},{title:'Thao t√°c',key:'actions',render:(_,record)=>/*#__PURE__*/_jsx(Space,{children:/*#__PURE__*/_jsx(Button,{type:\"primary\",size:\"small\",icon:/*#__PURE__*/_jsx(DollarOutlined,{}),onClick:()=>{setModalType('payment');setActiveTab('customers');setModalVisible(true);// üÜï Set form values v·ªõi Ant Design Form\nform.setFieldsValue({entity_id:record.id,payment_method:'cash',transaction_date:dayjs(),amount:record.current_debt||0,description:\"Thanh to\\xE1n n\\u1EE3 kh\\xE1ch h\\xE0ng \".concat(record.name)});},children:\"Thanh to\\xE1n\"})})}];const supplierColumns=[{title:'M√£ NCC',dataIndex:'code',key:'code',width:100},{title:'T√™n nh√† cung c·∫•p',dataIndex:'name',key:'name',render:(name,record)=>/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{children:name}),record.phone&&/*#__PURE__*/_jsx(Text,{type:\"secondary\",style:{fontSize:12},children:record.phone})]})},{title:'ƒê·ªãa ch·ªâ',dataIndex:'address',key:'address',ellipsis:true},{title:'S·ªë n·ª£',dataIndex:'current_debt',key:'current_debt',render:debt=>/*#__PURE__*/_jsxs(Text,{strong:true,style:{color:debt>0?'#ff4d4f':'#52c41a'},children:[debt.toLocaleString('vi-VN'),\" \\u20AB\"]}),sorter:(a,b)=>a.current_debt-b.current_debt},{title:'Tr·∫°ng th√°i',key:'status',render:(_,record)=>{const debt=record.current_debt||0;if(debt===0){return/*#__PURE__*/_jsx(Badge,{status:\"success\",text:\"\\u0110\\xE3 thanh to\\xE1n\"});}else if(debt>5000000){return/*#__PURE__*/_jsx(Badge,{status:\"error\",text:\"N\\u1EE3 l\\u1EDBn\"});}else{return/*#__PURE__*/_jsx(Badge,{status:\"warning\",text:\"C\\xF3 n\\u1EE3\"});}}},{title:'Thao t√°c',key:'actions',render:(_,record)=>/*#__PURE__*/_jsx(Space,{children:/*#__PURE__*/_jsx(Button,{type:\"primary\",size:\"small\",icon:/*#__PURE__*/_jsx(DollarOutlined,{}),onClick:()=>{setModalType('payment');setActiveTab('suppliers');setModalVisible(true);// üÜï Set form values v·ªõi Ant Design Form\nform.setFieldsValue({entity_id:record.id,payment_method:'cash',transaction_date:dayjs(),amount:record.current_debt||0,description:\"Thanh to\\xE1n n\\u1EE3 nh\\xE0 cung c\\u1EA5p \".concat(record.name)});},children:\"Thanh to\\xE1n\"})})}];// Table columns for supplier transaction history\nconst supplierHistoryColumns=[{title:'Ng√†y giao d·ªãch',dataIndex:'transaction_date',key:'transaction_date',render:date=>date?new Date(date).toLocaleString('vi-VN',{timeZone:'Asia/Ho_Chi_Minh'}):'',width:140},{title:'S·ªë ti·ªÅn',dataIndex:'amount',key:'amount',render:amount=>/*#__PURE__*/_jsxs(\"span\",{style:{color:'#cf1322',fontWeight:500},children:[\"- \",amount.toLocaleString('vi-VN'),\" \\u20AB\"]}),width:120},{title:'M√¥ t·∫£',dataIndex:'description',key:'description',render:desc=>desc||'Thanh to√°n n·ª£ nh√† cung c·∫•p'}];const renderDebtSummary=()=>{return/*#__PURE__*/_jsxs(Row,{gutter:16,style:{marginBottom:24},children:[/*#__PURE__*/_jsx(Col,{span:6,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(Statistic,{title:\"T\\u1ED5ng kh\\xE1ch h\\xE0ng n\\u1EE3\",value:customerDebts.length,valueStyle:{color:'#52c41a'},prefix:/*#__PURE__*/_jsx(UserOutlined,{})})})}),/*#__PURE__*/_jsx(Col,{span:6,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(Statistic,{title:\"T\\u1ED5ng n\\u1EE3 nh\\xE0 cung c\\u1EA5p\",value:debtStats.totalSupplierDebt,precision:0,valueStyle:{color:'#cf1322'},prefix:/*#__PURE__*/_jsx(ShopOutlined,{}),suffix:\"\\u20AB\"})})}),/*#__PURE__*/_jsx(Col,{span:6,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(Statistic,{title:\"T\\u1ED5ng n\\u1EE3 ph\\u1EA3i thu\",value:debtStats.totalCustomerDebt+debtStats.totalSupplierDebt,precision:0,valueStyle:{color:'#1890ff'},prefix:/*#__PURE__*/_jsx(DollarOutlined,{}),suffix:\"\\u20AB\"})})})]});};return/*#__PURE__*/_jsxs(\"div\",{style:{padding:24},children:[renderDebtSummary(),/*#__PURE__*/_jsx(Alert,{message:\"Qu\\u1EA3n l\\xFD n\\u1EE3\",description:\"Theo d\\xF5i v\\xE0 qu\\u1EA3n l\\xFD c\\xE1c kho\\u1EA3n n\\u1EE3 c\\u1EE7a kh\\xE1ch h\\xE0ng v\\xE0 nh\\xE0 cung c\\u1EA5p. H\\u1EC7 th\\u1ED1ng s\\u1EBD t\\u1EF1 \\u0111\\u1ED9ng c\\u1EADp nh\\u1EADt s\\u1ED1 d\\u01B0 n\\u1EE3 khi c\\xF3 giao d\\u1ECBch thanh to\\xE1n.\",type:\"info\",showIcon:true,style:{marginBottom:24}}),/*#__PURE__*/_jsxs(Tabs,{activeKey:activeTab,onChange:setActiveTab,children:[/*#__PURE__*/_jsx(TabPane,{tab:/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(UserOutlined,{}),\"N\\u1EE3 kh\\xE1ch h\\xE0ng (\",customerDebts.length,\")\"]}),children:/*#__PURE__*/_jsx(Card,{title:\"Danh s\\xE1ch kh\\xE1ch h\\xE0ng c\\xF3 n\\u1EE3\",extra:/*#__PURE__*/_jsx(Button,{type:\"primary\",icon:/*#__PURE__*/_jsx(PlusOutlined,{}),onClick:()=>{setModalType('payment');setActiveTab('customers');setModalVisible(true);// üÜï Reset form v·ªõi values m·∫∑c ƒë·ªãnh\nform.setFieldsValue({payment_method:'cash',transaction_date:dayjs(),entity_id:undefined,amount:undefined,description:''});},children:\"Ghi nh\\u1EADn thanh to\\xE1n\"}),children:/*#__PURE__*/_jsx(Table,{columns:customerColumns,dataSource:customerDebts,loading:loading,rowKey:\"id\",pagination:{showSizeChanger:true,showQuickJumper:true,showTotal:(total,range)=>\"\".concat(range[0],\"-\").concat(range[1],\" c\\u1EE7a \").concat(total,\" kh\\xE1ch h\\xE0ng\")}})})},\"customers\"),/*#__PURE__*/_jsx(TabPane,{tab:/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(ShopOutlined,{}),\"N\\u1EE3 nh\\xE0 cung c\\u1EA5p (\",supplierDebts.length,\")\"]}),children:/*#__PURE__*/_jsxs(Row,{gutter:24,children:[/*#__PURE__*/_jsx(Col,{span:15,children:/*#__PURE__*/_jsx(Card,{title:\"Danh s\\xE1ch nh\\xE0 cung c\\u1EA5p c\\xF3 n\\u1EE3\",extra:/*#__PURE__*/_jsx(Button,{type:\"primary\",icon:/*#__PURE__*/_jsx(PlusOutlined,{}),onClick:()=>{setModalType('payment');setActiveTab('suppliers');setModalVisible(true);// üÜï Reset form v·ªõi values m·∫∑c ƒë·ªãnh\nform.setFieldsValue({payment_method:'cash',transaction_date:dayjs(),entity_id:undefined,amount:undefined,description:''});},children:\"Ghi nh\\u1EADn thanh to\\xE1n\"}),children:/*#__PURE__*/_jsx(Table,{columns:supplierColumns,dataSource:supplierDebts,loading:loading,rowKey:\"id\",pagination:{showSizeChanger:true,showQuickJumper:true,showTotal:(total,range)=>\"\".concat(range[0],\"-\").concat(range[1],\" c\\u1EE7a \").concat(total,\" nh\\xE0 cung c\\u1EA5p\")}})})}),/*#__PURE__*/_jsx(Col,{span:9,children:/*#__PURE__*/_jsx(Card,{title:\"L\\u1ECBch s\\u1EED thanh to\\xE1n n\\u1EE3 nh\\xE0 cung c\\u1EA5p\",bordered:true,style:{minHeight:400},children:/*#__PURE__*/_jsx(Table,{columns:supplierHistoryColumns,dataSource:supplierTransactions,rowKey:\"id\",size:\"small\",pagination:{pageSize:8},locale:{emptyText:'Ch∆∞a c√≥ giao d·ªãch'}})})})]})},\"suppliers\")]}),/*#__PURE__*/_jsx(Modal,{title:/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',alignItems:'center',gap:'8px'},children:[/*#__PURE__*/_jsx(DollarOutlined,{style:{color:'#52c41a'}}),/*#__PURE__*/_jsxs(\"span\",{children:[\"Ghi nh\\u1EADn thanh to\\xE1n \",activeTab==='customers'?'n·ª£ kh√°ch h√†ng':'n·ª£ nh√† cung c·∫•p']})]}),open:modalVisible,onCancel:handleModalClose,footer:null,width:700,destroyOnClose:true,children:/*#__PURE__*/_jsxs(Form,{form:form,layout:\"vertical\",onFinish:handlePayDebt,initialValues:{payment_method:'cash',transaction_date:dayjs()},children:[/*#__PURE__*/_jsx(Form.Item,{label:\"\".concat(activeTab==='customers'?'Kh√°ch h√†ng':'Nh√† cung c·∫•p'),name:\"entity_id\",rules:[{required:true,message:\"Vui l\\xF2ng ch\\u1ECDn \".concat(activeTab==='customers'?'kh√°ch h√†ng':'nh√† cung c·∫•p')}],children:/*#__PURE__*/_jsx(Select,{placeholder:\"Ch\\u1ECDn \".concat(activeTab==='customers'?'kh√°ch h√†ng':'nh√† cung c·∫•p'),style:{width:'100%'},showSearch:true,filterOption:(input,option)=>{const children=typeof option.children==='string'?option.children:'';return children.toLowerCase().indexOf(input.toLowerCase())>=0;},size:\"large\",children:(()=>{const entities=activeTab==='customers'?customers:suppliers;console.log(\"\\uD83D\\uDD0D Rendering dropdown for \".concat(activeTab,\":\"),entities);console.log(\"\\uD83D\\uDCCB Total entities to render: \".concat(entities.length));return entities&&entities.length>0?entities.map(entity=>{// üõ°Ô∏è Safety check ƒë·ªÉ tr√°nh undefined\nif(!entity||!entity.id||!entity.name){console.warn('‚ö†Ô∏è Invalid entity found:',entity);return null;}return/*#__PURE__*/_jsx(Option,{value:entity.id,children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"div\",{style:{fontWeight:'bold'},children:entity.name}),entity.phone&&/*#__PURE__*/_jsxs(Text,{type:\"secondary\",style:{fontSize:12},children:[\"\\uD83D\\uDCDE \",entity.phone]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Text,{type:\"secondary\",style:{fontSize:12,color:'#ff4d4f'},children:[\"\\uD83D\\uDCB0 N\\u1EE3 hi\\u1EC7n t\\u1EA1i: \",(entity.current_debt||0).toLocaleString('vi-VN'),\" \\u20AB\"]})})]})},entity.id);}).filter(Boolean):[];// Filter out null entries\n})()})}),/*#__PURE__*/_jsxs(Row,{gutter:16,children:[/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:\"S\\u1ED1 ti\\u1EC1n thanh to\\xE1n\",name:\"amount\",rules:[{required:true,message:'Vui l√≤ng nh·∫≠p s·ªë ti·ªÅn'},{type:'number',min:1,message:'S·ªë ti·ªÅn ph·∫£i l·ªõn h∆°n 0'}],children:/*#__PURE__*/_jsx(InputNumber,{placeholder:\"Nh\\u1EADp s\\u1ED1 ti\\u1EC1n\",style:{width:'100%'},formatter:value=>\"\".concat(value).replace(/\\B(?=(\\d{3})+(?!\\d))/g,','),parser:value=>value?value.replace(/\\$\\s?|(,*)/g,''):'',min:0,size:\"large\",addonAfter:\"\\u20AB\"})})}),/*#__PURE__*/_jsx(Col,{span:12,children:/*#__PURE__*/_jsx(Form.Item,{label:\"Ph\\u01B0\\u01A1ng th\\u1EE9c thanh to\\xE1n\",name:\"payment_method\",rules:[{required:true,message:'Vui l√≤ng ch·ªçn ph∆∞∆°ng th·ª©c thanh to√°n'}],children:/*#__PURE__*/_jsx(Select,{placeholder:\"Ch\\u1ECDn ph\\u01B0\\u01A1ng th\\u1EE9c\",style:{width:'100%'},size:\"large\",children:paymentMethods.map(method=>/*#__PURE__*/_jsx(Option,{value:method.value,children:/*#__PURE__*/_jsxs(Space,{children:[method.icon,method.label]})},method.value))})})})]}),/*#__PURE__*/_jsx(Form.Item,{label:\"M\\xF4 t\\u1EA3\",name:\"description\",children:/*#__PURE__*/_jsx(Input.TextArea,{placeholder:\"Nh\\u1EADp m\\xF4 t\\u1EA3 thanh to\\xE1n (t\\xF9y ch\\u1ECDn)\",rows:3,showCount:true,maxLength:500})}),/*#__PURE__*/_jsx(Form.Item,{label:\"Ng\\xE0y thanh to\\xE1n\",name:\"transaction_date\",rules:[{required:true,message:'Vui l√≤ng ch·ªçn ng√†y thanh to√°n'}],children:/*#__PURE__*/_jsx(DatePicker,{style:{width:'100%'},size:\"large\",format:\"DD/MM/YYYY\",placeholder:\"Ch\\u1ECDn ng\\xE0y thanh to\\xE1n\"})}),/*#__PURE__*/_jsx(Form.Item,{style:{textAlign:'right',marginTop:24,marginBottom:0},children:/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsx(Button,{onClick:handleModalClose,size:\"large\",children:\"H\\u1EE7y\"}),/*#__PURE__*/_jsx(Button,{type:\"primary\",htmlType:\"submit\",loading:submitting,icon:/*#__PURE__*/_jsx(DollarOutlined,{}),size:\"large\",children:\"Ghi nh\\u1EADn thanh to\\xE1n\"})]})})]})})]});};export default DebtPage;","map":{"version":3,"names":["React","useState","useEffect","message","Card","Table","Button","Modal","Input","Select","DatePicker","Space","Tag","Row","Col","Statistic","Tabs","InputNumber","Alert","Badge","Typography","Form","PlusOutlined","UserOutlined","ShopOutlined","DollarOutlined","ExclamationCircleOutlined","CheckCircleOutlined","CreditCardOutlined","WalletOutlined","customersAPI","suppliersAPI","financialAPI","dayjs","jsx","_jsx","jsxs","_jsxs","Option","TabPane","Text","DebtPage","customerDebts","setCustomerDebts","supplierDebts","setSupplierDebts","customers","setCustomers","suppliers","setSuppliers","loading","setLoading","modalVisible","setModalVisible","activeTab","setActiveTab","modalType","setModalType","submitting","setSubmitting","debtStats","setDebtStats","totalCustomerDebt","totalSupplierDebt","overduCustomerDebt","overdueSupplierDebt","supplierTransactions","setSupplierTransactions","form","useForm","paymentMethods","value","label","icon","console","log","fetchData","length","fetchCustomerDebts","fetchSupplierDebts","fetchSupplierTransactions","Promise","all","fetchCustomers","fetchSuppliers","error","customersWithDebt","filter","c","current_debt","totalDebt","reduce","sum","prev","_objectSpread","suppliersWithDebt","s","response","getTransactions","type","category","limit","data","success","getAll","map","customer","total_spent","supplier","total_purchases","handlePayDebt","values","_values$transaction_d","transactionData","amount","description","concat","customer_id","entity_id","supplier_id","payment_method","transaction_date","toISOString","Date","user_id","create","resetFields","Error","handleModalClose","customerColumns","title","dataIndex","key","width","render","name","record","children","phone","style","fontSize","colors","regular","vip","wholesale","labels","color","debt","strong","toLocaleString","sorter","a","b","spent","_","status","text","size","onClick","setFieldsValue","id","supplierColumns","ellipsis","supplierHistoryColumns","date","timeZone","fontWeight","desc","renderDebtSummary","gutter","marginBottom","span","valueStyle","prefix","precision","suffix","padding","showIcon","activeKey","onChange","tab","extra","undefined","columns","dataSource","rowKey","pagination","showSizeChanger","showQuickJumper","showTotal","total","range","bordered","minHeight","pageSize","locale","emptyText","display","alignItems","gap","open","onCancel","footer","destroyOnClose","layout","onFinish","initialValues","Item","rules","required","placeholder","showSearch","filterOption","input","option","toLowerCase","indexOf","entities","entity","warn","Boolean","min","formatter","replace","parser","addonAfter","method","TextArea","rows","showCount","maxLength","format","textAlign","marginTop","htmlType"],"sources":["C:/Users/ADMIN/Desktop/kho/kho/client/src/pages/DebtPage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { message } from 'antd';\r\nimport {\r\n  Card,\r\n  Table,\r\n  Button,\r\n  Modal,\r\n  Input,\r\n  Select,\r\n  DatePicker,\r\n  Space,\r\n  Tag,\r\n  Row,\r\n  Col,\r\n  Statistic,\r\n  Tabs,\r\n  InputNumber,\r\n  Alert,\r\n  Badge,\r\n  Typography,\r\n  Form,\r\n} from 'antd';\r\nimport {\r\n  PlusOutlined,\r\n  UserOutlined,\r\n  ShopOutlined,\r\n  DollarOutlined,\r\n  ExclamationCircleOutlined,\r\n  CheckCircleOutlined,\r\n  CreditCardOutlined,\r\n  WalletOutlined,\r\n} from '@ant-design/icons';\r\nimport { customersAPI, suppliersAPI, financialAPI } from '../services/api';\r\nimport dayjs from 'dayjs';\r\n\r\nconst { Option } = Select;\r\nconst { TabPane } = Tabs;\r\nconst { Text } = Typography;\r\n\r\nconst DebtPage = () => {\r\n  const [customerDebts, setCustomerDebts] = useState([]);\r\n  const [supplierDebts, setSupplierDebts] = useState([]);\r\n  const [customers, setCustomers] = useState([]);\r\n  const [suppliers, setSuppliers] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [modalVisible, setModalVisible] = useState(false);\r\n  const [activeTab, setActiveTab] = useState('customers');\r\n  const [modalType, setModalType] = useState('payment'); // 'payment' or 'debt'\r\n  const [submitting, setSubmitting] = useState(false);\r\n  const [debtStats, setDebtStats] = useState({\r\n    totalCustomerDebt: 0,\r\n    totalSupplierDebt: 0,\r\n    overduCustomerDebt: 0,\r\n    overdueSupplierDebt: 0,\r\n  });\r\n  const [supplierTransactions, setSupplierTransactions] = useState([]);\r\n\r\n  // üÜï Ant Design Form instance\r\n  const [form] = Form.useForm();\r\n\r\n  const paymentMethods = [\r\n    { value: 'cash', label: 'Ti·ªÅn m·∫∑t', icon: <DollarOutlined /> },\r\n    { value: 'card', label: 'Th·∫ª', icon: <CreditCardOutlined /> },\r\n    { value: 'transfer', label: 'Chuy·ªÉn kho·∫£n', icon: <WalletOutlined /> },\r\n    { value: 'ewallet', label: 'V√≠ ƒëi·ªán t·ª≠', icon: <WalletOutlined /> },\r\n  ];\r\n\r\n  useEffect(() => {\r\n    console.log('üöÄ DebtPage mounted, fetching data...');\r\n    fetchData();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    console.log('üîÑ Customers state updated:', customers);\r\n  }, [customers]);\r\n\r\n  useEffect(() => {\r\n    console.log('üîÑ Suppliers state updated:', suppliers);\r\n  }, [suppliers]);\r\n\r\n  // Process debts when customers/suppliers data changes\r\n  useEffect(() => {\r\n    if (customers.length > 0) {\r\n      fetchCustomerDebts();\r\n    }\r\n  }, [customers]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  useEffect(() => {\r\n    if (suppliers.length > 0) {\r\n      fetchSupplierDebts();\r\n    }\r\n  }, [suppliers]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  // Fetch supplier transactions for history\r\n  useEffect(() => {\r\n    if (activeTab === 'suppliers') {\r\n      fetchSupplierTransactions();\r\n    }\r\n  }, [activeTab]);\r\n\r\n  const fetchData = async () => {\r\n    setLoading(true);\r\n    try {\r\n      // First fetch all customers and suppliers\r\n      await Promise.all([\r\n        fetchCustomers(),\r\n        fetchSuppliers(),\r\n      ]);\r\n      \r\n      // Then process debts (this will be done in useEffect when customers/suppliers change)\r\n    } catch (error) {\r\n      message.error('L·ªói khi t·∫£i d·ªØ li·ªáu');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const fetchCustomerDebts = async () => {\r\n    try {\r\n      // Use customers data that's already fetched and enhanced\r\n      const customersWithDebt = customers.filter(c => (c.current_debt || 0) > 0);\r\n      setCustomerDebts(customersWithDebt);\r\n      \r\n      // Calculate debt stats\r\n      const totalDebt = customersWithDebt.reduce((sum, c) => sum + (c.current_debt || 0), 0);\r\n      setDebtStats(prev => ({ ...prev, totalCustomerDebt: totalDebt }));\r\n    } catch (error) {\r\n      console.error('Error processing customer debts:', error);\r\n      setCustomerDebts([]);\r\n    }\r\n  };\r\n\r\n  const fetchSupplierDebts = async () => {\r\n    try {\r\n      // Use suppliers data that's already fetched and enhanced\r\n      const suppliersWithDebt = suppliers.filter(s => (s.current_debt || 0) > 0);\r\n      setSupplierDebts(suppliersWithDebt);\r\n      \r\n      // Calculate debt stats\r\n      const totalDebt = suppliersWithDebt.reduce((sum, s) => sum + (s.current_debt || 0), 0);\r\n      setDebtStats(prev => ({ ...prev, totalSupplierDebt: totalDebt }));\r\n    } catch (error) {\r\n      console.error('Error processing supplier debts:', error);\r\n      setSupplierDebts([]);\r\n    }\r\n  };\r\n\r\n  const fetchSupplierTransactions = async () => {\r\n    try {\r\n      const response = await financialAPI.getTransactions({ type: 'expense', category: 'Tr·∫£ n·ª£ nh√† cung c·∫•p', limit: 10 });\r\n      if (response.data.success) {\r\n        setSupplierTransactions(response.data.data || []);\r\n      } else {\r\n        setSupplierTransactions([]);\r\n      }\r\n    } catch (error) {\r\n      setSupplierTransactions([]);\r\n    }\r\n  };\r\n\r\n  const fetchCustomers = async () => {\r\n    try {\r\n      const response = await customersAPI.getAll();\r\n      console.log('üë• Raw customers response:', response.data);\r\n      \r\n      if (response.data.success) {\r\n        // Kh√¥ng c√≤n mock, ch·ªâ l·∫•y s·ªë n·ª£ th·∫≠t t·ª´ API\r\n        const customersWithDebt = response.data.data.map(customer => ({\r\n          ...customer,\r\n          current_debt: customer.current_debt || 0,\r\n          total_spent: customer.total_spent || 0\r\n        }));\r\n        \r\n        console.log('üí∞ Customers with debt:', customersWithDebt);\r\n        console.log('üìä Total customers for dropdown:', customersWithDebt.length);\r\n        setCustomers(customersWithDebt);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching customers:', error);\r\n      // Fallback: Set empty array to avoid crashes\r\n      setCustomers([]);\r\n    }\r\n  };\r\n\r\n  const fetchSuppliers = async () => {\r\n    try {\r\n      const response = await suppliersAPI.getAll();\r\n      console.log('üè≠ Raw suppliers response:', response.data);\r\n      \r\n      if (response.data.success) {\r\n        // Kh√¥ng c√≤n mock, ch·ªâ l·∫•y s·ªë n·ª£ th·∫≠t t·ª´ API\r\n        const suppliersWithDebt = response.data.data.map(supplier => ({\r\n          ...supplier,\r\n          current_debt: supplier.current_debt || 0,\r\n          total_purchases: supplier.total_purchases || 0\r\n        }));\r\n        \r\n        console.log('üí∞ Suppliers with debt:', suppliersWithDebt);\r\n        console.log('üìä Total suppliers for dropdown:', suppliersWithDebt.length);\r\n        setSuppliers(suppliersWithDebt);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching suppliers:', error);\r\n      // Fallback: Set empty array to avoid crashes\r\n      setSuppliers([]);\r\n    }\r\n  };\r\n\r\n  // üÜï Enhanced form submission with proper error handling\r\n  const handlePayDebt = async (values) => {\r\n    try {\r\n      setSubmitting(true);\r\n      console.log('üí∞ Submitting payment data:', values);\r\n      \r\n      const transactionData = {\r\n        type: activeTab === 'customers' ? 'income' : 'expense',\r\n        category: activeTab === 'customers' ? 'Thu n·ª£ kh√°ch h√†ng' : 'Tr·∫£ n·ª£ nh√† cung c·∫•p',\r\n        amount: values.amount,\r\n        description: values.description || `Thanh to√°n n·ª£ ${activeTab === 'customers' ? 'kh√°ch h√†ng' : 'nh√† cung c·∫•p'}`,\r\n        customer_id: activeTab === 'customers' ? values.entity_id : null,\r\n        supplier_id: activeTab === 'suppliers' ? values.entity_id : null,\r\n        payment_method: values.payment_method,\r\n        transaction_date: values.transaction_date?.toISOString() || new Date().toISOString(),\r\n        user_id: 1,\r\n      };\r\n\r\n      console.log('üì§ Transaction data to send:', transactionData);\r\n\r\n      const response = await financialAPI.create(transactionData);\r\n      if (response.data.success) {\r\n        message.success('Ghi nh·∫≠n thanh to√°n th√†nh c√¥ng!');\r\n        setModalVisible(false);\r\n        form.resetFields();\r\n        fetchData();\r\n      } else {\r\n        throw new Error(response.data.message || 'L·ªói kh√¥ng x√°c ƒë·ªãnh');\r\n      }\r\n    } catch (error) {\r\n      console.error('‚ùå Payment submission error:', error);\r\n      message.error(error.message || 'L·ªói khi ghi nh·∫≠n thanh to√°n');\r\n    } finally {\r\n      setSubmitting(false);\r\n    }\r\n  };\r\n\r\n  // üÜï Enhanced modal close handler\r\n  const handleModalClose = () => {\r\n    setModalVisible(false);\r\n    form.resetFields();\r\n    setSubmitting(false);\r\n  };\r\n\r\n  const customerColumns = [\r\n    {\r\n      title: 'M√£ KH',\r\n      dataIndex: 'code',\r\n      key: 'code',\r\n      width: 100,\r\n    },\r\n    {\r\n      title: 'T√™n kh√°ch h√†ng',\r\n      dataIndex: 'name',\r\n      key: 'name',\r\n      render: (name, record) => (\r\n        <div>\r\n          <div>{name}</div>\r\n          {record.phone && (\r\n            <Text type=\"secondary\" style={{ fontSize: 12 }}>\r\n              {record.phone}\r\n            </Text>\r\n          )}\r\n        </div>\r\n      ),\r\n    },\r\n    {\r\n      title: 'Lo·∫°i KH',\r\n      dataIndex: 'customer_type',\r\n      key: 'customer_type',\r\n      render: (type) => {\r\n        const colors = {\r\n          regular: 'default',\r\n          vip: 'gold',\r\n          wholesale: 'blue',\r\n        };\r\n        const labels = {\r\n          regular: 'Th∆∞·ªùng',\r\n          vip: 'VIP',\r\n          wholesale: 'S·ªâ',\r\n        };\r\n        return <Tag color={colors[type]}>{labels[type]}</Tag>;\r\n      },\r\n    },\r\n    {\r\n      title: 'S·ªë n·ª£',\r\n      dataIndex: 'current_debt',\r\n      key: 'current_debt',\r\n      render: (debt) => (\r\n        <Text strong style={{ color: debt > 0 ? '#ff4d4f' : '#52c41a' }}>\r\n          {debt.toLocaleString('vi-VN')} ‚Ç´\r\n        </Text>\r\n      ),\r\n      sorter: (a, b) => a.current_debt - b.current_debt,\r\n    },\r\n    {\r\n      title: 'T·ªïng chi ti√™u',\r\n      dataIndex: 'total_spent',\r\n      key: 'total_spent',\r\n      render: (spent) => (\r\n        <Text type=\"secondary\">\r\n          {spent ? spent.toLocaleString('vi-VN') : 0} ‚Ç´\r\n        </Text>\r\n      ),\r\n    },\r\n    {\r\n      title: 'Tr·∫°ng th√°i',\r\n      key: 'status',\r\n      render: (_, record) => {\r\n        const debt = record.current_debt || 0;\r\n        if (debt === 0) {\r\n          return <Badge status=\"success\" text=\"ƒê√£ thanh to√°n\" />;\r\n        } else if (debt > 1000000) {\r\n          return <Badge status=\"error\" text=\"N·ª£ l·ªõn\" />;\r\n        } else {\r\n          return <Badge status=\"warning\" text=\"C√≥ n·ª£\" />;\r\n        }\r\n      },\r\n    },\r\n    {\r\n      title: 'Thao t√°c',\r\n      key: 'actions',\r\n      render: (_, record) => (\r\n        <Space>\r\n          <Button\r\n            type=\"primary\"\r\n            size=\"small\"\r\n            icon={<DollarOutlined />}\r\n            onClick={() => {\r\n              setModalType('payment');\r\n              setActiveTab('customers');\r\n              setModalVisible(true);\r\n              // üÜï Set form values v·ªõi Ant Design Form\r\n              form.setFieldsValue({\r\n                entity_id: record.id,\r\n                payment_method: 'cash',\r\n                transaction_date: dayjs(),\r\n                amount: record.current_debt || 0,\r\n                description: `Thanh to√°n n·ª£ kh√°ch h√†ng ${record.name}`\r\n              });\r\n            }}\r\n          >\r\n            Thanh to√°n\r\n          </Button>\r\n        </Space>\r\n      ),\r\n    },\r\n  ];\r\n\r\n  const supplierColumns = [\r\n    {\r\n      title: 'M√£ NCC',\r\n      dataIndex: 'code',\r\n      key: 'code',\r\n      width: 100,\r\n    },\r\n    {\r\n      title: 'T√™n nh√† cung c·∫•p',\r\n      dataIndex: 'name',\r\n      key: 'name',\r\n      render: (name, record) => (\r\n        <div>\r\n          <div>{name}</div>\r\n          {record.phone && (\r\n            <Text type=\"secondary\" style={{ fontSize: 12 }}>\r\n              {record.phone}\r\n            </Text>\r\n          )}\r\n        </div>\r\n      ),\r\n    },\r\n    {\r\n      title: 'ƒê·ªãa ch·ªâ',\r\n      dataIndex: 'address',\r\n      key: 'address',\r\n      ellipsis: true,\r\n    },\r\n    {\r\n      title: 'S·ªë n·ª£',\r\n      dataIndex: 'current_debt',\r\n      key: 'current_debt',\r\n      render: (debt) => (\r\n        <Text strong style={{ color: debt > 0 ? '#ff4d4f' : '#52c41a' }}>\r\n          {debt.toLocaleString('vi-VN')} ‚Ç´\r\n        </Text>\r\n      ),\r\n      sorter: (a, b) => a.current_debt - b.current_debt,\r\n    },\r\n    {\r\n      title: 'Tr·∫°ng th√°i',\r\n      key: 'status',\r\n      render: (_, record) => {\r\n        const debt = record.current_debt || 0;\r\n        if (debt === 0) {\r\n          return <Badge status=\"success\" text=\"ƒê√£ thanh to√°n\" />;\r\n        } else if (debt > 5000000) {\r\n          return <Badge status=\"error\" text=\"N·ª£ l·ªõn\" />;\r\n        } else {\r\n          return <Badge status=\"warning\" text=\"C√≥ n·ª£\" />;\r\n        }\r\n      },\r\n    },\r\n    {\r\n      title: 'Thao t√°c',\r\n      key: 'actions',\r\n      render: (_, record) => (\r\n        <Space>\r\n          <Button\r\n            type=\"primary\"\r\n            size=\"small\"\r\n            icon={<DollarOutlined />}\r\n            onClick={() => {\r\n              setModalType('payment');\r\n              setActiveTab('suppliers');\r\n              setModalVisible(true);\r\n              // üÜï Set form values v·ªõi Ant Design Form\r\n              form.setFieldsValue({\r\n                entity_id: record.id,\r\n                payment_method: 'cash',\r\n                transaction_date: dayjs(),\r\n                amount: record.current_debt || 0,\r\n                description: `Thanh to√°n n·ª£ nh√† cung c·∫•p ${record.name}`\r\n              });\r\n            }}\r\n          >\r\n            Thanh to√°n\r\n          </Button>\r\n        </Space>\r\n      ),\r\n    },\r\n  ];\r\n\r\n  // Table columns for supplier transaction history\r\n  const supplierHistoryColumns = [\r\n    {\r\n      title: 'Ng√†y giao d·ªãch',\r\n      dataIndex: 'transaction_date',\r\n      key: 'transaction_date',\r\n      render: (date) => date ? new Date(date).toLocaleString('vi-VN', { timeZone: 'Asia/Ho_Chi_Minh' }) : '',\r\n      width: 140,\r\n    },\r\n    {\r\n      title: 'S·ªë ti·ªÅn',\r\n      dataIndex: 'amount',\r\n      key: 'amount',\r\n      render: (amount) => <span style={{ color: '#cf1322', fontWeight: 500 }}>- {amount.toLocaleString('vi-VN')} ‚Ç´</span>,\r\n      width: 120,\r\n    },\r\n    {\r\n      title: 'M√¥ t·∫£',\r\n      dataIndex: 'description',\r\n      key: 'description',\r\n      render: (desc) => desc || 'Thanh to√°n n·ª£ nh√† cung c·∫•p',\r\n    },\r\n  ];\r\n\r\n  const renderDebtSummary = () => {\r\n    return (\r\n      <Row gutter={16} style={{ marginBottom: 24 }}>\r\n        <Col span={6}>\r\n          <Card>\r\n            <Statistic\r\n              title=\"T·ªïng kh√°ch h√†ng n·ª£\"\r\n              value={customerDebts.length}\r\n              valueStyle={{ color: '#52c41a' }}\r\n              prefix={<UserOutlined />}\r\n            />\r\n          </Card>\r\n        </Col>\r\n        <Col span={6}>\r\n          <Card>\r\n            <Statistic\r\n              title=\"T·ªïng n·ª£ nh√† cung c·∫•p\"\r\n              value={debtStats.totalSupplierDebt}\r\n              precision={0}\r\n              valueStyle={{ color: '#cf1322' }}\r\n              prefix={<ShopOutlined />}\r\n              suffix=\"‚Ç´\"\r\n            />\r\n          </Card>\r\n        </Col>\r\n        <Col span={6}>\r\n          <Card>\r\n            <Statistic\r\n              title=\"T·ªïng n·ª£ ph·∫£i thu\"\r\n              value={debtStats.totalCustomerDebt + debtStats.totalSupplierDebt}\r\n              precision={0}\r\n              valueStyle={{ color: '#1890ff' }}\r\n              prefix={<DollarOutlined />}\r\n              suffix=\"‚Ç´\"\r\n            />\r\n          </Card>\r\n        </Col>\r\n      </Row>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div style={{ padding: 24 }}>\r\n      {renderDebtSummary()}\r\n\r\n      <Alert\r\n        message=\"Qu·∫£n l√Ω n·ª£\"\r\n        description=\"Theo d√µi v√† qu·∫£n l√Ω c√°c kho·∫£n n·ª£ c·ªßa kh√°ch h√†ng v√† nh√† cung c·∫•p. H·ªá th·ªëng s·∫Ω t·ª± ƒë·ªông c·∫≠p nh·∫≠t s·ªë d∆∞ n·ª£ khi c√≥ giao d·ªãch thanh to√°n.\"\r\n        type=\"info\"\r\n        showIcon\r\n        style={{ marginBottom: 24 }}\r\n      />\r\n\r\n      <Tabs activeKey={activeTab} onChange={setActiveTab}>\r\n        <TabPane\r\n          tab={\r\n            <span>\r\n              <UserOutlined />\r\n              N·ª£ kh√°ch h√†ng ({customerDebts.length})\r\n            </span>\r\n          }\r\n          key=\"customers\"\r\n        >\r\n          <Card\r\n            title=\"Danh s√°ch kh√°ch h√†ng c√≥ n·ª£\"\r\n            extra={\r\n              <Button\r\n                type=\"primary\"\r\n                icon={<PlusOutlined />}\r\n                onClick={() => {\r\n                  setModalType('payment');\r\n                  setActiveTab('customers');\r\n                  setModalVisible(true);\r\n                  // üÜï Reset form v·ªõi values m·∫∑c ƒë·ªãnh\r\n                  form.setFieldsValue({\r\n                    payment_method: 'cash',\r\n                    transaction_date: dayjs(),\r\n                    entity_id: undefined,\r\n                    amount: undefined,\r\n                    description: ''\r\n                  });\r\n                }}\r\n              >\r\n                Ghi nh·∫≠n thanh to√°n\r\n              </Button>\r\n            }\r\n          >\r\n            <Table\r\n              columns={customerColumns}\r\n              dataSource={customerDebts}\r\n              loading={loading}\r\n              rowKey=\"id\"\r\n              pagination={{\r\n                showSizeChanger: true,\r\n                showQuickJumper: true,\r\n                showTotal: (total, range) =>\r\n                  `${range[0]}-${range[1]} c·ªßa ${total} kh√°ch h√†ng`,\r\n              }}\r\n            />\r\n          </Card>\r\n        </TabPane>\r\n\r\n        <TabPane\r\n          tab={\r\n            <span>\r\n              <ShopOutlined />\r\n              N·ª£ nh√† cung c·∫•p ({supplierDebts.length})\r\n            </span>\r\n          }\r\n          key=\"suppliers\"\r\n        >\r\n          <Row gutter={24}>\r\n            <Col span={15}>\r\n              <Card\r\n                title=\"Danh s√°ch nh√† cung c·∫•p c√≥ n·ª£\"\r\n                extra={\r\n                  <Button\r\n                    type=\"primary\"\r\n                    icon={<PlusOutlined />}\r\n                    onClick={() => {\r\n                      setModalType('payment');\r\n                      setActiveTab('suppliers');\r\n                      setModalVisible(true);\r\n                      // üÜï Reset form v·ªõi values m·∫∑c ƒë·ªãnh\r\n                      form.setFieldsValue({\r\n                        payment_method: 'cash',\r\n                        transaction_date: dayjs(),\r\n                        entity_id: undefined,\r\n                        amount: undefined,\r\n                        description: ''\r\n                      });\r\n                    }}\r\n                  >\r\n                    Ghi nh·∫≠n thanh to√°n\r\n                  </Button>\r\n                }\r\n              >\r\n                <Table\r\n                  columns={supplierColumns}\r\n                  dataSource={supplierDebts}\r\n                  loading={loading}\r\n                  rowKey=\"id\"\r\n                  pagination={{\r\n                    showSizeChanger: true,\r\n                    showQuickJumper: true,\r\n                    showTotal: (total, range) =>\r\n                      `${range[0]}-${range[1]} c·ªßa ${total} nh√† cung c·∫•p`,\r\n                  }}\r\n                />\r\n              </Card>\r\n            </Col>\r\n            <Col span={9}>\r\n              <Card\r\n                title=\"L·ªãch s·ª≠ thanh to√°n n·ª£ nh√† cung c·∫•p\"\r\n                bordered={true}\r\n                style={{ minHeight: 400 }}\r\n              >\r\n                <Table\r\n                  columns={supplierHistoryColumns}\r\n                  dataSource={supplierTransactions}\r\n                  rowKey=\"id\"\r\n                  size=\"small\"\r\n                  pagination={{ pageSize: 8 }}\r\n                  locale={{ emptyText: 'Ch∆∞a c√≥ giao d·ªãch' }}\r\n                />\r\n              </Card>\r\n            </Col>\r\n          </Row>\r\n        </TabPane>\r\n      </Tabs>\r\n\r\n      {/* üÜï Enhanced Modal with Ant Design Form */}\r\n      <Modal\r\n        title={\r\n          <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>\r\n            <DollarOutlined style={{ color: '#52c41a' }} />\r\n            <span>Ghi nh·∫≠n thanh to√°n {activeTab === 'customers' ? 'n·ª£ kh√°ch h√†ng' : 'n·ª£ nh√† cung c·∫•p'}</span>\r\n          </div>\r\n        }\r\n        open={modalVisible}\r\n        onCancel={handleModalClose}\r\n        footer={null}\r\n        width={700}\r\n        destroyOnClose={true}\r\n      >\r\n        <Form\r\n          form={form}\r\n          layout=\"vertical\"\r\n          onFinish={handlePayDebt}\r\n          initialValues={{\r\n            payment_method: 'cash',\r\n            transaction_date: dayjs(),\r\n          }}\r\n        >\r\n          <Form.Item\r\n            label={`${activeTab === 'customers' ? 'Kh√°ch h√†ng' : 'Nh√† cung c·∫•p'}`}\r\n            name=\"entity_id\"\r\n            rules={[\r\n              { required: true, message: `Vui l√≤ng ch·ªçn ${activeTab === 'customers' ? 'kh√°ch h√†ng' : 'nh√† cung c·∫•p'}` }\r\n            ]}\r\n          >\r\n            <Select\r\n              placeholder={`Ch·ªçn ${activeTab === 'customers' ? 'kh√°ch h√†ng' : 'nh√† cung c·∫•p'}`}\r\n              style={{ width: '100%' }}\r\n              showSearch\r\n              filterOption={(input, option) => {\r\n                const children = typeof option.children === 'string' ? option.children : '';\r\n                return children.toLowerCase().indexOf(input.toLowerCase()) >= 0;\r\n              }}\r\n              size=\"large\"\r\n            >\r\n              {(() => {\r\n                const entities = activeTab === 'customers' ? customers : suppliers;\r\n                console.log(`üîç Rendering dropdown for ${activeTab}:`, entities);\r\n                console.log(`üìã Total entities to render: ${entities.length}`);\r\n                \r\n                return entities && entities.length > 0 ? entities.map((entity) => {\r\n                  // üõ°Ô∏è Safety check ƒë·ªÉ tr√°nh undefined\r\n                  if (!entity || !entity.id || !entity.name) {\r\n                    console.warn('‚ö†Ô∏è Invalid entity found:', entity);\r\n                    return null;\r\n                  }\r\n                  \r\n                  return (\r\n                    <Option key={entity.id} value={entity.id}>\r\n                      <div>\r\n                        <div style={{ fontWeight: 'bold' }}>{entity.name}</div>\r\n                        {entity.phone && (\r\n                          <Text type=\"secondary\" style={{ fontSize: 12 }}>\r\n                            üìû {entity.phone}\r\n                          </Text>\r\n                        )}\r\n                        <div>\r\n                          <Text type=\"secondary\" style={{ fontSize: 12, color: '#ff4d4f' }}>\r\n                            üí∞ N·ª£ hi·ªán t·∫°i: {(entity.current_debt || 0).toLocaleString('vi-VN')} ‚Ç´\r\n                          </Text>\r\n                        </div>\r\n                      </div>\r\n                    </Option>\r\n                  );\r\n                }).filter(Boolean) : []; // Filter out null entries\r\n              })()}\r\n            </Select>\r\n          </Form.Item>\r\n\r\n          <Row gutter={16}>\r\n            <Col span={12}>\r\n              <Form.Item\r\n                label=\"S·ªë ti·ªÅn thanh to√°n\"\r\n                name=\"amount\"\r\n                rules={[\r\n                  { required: true, message: 'Vui l√≤ng nh·∫≠p s·ªë ti·ªÅn' },\r\n                  { type: 'number', min: 1, message: 'S·ªë ti·ªÅn ph·∫£i l·ªõn h∆°n 0' }\r\n                ]}\r\n              >\r\n                <InputNumber\r\n                  placeholder=\"Nh·∫≠p s·ªë ti·ªÅn\"\r\n                  style={{ width: '100%' }}\r\n                  formatter={(value) => `${value}`.replace(/\\B(?=(\\d{3})+(?!\\d))/g, ',')}\r\n                  parser={(value) => value ? value.replace(/\\$\\s?|(,*)/g, '') : ''}\r\n                  min={0}\r\n                  size=\"large\"\r\n                  addonAfter=\"‚Ç´\"\r\n                />\r\n              </Form.Item>\r\n            </Col>\r\n            <Col span={12}>\r\n              <Form.Item\r\n                label=\"Ph∆∞∆°ng th·ª©c thanh to√°n\"\r\n                name=\"payment_method\"\r\n                rules={[{ required: true, message: 'Vui l√≤ng ch·ªçn ph∆∞∆°ng th·ª©c thanh to√°n' }]}\r\n              >\r\n                <Select\r\n                  placeholder=\"Ch·ªçn ph∆∞∆°ng th·ª©c\"\r\n                  style={{ width: '100%' }}\r\n                  size=\"large\"\r\n                >\r\n                  {paymentMethods.map((method) => (\r\n                    <Option key={method.value} value={method.value}>\r\n                      <Space>\r\n                        {method.icon}\r\n                        {method.label}\r\n                      </Space>\r\n                    </Option>\r\n                  ))}\r\n                </Select>\r\n              </Form.Item>\r\n            </Col>\r\n          </Row>\r\n\r\n          <Form.Item\r\n            label=\"M√¥ t·∫£\"\r\n            name=\"description\"\r\n          >\r\n            <Input.TextArea\r\n              placeholder=\"Nh·∫≠p m√¥ t·∫£ thanh to√°n (t√πy ch·ªçn)\"\r\n              rows={3}\r\n              showCount\r\n              maxLength={500}\r\n            />\r\n          </Form.Item>\r\n\r\n          <Form.Item\r\n            label=\"Ng√†y thanh to√°n\"\r\n            name=\"transaction_date\"\r\n            rules={[{ required: true, message: 'Vui l√≤ng ch·ªçn ng√†y thanh to√°n' }]}\r\n          >\r\n            <DatePicker\r\n              style={{ width: '100%' }}\r\n              size=\"large\"\r\n              format=\"DD/MM/YYYY\"\r\n              placeholder=\"Ch·ªçn ng√†y thanh to√°n\"\r\n            />\r\n          </Form.Item>\r\n\r\n          <Form.Item style={{ textAlign: 'right', marginTop: 24, marginBottom: 0 }}>\r\n            <Space>\r\n              <Button onClick={handleModalClose} size=\"large\">\r\n                H·ªßy\r\n              </Button>\r\n              <Button\r\n                type=\"primary\"\r\n                htmlType=\"submit\"\r\n                loading={submitting}\r\n                icon={<DollarOutlined />}\r\n                size=\"large\"\r\n              >\r\n                Ghi nh·∫≠n thanh to√°n\r\n              </Button>\r\n            </Space>\r\n          </Form.Item>\r\n        </Form>\r\n      </Modal>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DebtPage; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}