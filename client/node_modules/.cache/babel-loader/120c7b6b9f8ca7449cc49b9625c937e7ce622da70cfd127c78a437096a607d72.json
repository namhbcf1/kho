{"ast":null,"code":"import _objectWithoutProperties from\"C:/Users/ADMIN/Desktop/kho/kho/client/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";import _objectSpread from\"C:/Users/ADMIN/Desktop/kho/kho/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";const _excluded=[\"gender\",\"birthday\",\"city\"];import React,{useState,useEffect}from'react';import{Card,Table,Button,Input,Space,Modal,Form,Select,message,Row,Col,Statistic,Tag,Tooltip,DatePicker,Popconfirm,Drawer,Tabs,Empty,Typography,Descriptions,Timeline}from'antd';import{PlusOutlined,SearchOutlined,EditOutlined,DeleteOutlined,UserOutlined,PhoneOutlined,MailOutlined,HomeOutlined,CrownOutlined,ShoppingCartOutlined,CalendarOutlined,EyeOutlined}from'@ant-design/icons';import api,{customersAPI,ordersAPI,formatCurrency,formatDate,productsAPI}from'../services/api';import dayjs from'dayjs';import CustomerFormModal from'../components/CustomerFormModal';import{toast}from'sonner';import CustomerDetailDrawer from'../components/CustomerDetailDrawer';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const{Search}=Input;const{Option}=Select;const{TabPane}=Tabs;const{Text}=Typography;const CustomersPage=()=>{const[customers,setCustomers]=useState([]);const[loading,setLoading]=useState(false);const[isModalVisible,setIsModalVisible]=useState(false);const[isDetailDrawerVisible,setIsDetailDrawerVisible]=useState(false);const[editingCustomer,setEditingCustomer]=useState(null);const[selectedCustomer,setSelectedCustomer]=useState(null);const[searchText,setSearchText]=useState('');const[filterType,setFilterType]=useState('all');const[stats,setStats]=useState({total:0,regular:0,vip:0,wholesale:0});const[customerPurchaseHistory,setCustomerPurchaseHistory]=useState([]);const[purchaseHistoryLoading,setPurchaseHistoryLoading]=useState(false);const[orderSerials,setOrderSerials]=useState({});const[form]=Form.useForm();const customerTypes=[{value:'regular',label:'KhÃ¡ch thÆ°á»ng',color:'default'},{value:'vip',label:'VIP',color:'gold'},{value:'wholesale',label:'BÃ¡n sá»‰',color:'purple'}];useEffect(()=>{fetchCustomers();},[searchText,filterType]);// âœ¨ AI Error Monitor Integration - Listen for auto-refresh events\nuseEffect(()=>{const handleAIRefreshCustomerList=()=>{console.log('ðŸ¤– AI triggered customer list refresh');fetchCustomers();};// Listen for AI refresh customer list event\nwindow.addEventListener('ai-refresh-customer-list',handleAIRefreshCustomerList);// Cleanup event listener\nreturn()=>{window.removeEventListener('ai-refresh-customer-list',handleAIRefreshCustomerList);};},[]);// Fetch serials for all orders in purchase history\nuseEffect(()=>{if(customerPurchaseHistory.length>0){fetchAllOrderSerials();}},[customerPurchaseHistory]);const fetchAllOrderSerials=async()=>{const serialsMap={};for(const order of customerPurchaseHistory){if(!order.items)continue;for(const item of order.items){try{const response=await productsAPI.getSoldSerials({product_id:item.product_id,order_id:order.id});if(response.data.success){serialsMap[\"\".concat(order.id,\"_\").concat(item.product_id)]=response.data.data||[];}else{serialsMap[\"\".concat(order.id,\"_\").concat(item.product_id)]=[];}}catch(error){serialsMap[\"\".concat(order.id,\"_\").concat(item.product_id)]=[];}}}setOrderSerials(serialsMap);};const fetchCustomers=async()=>{try{setLoading(true);const response=await customersAPI.getAll({search:searchText,type:filterType});if(response.data.success){setCustomers(response.data.data);calculateStats(response.data.data);}}catch(error){toast.error('Lá»—i khi táº£i danh sÃ¡ch khÃ¡ch hÃ ng');console.error('Error fetching customers:',error);}finally{setLoading(false);}};const calculateStats=customerData=>{const stats={total:customerData.length,regular:customerData.filter(c=>c.customer_type==='regular').length,vip:customerData.filter(c=>c.customer_type==='vip').length,wholesale:customerData.filter(c=>c.customer_type==='wholesale').length};setStats(stats);};const showModal=function(){let customer=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;setEditingCustomer(customer);setIsModalVisible(true);if(customer){form.setFieldsValue(_objectSpread({},customer));}else{form.resetFields();}};const handleCancel=()=>{setIsModalVisible(false);setEditingCustomer(null);form.resetFields();};const handleSubmit=async values=>{try{// Remove unwanted fields from values before sending\nconst{gender,birthday,city}=values,customerData=_objectWithoutProperties(values,_excluded);if(editingCustomer){await customersAPI.update(editingCustomer.id,customerData);toast.success('Cáº­p nháº­t khÃ¡ch hÃ ng thÃ nh cÃ´ng');}else{await customersAPI.create(customerData);toast.success('Táº¡o khÃ¡ch hÃ ng thÃ nh cÃ´ng');}handleCancel();fetchCustomers();}catch(error){var _error$response,_error$response$data;toast.error(\"L\\u1ED7i khi \".concat(editingCustomer?'cáº­p nháº­t':'táº¡o',\" kh\\xE1ch h\\xE0ng: \")+(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||error.message));console.error('Error saving customer:',error);}};const handleDelete=async id=>{try{await customersAPI.delete(id);toast.success('XÃ³a khÃ¡ch hÃ ng thÃ nh cÃ´ng');fetchCustomers();}catch(error){toast.error('Lá»—i khi xÃ³a khÃ¡ch hÃ ng');console.error('Error deleting customer:',error);}};const showCustomerDetail=async customer=>{try{setSelectedCustomer(customer);setIsDetailDrawerVisible(true);setPurchaseHistoryLoading(true);// Fetch customer details\nconst customerResponse=await customersAPI.getById(customer.id);if(customerResponse.data.success){setSelectedCustomer(customerResponse.data.data);}// ðŸ›’ Fetch customer purchase history\ntry{const ordersResponse=await api.get('/orders',{params:{customer_name:customer.name,// Search by customer name since orders don't have customer_id\nlimit:100}});if(ordersResponse.data.success){const customerOrders=ordersResponse.data.data.orders||ordersResponse.data.data;// Filter orders that match this customer (by name and/or phone)\nconst filteredOrders=customerOrders.filter(order=>order.customer_name&&order.customer_name.toLowerCase()===customer.name.toLowerCase()||order.customer_phone&&customer.phone&&order.customer_phone===customer.phone);setCustomerPurchaseHistory(filteredOrders);}else{setCustomerPurchaseHistory([]);}}catch(orderError){console.error('Error fetching purchase history:',orderError);setCustomerPurchaseHistory([]);}}catch(error){toast.error('Lá»—i khi táº£i thÃ´ng tin khÃ¡ch hÃ ng');}finally{setPurchaseHistoryLoading(false);}};const columns=[{title:'MÃ£ KH',dataIndex:'code',key:'code',width:100,render:text=>/*#__PURE__*/_jsx(\"strong\",{children:text})},{title:'ThÃ´ng tin khÃ¡ch hÃ ng',key:'customer_info',render:(_,record)=>/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{style:{fontWeight:'bold',marginBottom:4},children:[/*#__PURE__*/_jsx(UserOutlined,{style:{marginRight:8}}),record.name]}),record.phone&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#666',fontSize:'12px'},children:[/*#__PURE__*/_jsx(PhoneOutlined,{style:{marginRight:4}}),record.phone]}),record.email&&/*#__PURE__*/_jsxs(\"div\",{style:{color:'#666',fontSize:'12px'},children:[/*#__PURE__*/_jsx(MailOutlined,{style:{marginRight:4}}),record.email]})]})},{title:'Loáº¡i KH',dataIndex:'customer_type',key:'customer_type',width:120,render:type=>{const typeConfig=customerTypes.find(t=>t.value===type);return/*#__PURE__*/_jsx(Tag,{color:typeConfig===null||typeConfig===void 0?void 0:typeConfig.color,icon:type==='vip'?/*#__PURE__*/_jsx(CrownOutlined,{}):null,children:typeConfig===null||typeConfig===void 0?void 0:typeConfig.label});}},{title:'Tá»•ng chi tiÃªu',dataIndex:'total_spent',key:'total_spent',width:120,render:amount=>/*#__PURE__*/_jsx(\"span\",{style:{color:'#52c41a',fontWeight:'bold'},children:formatCurrency(amount||0)}),sorter:(a,b)=>(a.total_spent||0)-(b.total_spent||0)},{title:'Sá»‘ láº§n mua',dataIndex:'visit_count',key:'visit_count',width:100,render:count=>/*#__PURE__*/_jsxs(\"span\",{children:[/*#__PURE__*/_jsx(ShoppingCartOutlined,{style:{marginRight:4}}),count||0]}),sorter:(a,b)=>(a.visit_count||0)-(b.visit_count||0)},{title:'Chiáº¿t kháº¥u',dataIndex:'discount_rate',key:'discount_rate',width:100,render:rate=>/*#__PURE__*/_jsxs(\"span\",{style:{color:'#fa8c16'},children:[rate||0,\"%\"]})},{title:'Láº§n cuá»‘i mua',dataIndex:'last_visit',key:'last_visit',width:130,render:date=>date?formatDate(date):'ChÆ°a mua'},{title:'Thao tÃ¡c',key:'actions',width:150,render:(_,record)=>/*#__PURE__*/_jsxs(Space,{children:[/*#__PURE__*/_jsx(Tooltip,{title:\"Xem chi ti\\u1EBFt\",children:/*#__PURE__*/_jsx(Button,{type:\"default\",size:\"small\",icon:/*#__PURE__*/_jsx(EyeOutlined,{}),onClick:()=>showCustomerDetail(record)})}),/*#__PURE__*/_jsx(Tooltip,{title:\"Ch\\u1EC9nh s\\u1EEDa\",children:/*#__PURE__*/_jsx(Button,{type:\"primary\",size:\"small\",icon:/*#__PURE__*/_jsx(EditOutlined,{}),onClick:()=>showModal(record)})}),/*#__PURE__*/_jsx(Popconfirm,{title:\"B\\u1EA1n c\\xF3 ch\\u1EAFc ch\\u1EAFn mu\\u1ED1n x\\xF3a kh\\xE1ch h\\xE0ng n\\xE0y?\",onConfirm:()=>handleDelete(record.id),okText:\"C\\xF3\",cancelText:\"Kh\\xF4ng\",children:/*#__PURE__*/_jsx(Tooltip,{title:\"X\\xF3a\",children:/*#__PURE__*/_jsx(Button,{type:\"default\",danger:true,size:\"small\",icon:/*#__PURE__*/_jsx(DeleteOutlined,{})})})})]})}];return/*#__PURE__*/_jsxs(\"div\",{style:{padding:'24px'},children:[/*#__PURE__*/_jsxs(Row,{gutter:[16,16],style:{marginBottom:24},children:[/*#__PURE__*/_jsx(Col,{span:6,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(Statistic,{title:\"T\\u1ED5ng kh\\xE1ch h\\xE0ng\",value:stats.total,prefix:/*#__PURE__*/_jsx(UserOutlined,{}),valueStyle:{color:'#1890ff'}})})}),/*#__PURE__*/_jsx(Col,{span:6,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(Statistic,{title:\"Kh\\xE1ch th\\u01B0\\u1EDDng\",value:stats.regular,valueStyle:{color:'#52c41a'}})})}),/*#__PURE__*/_jsx(Col,{span:6,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(Statistic,{title:\"Kh\\xE1ch VIP\",value:stats.vip,prefix:/*#__PURE__*/_jsx(CrownOutlined,{}),valueStyle:{color:'#faad14'}})})}),/*#__PURE__*/_jsx(Col,{span:6,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(Statistic,{title:\"Kh\\xE1ch b\\xE1n s\\u1EC9\",value:stats.wholesale,valueStyle:{color:'#722ed1'}})})})]}),/*#__PURE__*/_jsxs(Card,{title:\"Qu\\u1EA3n l\\xFD kh\\xE1ch h\\xE0ng\",children:[/*#__PURE__*/_jsxs(Row,{gutter:[16,16],style:{marginBottom:16},children:[/*#__PURE__*/_jsx(Col,{span:8,children:/*#__PURE__*/_jsx(Search,{placeholder:\"T\\xECm theo t\\xEAn, S\\u0110T, m\\xE3 KH...\",value:searchText,onChange:e=>setSearchText(e.target.value),onSearch:fetchCustomers,enterButton:/*#__PURE__*/_jsx(SearchOutlined,{}),allowClear:true})}),/*#__PURE__*/_jsx(Col,{span:6,children:/*#__PURE__*/_jsxs(Select,{style:{width:'100%'},placeholder:\"L\\u1ECDc theo lo\\u1EA1i kh\\xE1ch h\\xE0ng\",value:filterType,onChange:setFilterType,children:[/*#__PURE__*/_jsx(Option,{value:\"all\",children:\"T\\u1EA5t c\\u1EA3\"}),customerTypes.map(type=>/*#__PURE__*/_jsx(Option,{value:type.value,children:type.label},type.value))]})}),/*#__PURE__*/_jsx(Col,{span:10,style:{textAlign:'right'},children:/*#__PURE__*/_jsx(Button,{type:\"primary\",icon:/*#__PURE__*/_jsx(PlusOutlined,{}),onClick:()=>showModal(),size:\"large\",children:\"Th\\xEAm kh\\xE1ch h\\xE0ng\"})})]}),/*#__PURE__*/_jsx(Table,{columns:columns,dataSource:customers,rowKey:\"id\",loading:loading,pagination:{total:customers.length,pageSize:10,showSizeChanger:true,showQuickJumper:true,showTotal:(total,range)=>\"\".concat(range[0],\"-\").concat(range[1],\" c\\u1EE7a \").concat(total,\" kh\\xE1ch h\\xE0ng\")},scroll:{x:1200}})]}),/*#__PURE__*/_jsx(CustomerFormModal,{isModalVisible:isModalVisible,handleCancel:handleCancel,editingCustomer:editingCustomer,form:form,handleSubmit:handleSubmit,customerTypes:customerTypes}),/*#__PURE__*/_jsx(CustomerDetailDrawer,{isDetailDrawerVisible:isDetailDrawerVisible,setIsDetailDrawerVisible:setIsDetailDrawerVisible,selectedCustomer:selectedCustomer,customerTypes:customerTypes,customerPurchaseHistory:customerPurchaseHistory,purchaseHistoryLoading:purchaseHistoryLoading,orderSerials:orderSerials,showModal:showModal,handleDelete:handleDelete,formatCurrency:formatCurrency,formatDate:formatDate})]});};export default CustomersPage;","map":{"version":3,"names":["React","useState","useEffect","Card","Table","Button","Input","Space","Modal","Form","Select","message","Row","Col","Statistic","Tag","Tooltip","DatePicker","Popconfirm","Drawer","Tabs","Empty","Typography","Descriptions","Timeline","PlusOutlined","SearchOutlined","EditOutlined","DeleteOutlined","UserOutlined","PhoneOutlined","MailOutlined","HomeOutlined","CrownOutlined","ShoppingCartOutlined","CalendarOutlined","EyeOutlined","api","customersAPI","ordersAPI","formatCurrency","formatDate","productsAPI","dayjs","CustomerFormModal","toast","CustomerDetailDrawer","jsx","_jsx","jsxs","_jsxs","Search","Option","TabPane","Text","CustomersPage","customers","setCustomers","loading","setLoading","isModalVisible","setIsModalVisible","isDetailDrawerVisible","setIsDetailDrawerVisible","editingCustomer","setEditingCustomer","selectedCustomer","setSelectedCustomer","searchText","setSearchText","filterType","setFilterType","stats","setStats","total","regular","vip","wholesale","customerPurchaseHistory","setCustomerPurchaseHistory","purchaseHistoryLoading","setPurchaseHistoryLoading","orderSerials","setOrderSerials","form","useForm","customerTypes","value","label","color","fetchCustomers","handleAIRefreshCustomerList","console","log","window","addEventListener","removeEventListener","length","fetchAllOrderSerials","serialsMap","order","items","item","response","getSoldSerials","product_id","order_id","id","data","success","concat","error","getAll","search","type","calculateStats","customerData","filter","c","customer_type","showModal","customer","arguments","undefined","setFieldsValue","_objectSpread","resetFields","handleCancel","handleSubmit","values","gender","birthday","city","_objectWithoutProperties","_excluded","update","create","_error$response","_error$response$data","handleDelete","delete","showCustomerDetail","customerResponse","getById","ordersResponse","get","params","customer_name","name","limit","customerOrders","orders","filteredOrders","toLowerCase","customer_phone","phone","orderError","columns","title","dataIndex","key","width","render","text","children","_","record","style","fontWeight","marginBottom","marginRight","fontSize","email","typeConfig","find","t","icon","amount","sorter","a","b","total_spent","count","visit_count","rate","date","size","onClick","onConfirm","okText","cancelText","danger","padding","gutter","span","prefix","valueStyle","placeholder","onChange","e","target","onSearch","enterButton","allowClear","map","textAlign","dataSource","rowKey","pagination","pageSize","showSizeChanger","showQuickJumper","showTotal","range","scroll","x"],"sources":["C:/Users/ADMIN/Desktop/kho/kho/client/src/pages/CustomersPage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport {\n  Card,\n  Table,\n  Button,\n  Input,\n  Space,\n  Modal,\n  Form,\n  Select,\n  message,\n  Row,\n  Col,\n  Statistic,\n  Tag,\n  Tooltip,\n  DatePicker,\n  Popconfirm,\n  Drawer,\n  Tabs,\n  Empty,\n  Typography,\n  Descriptions,\n  Timeline\n} from 'antd';\nimport {\n  PlusOutlined,\n  SearchOutlined,\n  EditOutlined,\n  DeleteOutlined,\n  UserOutlined,\n  PhoneOutlined,\n  MailOutlined,\n  HomeOutlined,\n  CrownOutlined,\n  ShoppingCartOutlined,\n  CalendarOutlined,\n  EyeOutlined\n} from '@ant-design/icons';\nimport api, { customersAPI, ordersAPI, formatCurrency, formatDate, productsAPI } from '../services/api';\nimport dayjs from 'dayjs';\nimport CustomerFormModal from '../components/CustomerFormModal';\nimport { toast } from 'sonner';\nimport CustomerDetailDrawer from '../components/CustomerDetailDrawer';\n\nconst { Search } = Input;\nconst { Option } = Select;\nconst { TabPane } = Tabs;\nconst { Text } = Typography;\n\nconst CustomersPage = () => {\n  const [customers, setCustomers] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [isModalVisible, setIsModalVisible] = useState(false);\n  const [isDetailDrawerVisible, setIsDetailDrawerVisible] = useState(false);\n  const [editingCustomer, setEditingCustomer] = useState(null);\n  const [selectedCustomer, setSelectedCustomer] = useState(null);\n  const [searchText, setSearchText] = useState('');\n  const [filterType, setFilterType] = useState('all');\n  const [stats, setStats] = useState({\n    total: 0,\n    regular: 0,\n    vip: 0,\n    wholesale: 0\n  });\n  const [customerPurchaseHistory, setCustomerPurchaseHistory] = useState([]);\n  const [purchaseHistoryLoading, setPurchaseHistoryLoading] = useState(false);\n  const [orderSerials, setOrderSerials] = useState({});\n  const [form] = Form.useForm();\n\n  const customerTypes = [\n    { value: 'regular', label: 'KhÃ¡ch thÆ°á»ng', color: 'default' },\n    { value: 'vip', label: 'VIP', color: 'gold' },\n    { value: 'wholesale', label: 'BÃ¡n sá»‰', color: 'purple' }\n  ];\n\n  useEffect(() => {\n    fetchCustomers();\n  }, [searchText, filterType]);\n\n  // âœ¨ AI Error Monitor Integration - Listen for auto-refresh events\n  useEffect(() => {\n    const handleAIRefreshCustomerList = () => {\n      console.log('ðŸ¤– AI triggered customer list refresh');\n      fetchCustomers();\n    };\n\n    // Listen for AI refresh customer list event\n    window.addEventListener('ai-refresh-customer-list', handleAIRefreshCustomerList);\n\n    // Cleanup event listener\n    return () => {\n      window.removeEventListener('ai-refresh-customer-list', handleAIRefreshCustomerList);\n    };\n  }, []);\n\n  // Fetch serials for all orders in purchase history\n  useEffect(() => {\n    if (customerPurchaseHistory.length > 0) {\n      fetchAllOrderSerials();\n    }\n  }, [customerPurchaseHistory]);\n\n  const fetchAllOrderSerials = async () => {\n    const serialsMap = {};\n    for (const order of customerPurchaseHistory) {\n      if (!order.items) continue;\n      for (const item of order.items) {\n        try {\n          const response = await productsAPI.getSoldSerials({ product_id: item.product_id, order_id: order.id });\n          if (response.data.success) {\n            serialsMap[`${order.id}_${item.product_id}`] = response.data.data || [];\n          } else {\n            serialsMap[`${order.id}_${item.product_id}`] = [];\n          }\n        } catch (error) {\n          serialsMap[`${order.id}_${item.product_id}`] = [];\n        }\n      }\n    }\n    setOrderSerials(serialsMap);\n  };\n\n  const fetchCustomers = async () => {\n    try {\n      setLoading(true);\n      const response = await customersAPI.getAll({\n        search: searchText,\n        type: filterType\n      });\n      \n      if (response.data.success) {\n        setCustomers(response.data.data);\n        calculateStats(response.data.data);\n      }\n    } catch (error) {\n      toast.error('Lá»—i khi táº£i danh sÃ¡ch khÃ¡ch hÃ ng');\n      console.error('Error fetching customers:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const calculateStats = (customerData) => {\n    const stats = {\n      total: customerData.length,\n      regular: customerData.filter(c => c.customer_type === 'regular').length,\n      vip: customerData.filter(c => c.customer_type === 'vip').length,\n      wholesale: customerData.filter(c => c.customer_type === 'wholesale').length\n    };\n    setStats(stats);\n  };\n\n  const showModal = (customer = null) => {\n    setEditingCustomer(customer);\n    setIsModalVisible(true);\n    if (customer) {\n      form.setFieldsValue({\n        ...customer,\n      });\n    } else {\n      form.resetFields();\n    }\n  };\n\n  const handleCancel = () => {\n    setIsModalVisible(false);\n    setEditingCustomer(null);\n    form.resetFields();\n  };\n\n  const handleSubmit = async (values) => {\n    try {\n      // Remove unwanted fields from values before sending\n      const { gender, birthday, city, ...customerData } = values; \n\n      if (editingCustomer) {\n        await customersAPI.update(editingCustomer.id, customerData);\n        toast.success('Cáº­p nháº­t khÃ¡ch hÃ ng thÃ nh cÃ´ng');\n      } else {\n        await customersAPI.create(customerData);\n        toast.success('Táº¡o khÃ¡ch hÃ ng thÃ nh cÃ´ng');\n      }\n      \n      handleCancel();\n      fetchCustomers();\n    } catch (error) {\n      toast.error(`Lá»—i khi ${editingCustomer ? 'cáº­p nháº­t' : 'táº¡o'} khÃ¡ch hÃ ng: ` + (error.response?.data?.message || error.message));\n      console.error('Error saving customer:', error);\n    }\n  };\n\n  const handleDelete = async (id) => {\n    try {\n      await customersAPI.delete(id);\n      toast.success('XÃ³a khÃ¡ch hÃ ng thÃ nh cÃ´ng');\n      fetchCustomers();\n    } catch (error) {\n      toast.error('Lá»—i khi xÃ³a khÃ¡ch hÃ ng');\n      console.error('Error deleting customer:', error);\n    }\n  };\n\n  const showCustomerDetail = async (customer) => {\n    try {\n      setSelectedCustomer(customer);\n        setIsDetailDrawerVisible(true);\n      setPurchaseHistoryLoading(true);\n      \n      // Fetch customer details\n      const customerResponse = await customersAPI.getById(customer.id);\n      if (customerResponse.data.success) {\n        setSelectedCustomer(customerResponse.data.data);\n      }\n      \n      // ðŸ›’ Fetch customer purchase history\n      try {\n        const ordersResponse = await api.get('/orders', {\n          params: {\n            customer_name: customer.name, // Search by customer name since orders don't have customer_id\n            limit: 100\n          }\n        });\n        \n        if (ordersResponse.data.success) {\n          const customerOrders = ordersResponse.data.data.orders || ordersResponse.data.data;\n          // Filter orders that match this customer (by name and/or phone)\n          const filteredOrders = customerOrders.filter(order => \n            (order.customer_name && order.customer_name.toLowerCase() === customer.name.toLowerCase()) ||\n            (order.customer_phone && customer.phone && order.customer_phone === customer.phone)\n          );\n          setCustomerPurchaseHistory(filteredOrders);\n        } else {\n          setCustomerPurchaseHistory([]);\n        }\n      } catch (orderError) {\n        console.error('Error fetching purchase history:', orderError);\n        setCustomerPurchaseHistory([]);\n      }\n      \n    } catch (error) {\n      toast.error('Lá»—i khi táº£i thÃ´ng tin khÃ¡ch hÃ ng');\n    } finally {\n      setPurchaseHistoryLoading(false);\n    }\n  };\n\n  const columns = [\n    {\n      title: 'MÃ£ KH',\n      dataIndex: 'code',\n      key: 'code',\n      width: 100,\n      render: (text) => <strong>{text}</strong>\n    },\n    {\n      title: 'ThÃ´ng tin khÃ¡ch hÃ ng',\n      key: 'customer_info',\n      render: (_, record) => (\n        <div>\n          <div style={{ fontWeight: 'bold', marginBottom: 4 }}>\n            <UserOutlined style={{ marginRight: 8 }} />\n            {record.name}\n          </div>\n          {record.phone && (\n            <div style={{ color: '#666', fontSize: '12px' }}>\n              <PhoneOutlined style={{ marginRight: 4 }} />\n              {record.phone}\n            </div>\n          )}\n          {record.email && (\n            <div style={{ color: '#666', fontSize: '12px' }}>\n              <MailOutlined style={{ marginRight: 4 }} />\n              {record.email}\n            </div>\n          )}\n        </div>\n      )\n    },\n    {\n      title: 'Loáº¡i KH',\n      dataIndex: 'customer_type',\n      key: 'customer_type',\n      width: 120,\n      render: (type) => {\n        const typeConfig = customerTypes.find(t => t.value === type);\n        return (\n          <Tag color={typeConfig?.color} icon={type === 'vip' ? <CrownOutlined /> : null}>\n            {typeConfig?.label}\n          </Tag>\n        );\n      }\n    },\n    {\n      title: 'Tá»•ng chi tiÃªu',\n      dataIndex: 'total_spent',\n      key: 'total_spent',\n      width: 120,\n      render: (amount) => (\n        <span style={{ color: '#52c41a', fontWeight: 'bold' }}>\n          {formatCurrency(amount || 0)}\n        </span>\n      ),\n      sorter: (a, b) => (a.total_spent || 0) - (b.total_spent || 0)\n    },\n    {\n      title: 'Sá»‘ láº§n mua',\n      dataIndex: 'visit_count',\n      key: 'visit_count',\n      width: 100,\n      render: (count) => (\n        <span>\n          <ShoppingCartOutlined style={{ marginRight: 4 }} />\n          {count || 0}\n        </span>\n      ),\n      sorter: (a, b) => (a.visit_count || 0) - (b.visit_count || 0)\n    },\n    {\n      title: 'Chiáº¿t kháº¥u',\n      dataIndex: 'discount_rate',\n      key: 'discount_rate',\n      width: 100,\n      render: (rate) => (\n        <span style={{ color: '#fa8c16' }}>\n          {rate || 0}%\n        </span>\n      )\n    },\n    {\n      title: 'Láº§n cuá»‘i mua',\n      dataIndex: 'last_visit',\n      key: 'last_visit',\n      width: 130,\n      render: (date) => date ? formatDate(date) : 'ChÆ°a mua'\n    },\n    {\n      title: 'Thao tÃ¡c',\n      key: 'actions',\n      width: 150,\n      render: (_, record) => (\n        <Space>\n          <Tooltip title=\"Xem chi tiáº¿t\">\n            <Button\n              type=\"default\"\n              size=\"small\"\n              icon={<EyeOutlined />}\n              onClick={() => showCustomerDetail(record)}\n            />\n          </Tooltip>\n          <Tooltip title=\"Chá»‰nh sá»­a\">\n            <Button\n              type=\"primary\"\n              size=\"small\"\n              icon={<EditOutlined />}\n              onClick={() => showModal(record)}\n            />\n          </Tooltip>\n          <Popconfirm\n            title=\"Báº¡n cÃ³ cháº¯c cháº¯n muá»‘n xÃ³a khÃ¡ch hÃ ng nÃ y?\"\n            onConfirm={() => handleDelete(record.id)}\n            okText=\"CÃ³\"\n            cancelText=\"KhÃ´ng\"\n          >\n            <Tooltip title=\"XÃ³a\">\n              <Button\n                type=\"default\"\n                danger\n                size=\"small\"\n                icon={<DeleteOutlined />}\n              />\n            </Tooltip>\n          </Popconfirm>\n        </Space>\n      )\n    }\n  ];\n\n  return (\n    <div style={{ padding: '24px' }}>\n      {/* Header vá»›i thá»‘ng kÃª */}\n      <Row gutter={[16, 16]} style={{ marginBottom: 24 }}>\n        <Col span={6}>\n          <Card>\n            <Statistic\n              title=\"Tá»•ng khÃ¡ch hÃ ng\"\n              value={stats.total}\n              prefix={<UserOutlined />}\n              valueStyle={{ color: '#1890ff' }}\n            />\n          </Card>\n        </Col>\n        <Col span={6}>\n          <Card>\n            <Statistic\n              title=\"KhÃ¡ch thÆ°á»ng\"\n              value={stats.regular}\n              valueStyle={{ color: '#52c41a' }}\n            />\n          </Card>\n        </Col>\n        <Col span={6}>\n          <Card>\n            <Statistic\n              title=\"KhÃ¡ch VIP\"\n              value={stats.vip}\n              prefix={<CrownOutlined />}\n              valueStyle={{ color: '#faad14' }}\n            />\n          </Card>\n        </Col>\n        <Col span={6}>\n          <Card>\n            <Statistic\n              title=\"KhÃ¡ch bÃ¡n sá»‰\"\n              value={stats.wholesale}\n              valueStyle={{ color: '#722ed1' }}\n            />\n          </Card>\n        </Col>\n      </Row>\n\n      {/* Main Content */}\n      <Card title=\"Quáº£n lÃ½ khÃ¡ch hÃ ng\">\n        {/* Filters */}\n        <Row gutter={[16, 16]} style={{ marginBottom: 16 }}>\n          <Col span={8}>\n            <Search\n              placeholder=\"TÃ¬m theo tÃªn, SÄT, mÃ£ KH...\"\n              value={searchText}\n              onChange={(e) => setSearchText(e.target.value)}\n              onSearch={fetchCustomers}\n              enterButton={<SearchOutlined />}\n              allowClear\n            />\n          </Col>\n          <Col span={6}>\n            <Select\n              style={{ width: '100%' }}\n              placeholder=\"Lá»c theo loáº¡i khÃ¡ch hÃ ng\"\n              value={filterType}\n              onChange={setFilterType}\n            >\n              <Option value=\"all\">Táº¥t cáº£</Option>\n              {customerTypes.map(type => (\n                <Option key={type.value} value={type.value}>\n                  {type.label}\n                </Option>\n              ))}\n            </Select>\n          </Col>\n          <Col span={10} style={{ textAlign: 'right' }}>\n            <Button\n              type=\"primary\"\n              icon={<PlusOutlined />}\n              onClick={() => showModal()}\n              size=\"large\"\n            >\n              ThÃªm khÃ¡ch hÃ ng\n            </Button>\n          </Col>\n        </Row>\n\n        {/* Table */}\n        <Table\n          columns={columns}\n          dataSource={customers}\n          rowKey=\"id\"\n          loading={loading}\n          pagination={{\n            total: customers.length,\n            pageSize: 10,\n            showSizeChanger: true,\n            showQuickJumper: true,\n            showTotal: (total, range) => \n              `${range[0]}-${range[1]} cá»§a ${total} khÃ¡ch hÃ ng`\n          }}\n          scroll={{ x: 1200 }}\n        />\n      </Card>\n\n      {/* Modal thÃªm/sá»­a khÃ¡ch hÃ ng */}\n      <CustomerFormModal\n        isModalVisible={isModalVisible}\n        handleCancel={handleCancel}\n        editingCustomer={editingCustomer}\n        form={form}\n        handleSubmit={handleSubmit}\n        customerTypes={customerTypes}\n      />\n\n      {/* ðŸ†• Enhanced Customer Details Drawer */}\n      <CustomerDetailDrawer\n        isDetailDrawerVisible={isDetailDrawerVisible}\n        setIsDetailDrawerVisible={setIsDetailDrawerVisible}\n        selectedCustomer={selectedCustomer}\n        customerTypes={customerTypes}\n        customerPurchaseHistory={customerPurchaseHistory}\n        purchaseHistoryLoading={purchaseHistoryLoading}\n        orderSerials={orderSerials}\n        showModal={showModal}\n        handleDelete={handleDelete}\n        formatCurrency={formatCurrency}\n        formatDate={formatDate}\n      />\n    </div>\n  );\n};\n\nexport default CustomersPage; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}